[
  {
    "question": "Phân tích vi phạm Zero Trust: Kết nối nào không thông qua xác thực trong 24h qua?",
    "keywords": [
      "zero trust violation",
      "vi phạm zero trust",
      "authentication bypass",
      "bỏ qua xác thực",
      "unauthenticated access",
      "truy cập không xác thực",
      "lateral movement",
      "di chuyển ngang",
      "trust boundary",
      "ranh giới tin cậy",
      "verify explicitly",
      "xác minh rõ ràng",
      "least privilege",
      "quyền tối thiểu"
    ],
    "scenario": "ZERO TRUST ARCHITECTURE MONITORING",
    "phase": "Giai đoạn 1: Phát hiện vi phạm chính sách Zero Trust",
    "securityFramework": "NIST Zero Trust Architecture SP 800-207",
    "query": {
      "query": {
        "bool": {
          "filter": [
            { "range": { "@timestamp": { "gte": "now-24h" } } },
            { "term": { "fortinet.firewall.action": "accept" } },
            {
              "bool": {
                "must_not": [{ "exists": { "field": "source.user.name" } }]
              }
            },
            {
              "bool": {
                "should": [{ "term": { "network.direction": "inbound" } }, { "term": { "network.direction": "internal" } }]
              }
            }
          ]
        }
      },
      "aggs": {
        "unauthenticated_connections": {
          "terms": { "field": "source.ip", "size": 100 },
          "aggs": {
            "connection_types": {
              "terms": { "field": "event.action", "size": 20 }
            },
            "accessed_resources": {
              "terms": { "field": "destination.ip", "size": 50 }
            },
            "protocols_used": {
              "terms": { "field": "network.protocol", "size": 10 }
            },
            "ports_accessed": {
              "terms": { "field": "destination.port", "size": 30 }
            },
            "data_transferred": {
              "sum": { "field": "network.bytes" }
            },
            "connection_timeline": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "1h"
              }
            },
            "source_countries": {
              "terms": { "field": "source.geo.country_name", "size": 20 }
            }
          }
        },
        "network_segments": {
          "terms": { "field": "fortinet.firewall.dintf", "size": 20 },
          "aggs": {
            "segment_traffic": {
              "sum": { "field": "network.bytes" }
            },
            "unique_sources": {
              "cardinality": { "field": "source.ip" }
            }
          }
        }
      }
    }
  },
  {
    "question": "Micro-segmentation: Lưu lượng East-West không được phép giữa các vùng mạng?",
    "keywords": [
      "micro-segmentation",
      "phân đoạn vi mô",
      "east-west traffic",
      "lưu lượng east-west",
      "lateral movement",
      "di chuyển ngang",
      "network zones",
      "vùng mạng",
      "segment violation",
      "vi phạm phân đoạn",
      "network isolation",
      "cô lập mạng",
      "inter-zone communication",
      "giao tiếp liên vùng"
    ],
    "scenario": "MICRO-SEGMENTATION MONITORING",
    "phase": "Giai đoạn 2: Giám sát giao tiếp liên vùng",
    "securityFramework": "Zero Trust Network Segmentation",
    "query": {
      "query": {
        "bool": {
          "filter": [
            { "range": { "@timestamp": { "gte": "now-1h" } } },
            { "term": { "network.direction": "internal" } },
            { "term": { "fortinet.firewall.action": "accept" } },
            {
              "bool": {
                "should": [
                  {
                    "bool": {
                      "must": [{ "term": { "fortinet.firewall.srcintfrole": "lan" } }, { "term": { "fortinet.firewall.dstintfrole": "dmz" } }]
                    }
                  },
                  {
                    "bool": {
                      "must": [{ "term": { "fortinet.firewall.srcintfrole": "dmz" } }, { "term": { "fortinet.firewall.dstintfrole": "lan" } }]
                    }
                  },
                  {
                    "bool": {
                      "must": [{ "term": { "fortinet.firewall.src_int": "internal" } }, { "term": { "fortinet.firewall.dst_int": "dmz" } }]
                    }
                  }
                ]
              }
            }
          ]
        }
      },
      "aggs": {
        "unauthorized_flows": {
          "terms": {
            "script": {
              "source": "doc['source.ip'].value + ' -> ' + doc['destination.ip'].value"
            },
            "size": 100
          },
          "aggs": {
            "flow_volume": {
              "sum": { "field": "network.bytes" }
            },
            "protocol_breakdown": {
              "terms": { "field": "network.protocol", "size": 10 }
            },
            "port_analysis": {
              "terms": { "field": "destination.port", "size": 20 }
            },
            "timeline": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "5m"
              }
            },
            "source_interface": {
              "terms": { "field": "fortinet.firewall.src_int", "size": 10 }
            },
            "dest_interface": {
              "terms": { "field": "fortinet.firewall.dst_int", "size": 10 }
            }
          }
        },
        "interface_roles": {
          "terms": { "field": "fortinet.firewall.srcintfrole", "size": 10 },
          "aggs": {
            "dest_roles": {
              "terms": { "field": "fortinet.firewall.dstintfrole", "size": 10 }
            }
          }
        }
      }
    }
  }
]
