[
  {
    "question": "Trong 24 giờ qua, những IP nguồn nào bị chặn (deny) nhiều nhất?",
    "keywords": [
      "IP nguồn",
      "source ip",
      "chặn",
      "block",
      "deny",
      "nhiều nhất",
      "top",
      "24 giờ qua",
      "last 24 hours",
      "nguồn",
      "source",
      "địa chỉ IP nguồn",
      "source IP address",
      "src IP",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "bị chặn",
      "blocked",
      "cấm",
      "denied",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "bị từ chối",
      "24h",
      "một ngày",
      "1 day",
      "24 hours",
      "ngày qua",
      "last day",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "action",
      "hành động",
      "firewall action",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security monitoring - Identify top blocked source IPs to detect potential threats, brute force attacks, or persistent malicious actors",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "top_blocked_sources": {
          "terms": {
            "field": "source.ip",
            "size": 50
          }
        }
      }
    }
  },
  {
    "question": "Từ IP nguồn 192.0.2.10, đích nào nhận nhiều bytes nhất trong 24 giờ qua?",
    "keywords": [
      "IP nguồn",
      "source ip",
      "đích",
      "destination",
      "bytes",
      "lưu lượng",
      "traffic",
      "nhiều nhất",
      "top",
      "nguồn",
      "source",
      "địa chỉ IP nguồn",
      "source IP address",
      "src IP",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "dữ liệu",
      "data",
      "băng thông",
      "bandwidth",
      "dung lượng",
      "volume",
      "24h",
      "một ngày",
      "1 day",
      "24 hours",
      "ngày qua",
      "last day",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.ip": "192.0.2.10"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "by_dst": {
          "terms": {
            "field": "destination.ip",
            "size": 50,
            "order": {
              "bytes_sum": "desc"
            }
          },
          "aggs": {
            "bytes_sum": {
              "sum": {
                "field": "network.bytes"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Liệt kê các phiên có mức rủi ro IPS cao (crlevel = high/critical) trong 1 ngày qua.",
    "keywords": [
      "phiên",
      "session",
      "rủi ro",
      "risk",
      "IPS",
      "cao",
      "high",
      "critical",
      "crlevel",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "nguy hiểm",
      "danger",
      "threat",
      "mối đe dọa",
      "위험",
      "rủi ro cao",
      "high risk",
      "intrusion prevention",
      "phòng chống xâm nhập",
      "security",
      "bảo mật",
      "threat prevention"
    ],
    "scenario": "Threat detection - List high-risk IPS events to prioritize security incident response and protect critical assets",
    "query": {
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "fortinet.firewall.attack",
        "fortinet.firewall.crlevel",
        "fortinet.firewall.crscore",
        "rule.name"
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "terms": {
                "fortinet.firewall.crlevel": [
                  "high",
                  "critical"
                ]
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Trong 7 ngày qua, các kết nối outbound từ Việt Nam ra nước ngoài là gì?",
    "keywords": [
      "kết nối",
      "connection",
      "outbound",
      "đi ra",
      "Việt Nam",
      "nước ngoài",
      "foreign",
      "7d",
      "tuần",
      "week",
      "7 days",
      "tuần qua",
      "last week",
      "ra ngoài",
      "egress",
      "xuất",
      "outgoing",
      "international",
      "quốc tế",
      "overseas",
      "external",
      "vietnam",
      "domestic",
      "trong nước",
      "local",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin"
    ],
    "scenario": "Compliance monitoring - Track outbound connections to foreign countries for regulatory compliance and data sovereignty",
    "query": {
      "size": 50,
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "destination.geo.country_name",
        "network.bytes",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.geo.country_name": "Vietnam"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "destination.geo.country_name": "Vietnam"
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Có những lần đăng nhập thất bại của người dùng 'alice' trong 48 giờ qua không?",
    "keywords": [
      "đăng nhập",
      "login",
      "thất bại",
      "failure",
      "người dùng",
      "user",
      "alice",
      "48h",
      "2 days",
      "2 ngày",
      "hai ngày",
      "authentication",
      "xác thực",
      "sign in",
      "truy cập",
      "access",
      "failed",
      "unsuccessful",
      "không thành công",
      "lỗi",
      "error",
      "outcome",
      "kết quả",
      "result",
      "status",
      "trạng thái",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Security audit - Track failed login attempts to detect brute force attacks, credential stuffing, and unauthorized access attempts",
    "query": {
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "event.action",
        "event.outcome",
        "fortinet.firewall.authmsg"
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.name": "alice"
              }
            },
            {
              "term": {
                "event.action": "login"
              }
            },
            {
              "term": {
                "event.outcome": "failure"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-48h"
                }
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Những rule nào chặn nhiều nhất trong 24 giờ qua?",
    "keywords": [
      "rule",
      "policy",
      "chặn",
      "block",
      "deny",
      "nhiều nhất",
      "top",
      "bị chặn",
      "blocked",
      "cấm",
      "denied",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "24h",
      "một ngày",
      "1 day",
      "24 hours",
      "ngày qua",
      "last day",
      "quy tắc",
      "chính sách",
      "luật",
      "regulation",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "action",
      "hành động",
      "firewall action",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Policy management - Analyze firewall policies to optimize rules, improve security, and reduce complexity",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "rules": {
          "terms": {
            "field": "rule.name",
            "size": 50
          }
        }
      }
    }
  },
  {
    "question": "Trong 1 giờ qua, có lưu lượng RDP (port 3389) đi vào từ WAN không?",
    "keywords": [
      "RDP",
      "port 3389",
      "WAN",
      "đi vào",
      "inbound",
      "lưu lượng",
      "traffic",
      "bytes",
      "băng thông",
      "bandwidth",
      "data flow",
      "dòng dữ liệu",
      "1h",
      "hour",
      "giờ qua",
      "last hour",
      "remote desktop",
      "3389",
      "truy cập từ xa",
      "desktop remoto",
      "cổng",
      "service port",
      "network port",
      "TCP/UDP port",
      "wide area network",
      "mạng diện rộng",
      "internet",
      "external"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "destination.port",
        "fortinet.firewall.srcintfrole",
        "rule.name"
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "destination.port": 3389
              }
            },
            {
              "term": {
                "fortinet.firewall.srcintfrole": "wan"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-1h"
                }
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Các phiên DNAT tới server nội bộ 10.0.0.10 trong 24 giờ gần đây là gì?",
    "keywords": [
      "phiên",
      "session",
      "DNAT",
      "server",
      "máy chủ",
      "nội bộ",
      "internal",
      "24h",
      "một ngày",
      "1 day",
      "24 hours",
      "ngày qua",
      "last day"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "fortinet.firewall.transip",
        "destination.port",
        "rule.name"
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.trandisp": "dnat"
              }
            },
            {
              "term": {
                "fortinet.firewall.transip": "10.0.0.10"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Trong 1 giờ qua, IP nguồn nào gửi nhiều gói ICMP bất thường (> 10.000 packets)?",
    "keywords": [
      "IP nguồn",
      "source ip",
      "ICMP",
      "bất thường",
      "anomaly",
      "packets",
      "gói tin",
      "nhiều",
      "> 10000",
      "10000",
      "bucket_selector",
      "1 giờ qua",
      "nguồn",
      "source",
      "địa chỉ IP nguồn",
      "source IP address",
      "src IP",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "1h",
      "hour",
      "giờ qua",
      "last hour",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network analysis - Monitor protocol usage to understand traffic composition and detect protocol-based attacks",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "network.protocol": "ping"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-1h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "by_source": {
          "terms": {
            "field": "source.ip",
            "size": 50
          },
          "aggs": {
            "pkt_sum": {
              "sum": {
                "field": "network.packets"
              }
            },
            "heavy_senders": {
              "bucket_selector": {
                "buckets_path": {
                  "p": "pkt_sum"
                },
                "script": "params.p > 10000"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Policy '10Mbps' đang deny rất nhiều traffic (15,425 lần trong 20 ngày) - những IP nguồn nào vi phạm bandwidth limit này nhiều nhất và có xu hướng tăng trong 24h qua không?",
    "keywords": [
      "10Mbps policy",
      "bandwidth violation",
      "top violators",
      "deny trend",
      "traffic abuse",
      "FTG-CNHN",
      "bandwidth limit exceeded",
      "nguồn",
      "source",
      "địa chỉ IP nguồn",
      "source IP address",
      "src IP",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "denied",
      "bị từ chối",
      "block",
      "chặn",
      "reject",
      "băng thông",
      "traffic",
      "lưu lượng",
      "throughput",
      "chính sách",
      "rule",
      "quy tắc",
      "firewall rule",
      "quy định",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "action",
      "hành động",
      "firewall action",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security monitoring - Identify top blocked source IPs to detect potential threats, brute force attacks, or persistent malicious actors",
    "query": {
      "size": 100,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "source.port",
        "destination.port",
        "observer.name",
        "fortinet.firewall.shapingpolicyname",
        "fortinet.firewall.action",
        "network.bytes",
        "network.protocol"
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "observer.name": "FTG-CNHN"
              }
            },
            {
              "term": {
                "fortinet.firewall.shapingpolicyname": "10Mbps"
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "top_violating_sources": {
          "terms": {
            "field": "source.ip",
            "size": 10,
            "order": {
              "total_denied_bytes": "desc"
            }
          },
          "aggs": {
            "total_denied_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "deny_count": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "hourly_pattern": {
              "date_histogram": {
                "field": "@timestamp",
                "calendar_interval": "1h"
              }
            }
          }
        },
        "deny_timeline_10mbps": {
          "date_histogram": {
            "field": "@timestamp",
            "calendar_interval": "1h"
          },
          "aggs": {
            "denied_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Ai đã đăng nhập vào thiết bị Fortigate bằng tài khoản admin trong 24 giờ qua?",
    "keywords": [
      "đăng nhập",
      "login",
      "Fortigate",
      "thiết bị",
      "tài khoản",
      "user",
      "admin",
      "quản trị",
      "24h",
      "một ngày",
      "1 day",
      "24 hours",
      "ngày qua",
      "last day",
      "authentication",
      "xác thực",
      "sign in",
      "truy cập",
      "access",
      "administrator",
      "quản trị viên",
      "root",
      "superuser",
      "outcome",
      "kết quả",
      "result",
      "status",
      "trạng thái",
      "user activity",
      "hoạt động người dùng",
      "account"
    ],
    "scenario": "Security audit - Monitor administrative access to ensure compliance and detect potential insider threats",
    "query": {
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "event.action",
        "event.outcome"
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.roles": "Administrator"
              }
            },
            {
              "term": {
                "event.action": "login"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Có phiên đăng nhập quản trị thất bại (admin login failed) nào trong 1 giờ qua không?",
    "keywords": [
      "đăng nhập",
      "login",
      "quản trị",
      "admin",
      "thất bại",
      "failure",
      "1 giờ qua",
      "1h",
      "hour",
      "giờ qua",
      "last hour",
      "authentication",
      "xác thực",
      "sign in",
      "truy cập",
      "access",
      "failed",
      "unsuccessful",
      "không thành công",
      "lỗi",
      "error",
      "administrator",
      "quản trị viên",
      "root",
      "superuser",
      "outcome",
      "kết quả",
      "result",
      "status",
      "trạng thái",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Security audit - Track failed login attempts to detect brute force attacks, credential stuffing, and unauthorized access attempts",
    "query": {
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "event.action",
        "event.outcome",
        "fortinet.firewall.authmsg"
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "event.action": "login"
              }
            },
            {
              "term": {
                "event.outcome": "failure"
              }
            },
            {
              "term": {
                "source.user.roles": "Administrator"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-1h"
                }
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "So sánh hiệu quả kiểm soát băng thông giữa 3 shaping policies: '10Mbps' (deny 15,425), '30Mbps' (deny 4,566) và 'Unlimited' (deny 51) - policy nào cần điều chỉnh và tại sao có sự chênh lệch lớn về số lượng deny?",
    "keywords": [
      "policy comparison",
      "bandwidth control effectiveness",
      "QoS analysis",
      "policy optimization",
      "traffic distribution",
      "deny rate analysis",
      "denied",
      "bị từ chối",
      "block",
      "chặn",
      "reject",
      "chính sách",
      "rule",
      "quy tắc",
      "firewall rule",
      "quy định",
      "compare",
      "comparison",
      "đối chiếu",
      "versus",
      "vs",
      "action",
      "hành động",
      "firewall action",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security monitoring - Analyze which firewall rules are blocking the most traffic to optimize security policies",
    "query": {
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "observer.name",
        "fortinet.firewall.shapingpolicyname",
        "fortinet.firewall.action",
        "network.bytes",
        "network.protocol"
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "observer.name": "FTG-CNHN"
              }
            },
            {
              "terms": {
                "fortinet.firewall.shapingpolicyname": [
                  "10Mbps",
                  "30Mbps",
                  "Unlimited"
                ]
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "policy_effectiveness": {
          "terms": {
            "field": "fortinet.firewall.shapingpolicyname",
            "size": 5
          },
          "aggs": {
            "deny_count": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "total_denied_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_violators": {
              "cardinality": {
                "field": "source.ip"
              }
            },
            "avg_bytes_per_deny": {
              "avg": {
                "field": "network.bytes"
              }
            },
            "top_violators_per_policy": {
              "terms": {
                "field": "source.ip",
                "size": 3
              },
              "aggs": {
                "violation_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        },
        "cross_policy_violators": {
          "terms": {
            "field": "source.ip",
            "size": 10
          },
          "aggs": {
            "policies_violated": {
              "terms": {
                "field": "fortinet.firewall.shapingpolicyname"
              }
            },
            "total_violations": {
              "sum": {
                "field": "network.bytes"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Ai đã chỉnh sửa firewall policy trong 30 ngày qua?",
    "keywords": [
      "ai",
      "who",
      "user",
      "chỉnh sửa",
      "Edit",
      "thay đổi",
      "change",
      "modify",
      "firewall policy",
      "chính sách firewall",
      "policy",
      "30 ngày",
      "30 days",
      "tháng qua",
      "last month",
      "một tháng",
      "1 month",
      "firewall rules",
      "quy tắc tường lửa",
      "security policy",
      "chính sách bảo mật",
      "configuration change",
      "thay đổi cấu hình",
      "audit",
      "kiểm toán",
      "log",
      "nhật ký",
      "chi tiết",
      "details",
      "history",
      "lịch sử"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "_source": [
        "@timestamp",
        "message",
        "fortinet.firewall.action",
        "fortinet.firewall.cfgpath",
        "fortinet.firewall.cfgobj",
        "fortinet.firewall.cfgattr",
        "source.user.name",
        "observer.name",
        "observer.serial_number",
        "fortinet.firewall.ui"
      ],
      "query": {
        "bool": {
          "filter": [
            { "range": { "@timestamp": { "gte": "now-30d" } } }
          ],
          "must": [
            { "match_phrase": { "fortinet.firewall.cfgpath": "firewall.policy" }},
            { "match_phrase": { "fortinet.firewall.action": "Edit" }}
          ]
        }
      }
    }
  },
  {
    "question": "Có đăng nhập quản trị nào từ quốc gia khác Việt Nam trong 48 giờ qua?",
    "keywords": [
      "đăng nhập",
      "login",
      "quản trị",
      "admin",
      "quốc gia",
      "country",
      "khác Việt Nam",
      "nước ngoài",
      "foreign",
      "48h",
      "2 days",
      "2 ngày",
      "hai ngày",
      "authentication",
      "xác thực",
      "sign in",
      "truy cập",
      "access",
      "vietnam",
      "domestic",
      "trong nước",
      "local",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Security audit - Monitor administrative access to ensure compliance and detect potential insider threats",
    "query": {
      "size": 50,
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "source.geo.country_name",
        "event.action"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "event.action": "login"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-48h"
                }
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "source.geo.country_name": "Vietnam"
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Có dấu hiệu brute-force login (quá nhiều login failure từ 1 IP) trong 1 giờ qua không?",
    "keywords": [
      "brute-force",
      "tấn công",
      "đăng nhập",
      "login",
      "thất bại",
      "failure",
      "nhiều",
      "IP",
      "1 giờ qua",
      "> 10",
      "threshold",
      "bucket_selector",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "1h",
      "hour",
      "giờ qua",
      "last hour",
      "outcome",
      "kết quả",
      "result",
      "status",
      "trạng thái",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security audit - Track failed login attempts to detect brute force attacks, credential stuffing, and unauthorized access attempts",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "event.action": "login"
              }
            },
            {
              "term": {
                "event.outcome": "failure"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-1h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "by_ip": {
          "terms": {
            "field": "source.ip",
            "size": 20
          },
          "aggs": {
            "fail_count": {
              "value_count": {
                "field": "event.outcome"
              }
            },
            "brute_force": {
              "bucket_selector": {
                "buckets_path": {
                  "c": "fail_count"
                },
                "script": "params.c > 10"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Có IP nào thực hiện quá nhiều kết nối đến port quản trị (443, 22) trong 15 phút gần đây không?",
    "keywords": [
      "IP",
      "nhiều kết nối",
      "port quản trị",
      "admin port",
      "443",
      "22",
      "15 phút",
      "> 50",
      "threshold",
      "bucket_selector",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "cổng",
      "service port",
      "network port",
      "TCP/UDP port",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security monitoring - Track SSH connections to detect unauthorized access and ensure secure remote administration",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "terms": {
                "destination.port": [
                  22,
                  443
                ]
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-15m"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "by_src": {
          "terms": {
            "field": "source.ip",
            "size": 20
          },
          "aggs": {
            "conn_count": {
              "value_count": {
                "field": "destination.port"
              }
            },
            "suspicious": {
              "bucket_selector": {
                "buckets_path": {
                  "c": "conn_count"
                },
                "script": "params.c > 50"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Trong 24 giờ qua, những user nào bị chặn khi cố gắng kết nối SSH?",
    "keywords": [
      "user",
      "người dùng",
      "chặn",
      "block",
      "deny",
      "kết nối",
      "connection",
      "SSH",
      "port 22",
      "bị chặn",
      "blocked",
      "cấm",
      "denied",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "24h",
      "một ngày",
      "1 day",
      "24 hours",
      "ngày qua",
      "last day",
      "secure shell",
      "22",
      "terminal",
      "remote access",
      "action",
      "hành động",
      "firewall action",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security monitoring - Review blocked traffic patterns to identify security threats and policy violations",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "destination.port": 22
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "blocked_users": {
          "terms": {
            "field": "source.user.name",
            "size": 50
          }
        }
      }
    }
  },
  {
    "question": "Có user nào bị chặn khi truy cập RDP (3389) từ LAN ra ngoài internet không?",
    "keywords": [
      "user",
      "người dùng",
      "chặn",
      "block",
      "deny",
      "truy cập",
      "RDP",
      "port 3389",
      "LAN",
      "bị chặn",
      "blocked",
      "cấm",
      "denied",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "remote desktop",
      "3389",
      "truy cập từ xa",
      "desktop remoto",
      "local area network",
      "mạng cục bộ",
      "internal",
      "nội bộ",
      "action",
      "hành động",
      "firewall action",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Security monitoring - Review blocked traffic patterns to identify security threats and policy violations",
    "query": {
      "size": 50,
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "destination.ip",
        "destination.port",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "destination.port": 3389
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "term": {
                "fortinet.firewall.srcintfrole": "lan"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Trong 1 giờ qua có user nào gửi nhiều gói ICMP bị chặn?",
    "keywords": [
      "user",
      "người dùng",
      "ICMP",
      "chặn",
      "block",
      "deny",
      "1 giờ qua",
      "bị chặn",
      "blocked",
      "cấm",
      "denied",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "1h",
      "hour",
      "giờ qua",
      "last hour",
      "action",
      "hành động",
      "firewall action",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security monitoring - Review blocked traffic patterns to identify security threats and policy violations",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "network.protocol": "ping"
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-1h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "blocked_icmp": {
          "terms": {
            "field": "source.user.name",
            "size": 50
          },
          "aggs": {
            "pkt_sum": {
              "sum": {
                "field": "network.packets"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Những user nào cố gắng quét port (nhiều destination.port khác nhau) trong 15 phút gần đây?",
    "keywords": [
      "user",
      "người dùng",
      "quét port",
      "port scan",
      "destination port",
      "15 phút",
      "nhiều",
      "> 10",
      "cardinality",
      "unique ports",
      "bucket_selector",
      "cổng",
      "service port",
      "network port",
      "TCP/UDP port",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-15m"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "by_user": {
          "terms": {
            "field": "source.user.name",
            "size": 20
          },
          "aggs": {
            "unique_ports": {
              "cardinality": {
                "field": "destination.port"
              }
            },
            "port_scan": {
              "bucket_selector": {
                "buckets_path": {
                  "p": "unique_ports"
                },
                "script": "params.p > 10"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Có user nào bị chặn khi tải file qua FTP (port 21) không?",
    "keywords": [
      "user",
      "người dùng",
      "chặn",
      "block",
      "deny",
      "tải file",
      "download",
      "FTP",
      "port 21",
      "bị chặn",
      "blocked",
      "cấm",
      "denied",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "cổng",
      "service port",
      "network port",
      "TCP/UDP port",
      "action",
      "hành động",
      "firewall action",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Security monitoring - Track blocked port activities to identify unauthorized access attempts and potential security breaches",
    "query": {
      "size": 50,
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "destination.ip",
        "destination.port",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "destination.port": 21
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Trong 7 ngày qua, user nào bị chặn nhiều nhất vì truy cập web không hợp lệ?",
    "keywords": [
      "user",
      "người dùng",
      "chặn",
      "block",
      "deny",
      "nhiều nhất",
      "top",
      "truy cập web",
      "web access",
      "webfilter",
      "bị chặn",
      "blocked",
      "cấm",
      "denied",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "7d",
      "tuần",
      "week",
      "7 days",
      "tuần qua",
      "last week",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "action",
      "hành động",
      "firewall action",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security monitoring - Review blocked traffic patterns to identify security threats and policy violations",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.subtype": "webfilter"
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "top_users": {
          "terms": {
            "field": "source.user.name",
            "size": 50
          }
        }
      }
    }
  },
  {
    "question": "Có user nào kết nối đến quốc gia bị hạn chế (ví dụ: Russia, China) trong 24 giờ qua không?",
    "keywords": [
      "user",
      "người dùng",
      "kết nối",
      "connection",
      "quốc gia",
      "country",
      "hạn chế",
      "restricted",
      "Russia",
      "China",
      "24h",
      "một ngày",
      "1 day",
      "24 hours",
      "ngày qua",
      "last day",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Compliance monitoring - Analyze geographic traffic patterns for compliance, security, and business intelligence",
    "query": {
      "size": 50,
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "destination.ip",
        "destination.geo.country_name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "terms": {
                "destination.geo.country_name": [
                  "Russia",
                  "China"
                ]
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Trong 1 giờ qua có user nào upload quá nhiều dữ liệu ra ngoài (>1GB) không?",
    "keywords": [
      "user",
      "người dùng",
      "upload",
      "tải lên",
      "dữ liệu",
      "data",
      "lớn",
      "1GB",
      "1073741824",
      "bytes",
      "data exfiltration",
      "bucket_selector",
      "outbound",
      "1h",
      "hour",
      "giờ qua",
      "last hour",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "network.direction": "outbound"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-1h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "by_user": {
          "terms": {
            "field": "source.user.name",
            "size": 20
          },
          "aggs": {
            "bytes_sent": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "big_upload": {
              "bucket_selector": {
                "buckets_path": {
                  "b": "bytes_sent"
                },
                "script": "params.b > 1073741824"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Có user nào trong LAN cố gắng truy cập dịch vụ quản trị web của Fortigate (port 443) bị chặn?",
    "keywords": [
      "user",
      "người dùng",
      "LAN",
      "truy cập",
      "dịch vụ quản trị",
      "admin service",
      "Fortigate",
      "port 443",
      "chặn",
      "block",
      "deny",
      "bị chặn",
      "blocked",
      "cấm",
      "denied",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "cổng",
      "service port",
      "network port",
      "TCP/UDP port",
      "local area network",
      "mạng cục bộ",
      "internal",
      "nội bộ",
      "action",
      "hành động",
      "firewall action",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Security monitoring - Track blocked port activities to identify unauthorized access attempts and potential security breaches",
    "query": {
      "size": 50,
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "destination.ip",
        "destination.port",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "destination.port": 443
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "term": {
                "fortinet.firewall.srcintfrole": "lan"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Trong 24 giờ qua, có user nào bị chặn khi dùng ứng dụng P2P (torrent) không?",
    "keywords": [
      "user",
      "người dùng",
      "chặn",
      "block",
      "deny",
      "ứng dụng",
      "application",
      "P2P",
      "torrent",
      "bị chặn",
      "blocked",
      "cấm",
      "denied",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "24h",
      "một ngày",
      "1 day",
      "24 hours",
      "ngày qua",
      "last day",
      "app",
      "phần mềm",
      "software",
      "service",
      "dịch vụ",
      "action",
      "hành động",
      "firewall action",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Security monitoring - Review blocked traffic patterns to identify security threats and policy violations",
    "query": {
      "size": 50,
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "destination.ip",
        "rule.category",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "rule.category": "p2p"
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Hiển thị log của user QuynhTX từ 8h sáng đến 5h chiều hôm nay",
    "keywords": [
      "log",
      "user",
      "QuynhTX",
      "8h sáng",
      "5h chiều",
      "hôm nay",
      "thời gian cụ thể",
      "user activity",
      "17h",
      "time range",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.name": "QuynhTX"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now/d+8h",
                  "lte": "now/d+17h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "destination.ip",
        "event.action",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Traffic trong khung giờ 22h-6h sáng (ngoài giờ làm việc) trong 3 ngày qua",
    "keywords": [
      "traffic",
      "lưu lượng",
      "ngoài giờ làm việc",
      "after hours",
      "22h",
      "6h",
      "3 ngày",
      "script",
      "hour check",
      "getHour",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "bool": {
          "must": {
            "script": {
              "script": {
                "source": "doc['@timestamp'].value.getHour() >= 22 || doc['@timestamp'].value.getHour() < 6"
              }
            }
          },
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-3d"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "network.bytes",
        "source.user.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "So sánh số lượng connections giữa hôm nay và hôm qua",
    "keywords": [
      "so sánh",
      "compare",
      "số lượng",
      "count",
      "connections",
      "kết nối",
      "hôm nay",
      "hôm qua",
      "date_histogram",
      "by day",
      "yesterday",
      "today",
      "session",
      "phiên",
      "liên kết",
      "link",
      "comparison",
      "đối chiếu",
      "versus",
      "vs",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-2d/d"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "by_day": {
          "date_histogram": {
            "field": "@timestamp",
            "calendar_interval": "day"
          },
          "aggs": {
            "connection_count": {
              "value_count": {
                "field": "@timestamp"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm các kết nối xuất hiện trong 5 phút đầu tiên của mỗi giờ trong 24h qua",
    "keywords": [
      "kết nối",
      "connections",
      "5 phút đầu",
      "mỗi giờ",
      "hourly",
      "24h qua",
      "script",
      "getMinute",
      "< 5",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ],
          "must": {
            "script": {
              "script": {
                "source": "doc['@timestamp'].value.getMinute() < 5"
              }
            }
          }
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "source.user.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Log nào được tạo ra vào cuối tuần (thứ 7, chủ nhật) trong tháng này?",
    "keywords": [
      "log",
      "cuối tuần",
      "weekend",
      "thứ 7",
      "chủ nhật",
      "tháng này",
      "this month",
      "script",
      "getDayOfWeek",
      ">= 6",
      "saturday",
      "sunday",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now/M"
                }
              }
            }
          ],
          "must": {
            "script": {
              "script": {
                "source": "doc['@timestamp'].value.getDayOfWeek() >= 6"
              }
            }
          }
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "source.user.name",
        "event.action"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Traffic cao điểm nhất trong ngày là lúc nào? (group by hour)",
    "keywords": [
      "traffic",
      "lưu lượng",
      "cao điểm",
      "peak hours",
      "group by hour",
      "phân tích theo giờ",
      "date_histogram",
      "hourly",
      "calendar_interval",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "now-24h"
          }
        }
      },
      "aggs": {
        "by_hour": {
          "date_histogram": {
            "field": "@timestamp",
            "calendar_interval": "hour"
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Có log nào được tạo ra giữa 15-09-2025 10:00 và 15-09-2025 15:30 không?",
    "keywords": [
      "log",
      "giữa",
      "between",
      "thời gian cụ thể",
      "specific time",
      "15-09-2025",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Email security - Monitor SMTP traffic to detect spam, phishing attempts, and email-borne threats",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "2025-09-15T10:00:00.000+07:00",
            "lte": "2025-09-15T15:30:00.000+07:00"
          }
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "source.user.name",
        "event.action"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Khoảng thời gian nào có nhiều kết nối bị chặn nhất trong 7 ngày qua?",
    "keywords": [
      "khoảng thời gian",
      "time range",
      "kết nối bị chặn",
      "denied connections",
      "nhiều nhất",
      "top",
      "7 ngày qua",
      "date_histogram",
      "hour",
      "order by",
      "bị chặn",
      "blocked",
      "cấm",
      "denied",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "7d",
      "tuần",
      "week",
      "7 days",
      "tuần qua",
      "last week",
      "action",
      "hành động",
      "firewall action",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend"
    ],
    "scenario": "Security monitoring - Review blocked traffic patterns to identify security threats and policy violations",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "by_hour": {
          "date_histogram": {
            "field": "@timestamp",
            "calendar_interval": "hour",
            "order": {
              "denied_count": "desc"
            }
          },
          "aggs": {
            "denied_count": {
              "value_count": {
                "field": "@timestamp"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "User nào làm việc ngoài giờ (sau 18h hoặc trước 8h) nhiều nhất?",
    "keywords": [
      "user",
      "người dùng",
      "làm việc ngoài giờ",
      "after hours",
      "sau 18h",
      "trước 8h",
      "nhiều nhất",
      "top",
      "script",
      "getHour",
      ">= 18",
      "< 8",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            }
          ],
          "must": {
            "script": {
              "script": {
                "source": "doc['@timestamp'].value.getHour() >= 18 || doc['@timestamp'].value.getHour() < 8"
              }
            }
          }
        }
      },
      "aggs": {
        "by_user": {
          "terms": {
            "field": "source.user.name",
            "size": 10
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm các phiên kết nối kéo dài quá 1 giờ",
    "keywords": [
      "phiên kết nối",
      "session",
      "kéo dài",
      "long duration",
      "quá 1 giờ",
      "event.duration",
      "3600000000000",
      "nanoseconds",
      "> 1 hour",
      "1h",
      "hour",
      "giờ qua",
      "last hour",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Network monitoring - Identify long-running sessions to detect persistent connections and potential security issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "event.duration": {
                  "gt": 3600000000000
                }
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "source.user.name",
        "event.duration",
        "rule.name"
      ],
      "sort": [
        {
          "event.duration": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Top 10 applications được sử dụng nhiều nhất theo network.protocol",
    "keywords": [
      "top 10",
      "applications",
      "ứng dụng",
      "sử dụng nhiều nhất",
      "network.protocol",
      "protocol",
      "exists",
      "terms aggregation",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "nhiều nhất",
      "hàng đầu",
      "leading",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Application monitoring - Identify most-used applications to optimize network resources and enforce acceptable use policies",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "network.protocol"
              }
            }
          ]
        }
      },
      "aggs": {
        "top_apps": {
          "terms": {
            "field": "network.protocol",
            "size": 10
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm tất cả truy vấn DNS trong 6 giờ qua được gửi đến máy chủ DNS thuộc tổ chức 'GOOGLE'.",
    "keywords": [
      "dns queries",
      "truy vấn dns",
      "6h qua",
      "máy chủ dns",
      "dns server",
      "tổ chức",
      "organization",
      "GOOGLE",
      "destination.as.organization.name",
      "term",
      "exact match",
      "domain name system",
      "tên miền",
      "name resolution",
      "phân giải tên"
    ],
    "scenario": "Security monitoring - Analyze DNS queries to detect malware communication, data exfiltration, and policy violations",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "destination.as.organization.name": "GOOGLE"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-6h"
                }
              }
            },
            {
              "term": {
                "network.protocol": "dns"
              }
            },
            {
              "term": {
                "destination.port": 53
              }
            }
          ]
        }
      },
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Có bao nhiêu HTTPS sessions (port 443) với TLS version 1.2?",
    "keywords": [
      "bao nhiêu",
      "count",
      "https sessions",
      "port 443",
      "tls version 1.2",
      "tls.version",
      "value_count",
      "aggregation",
      "cổng",
      "service port",
      "network port",
      "TCP/UDP port",
      "phiên",
      "kết nối",
      "connection",
      "phiên làm việc",
      "session connection"
    ],
    "scenario": "Web filtering - Monitor web access patterns for security, compliance, and productivity management",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "destination.port": 443
              }
            },
            {
              "term": {
                "tls.version": "1.2"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "session_count": {
          "value_count": {
            "field": "@timestamp"
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Liệt kê các HTTP requests với method POST trong 3h qua",
    "keywords": [
      "http requests",
      "method post",
      "3h qua",
      "http.request.method",
      "POST",
      "liệt kê",
      "list",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Web filtering - Monitor web access patterns for security, compliance, and productivity management",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "http.request.method": "POST"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-3h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "source.user.name",
        "destination.ip",
        "destination.as.organization.name",
        "http.request.method"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Traffic ICMP chiếm bao nhiêu phần trăm tổng traffic?",
    "keywords": [
      "traffic icmp",
      "lưu lượng icmp",
      "phần trăm",
      "percentage",
      "tổng traffic",
      "total traffic",
      "filter aggregation",
      "sum",
      "calculation",
      "network bytes",
      "packet size",
      "kích thước gói tin"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "now-24h"
          }
        }
      },
      "aggs": {
        "total_traffic": {
          "sum": {
            "field": "network.bytes"
          }
        },
        "icmp_traffic": {
          "filter": {
            "term": {
              "network.protocol": "ping"
            }
          },
          "aggs": {
            "bytes": {
              "sum": {
                "field": "network.bytes"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "User nào truy cập nhiều domains khác nhau nhất?",
    "keywords": [
      "user",
      "người dùng",
      "truy cập",
      "access",
      "nhiều domains",
      "unique domains",
      "nhiều nhất",
      "top",
      "cardinality",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security monitoring - Analyze DNS queries to detect malware communication, data exfiltration, and policy violations",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "destination.as.organization.name"
              }
            }
          ]
        }
      },
      "aggs": {
        "by_user": {
          "terms": {
            "field": "source.user.name",
            "size": 10,
            "order": {
              "unique_domains": "desc"
            }
          },
          "aggs": {
            "unique_domains": {
              "cardinality": {
                "field": "destination.as.organization.name"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Có kết nối nào sử dụng protocol không phổ biến?",
    "keywords": [
      "kết nối",
      "connection",
      "protocol",
      "giao thức",
      "không phổ biến",
      "uncommon",
      "rare",
      "must_not",
      "exclude",
      "tcp",
      "udp",
      "icmp",
      "dns",
      "http",
      "https"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ],
          "must_not": [
            {
              "terms": {
                "network.transport": [
                  "tcp",
                  "udp"
                ]
              }
            },
            {
              "terms": {
                "network.protocol": [
                  "ping",
                  "dns",
                  "http",
                  "https"
                ]
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "network.protocol",
        "network.transport"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Top 5 TLS cipher suites được sử dụng nhiều nhất",
    "keywords": [
      "top 5",
      "tls cipher suites",
      "mã hóa",
      "encryption",
      "sử dụng nhiều nhất",
      "tls.cipher",
      "exists",
      "terms aggregation",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "nhiều nhất",
      "hàng đầu",
      "leading",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "tls.cipher"
              }
            }
          ]
        }
      },
      "aggs": {
        "top_ciphers": {
          "terms": {
            "field": "tls.cipher",
            "size": 5
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm các truy vấn DNS bị tường lửa chặn (deny) trong 24h qua",
    "keywords": [
      "dns queries",
      "truy vấn dns",
      "bị chặn",
      "deny",
      "failed",
      "24h qua",
      "event.action",
      "network.protocol",
      "destination.port",
      "blocked",
      "cấm",
      "denied",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "bị từ chối",
      "block",
      "chặn",
      "domain name system",
      "tên miền",
      "name resolution",
      "phân giải tên"
    ],
    "scenario": "Security monitoring - Review blocked traffic patterns to identify security threats and policy violations",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "term": {
                "network.protocol": "dns"
              }
            },
            {
              "term": {
                "destination.port": 53
              }
            },
            {
              "term": {
                "event.action": "deny"
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "event.action",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Kết nối nào có URL path chứa '/admin' hoặc '/login'?",
    "keywords": [
      "kết nối",
      "connection",
      "url path",
      "chứa",
      "contains",
      "/admin",
      "/login",
      "wildcard",
      "should",
      "minimum_should_match",
      "destination.as.organization.name",
      "administrator",
      "quản trị viên",
      "quản trị",
      "root",
      "superuser",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Security audit - Monitor administrative access to ensure compliance and detect potential insider threats",
    "query": {
      "query": {
        "bool": {
          "should": [
            {
              "wildcard": {
                "destination.as.organization.name": "*/admin*"
              }
            },
            {
              "wildcard": {
                "destination.as.organization.name": "*/login*"
              }
            }
          ],
          "minimum_should_match": 1,
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "source.user.name",
        "destination.as.organization.name",
        "destination.as.organization.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Traffic đi qua interface WiFi-HPTVIETNAM nhiều hơn hay port3?",
    "keywords": [
      "traffic",
      "lưu lượng",
      "interface",
      "cổng",
      "WiFi-HPTVIETNAM",
      "port3",
      "so sánh",
      "compare",
      "should",
      "observer.ingress.interface.name",
      "service port",
      "network port",
      "TCP/UDP port",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ],
          "should": [
            {
              "term": {
                "observer.ingress.interface.name": "WiFi-HPTVIETNAM"
              }
            },
            {
              "term": {
                "observer.ingress.interface.name": "port3"
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "by_interface": {
          "terms": {
            "field": "observer.ingress.interface.name",
            "size": 10
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm các kết nối internal (source và destination đều trong mạng nội bộ)",
    "keywords": [
      "kết nối",
      "connections",
      "internal",
      "nội bộ",
      "network.direction",
      "internal network",
      "network bytes",
      "packet size",
      "kích thước gói tin"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "network.direction": "internal"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-6h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "network.bytes",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Top 10 destination ports được truy cập nhiều nhất từ LAN",
    "keywords": [
      "top 10",
      "destination ports",
      "cổng đích",
      "truy cập nhiều nhất",
      "LAN",
      "srcintfrole",
      "fortinet.firewall.srcintfrole",
      "terms aggregation",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "nhiều nhất",
      "hàng đầu",
      "leading",
      "cổng",
      "service port",
      "network port",
      "TCP/UDP port",
      "local area network",
      "mạng cục bộ",
      "internal",
      "nội bộ",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network monitoring - Analyze traffic by interface to optimize routing and identify network bottlenecks",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.srcintfrole": "lan"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "top_ports": {
          "terms": {
            "field": "destination.port",
            "size": 10
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Có traffic nào đi từ DMZ ra WAN không?",
    "keywords": [
      "traffic",
      "lưu lượng",
      "từ DMZ",
      "ra WAN",
      "srcintfrole",
      "dstintfrole",
      "wide area network",
      "mạng diện rộng",
      "internet",
      "external",
      "network bytes",
      "packet size",
      "kích thước gói tin"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.srcintfrole": "dmz"
              }
            },
            {
              "term": {
                "fortinet.firewall.dstintfrole": "wan"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "network.bytes",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Phân tích traffic theo interface role (lan/wan/dmz) trong 24h qua",
    "keywords": [
      "phân tích",
      "analysis",
      "traffic",
      "lưu lượng",
      "interface role",
      "lan",
      "wan",
      "dmz",
      "fortinet.firewall.srcintfrole",
      "exists",
      "terms aggregation",
      "wide area network",
      "mạng diện rộng",
      "internet",
      "external",
      "local area network",
      "mạng cục bộ",
      "internal",
      "nội bộ",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.srcintfrole"
              }
            }
          ]
        }
      },
      "aggs": {
        "by_interface_role": {
          "terms": {
            "field": "fortinet.firewall.srcintfrole",
            "size": 10
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Source MAC address nào có nhiều connections nhất?",
    "keywords": [
      "source mac address",
      "địa chỉ mac nguồn",
      "nhiều connections nhất",
      "top connections",
      "source.mac",
      "exists",
      "terms aggregation",
      "kết nối",
      "session",
      "phiên",
      "liên kết",
      "link",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "source.mac"
              }
            }
          ]
        }
      },
      "aggs": {
        "top_macs": {
          "terms": {
            "field": "source.mac",
            "size": 10
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm các kết nối có source port > 50000 (ephemeral ports)",
    "keywords": [
      "kết nối",
      "connections",
      "source port",
      "cổng nguồn",
      "> 50000",
      "ephemeral ports",
      "range",
      "gt",
      "greater than",
      "cổng",
      "service port",
      "network port",
      "TCP/UDP port"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "source.port": {
                  "gt": 50000
                }
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-6h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "source.port",
        "destination.ip",
        "destination.port"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Traffic inbound và outbound chiếm tỷ lệ bao nhiêu?",
    "keywords": [
      "traffic",
      "lưu lượng",
      "inbound",
      "outbound",
      "vào",
      "ra",
      "tỷ lệ",
      "ratio",
      "network.direction",
      "exists",
      "terms aggregation",
      "đi ra",
      "ra ngoài",
      "egress",
      "xuất",
      "outgoing",
      "đi vào",
      "vào trong",
      "ingress",
      "nhập",
      "incoming",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "network.direction"
              }
            }
          ]
        }
      },
      "aggs": {
        "by_direction": {
          "terms": {
            "field": "network.direction",
            "size": 10
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Liệt kê các egress interfaces được sử dụng nhiều nhất",
    "keywords": [
      "egress interfaces",
      "cổng ra",
      "sử dụng nhiều nhất",
      "top usage",
      "observer.egress.interface.name",
      "exists",
      "terms aggregation",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network monitoring - Analyze traffic by interface to optimize routing and identify network bottlenecks",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "observer.egress.interface.name"
              }
            }
          ]
        }
      },
      "aggs": {
        "top_egress": {
          "terms": {
            "field": "observer.egress.interface.name",
            "size": 10
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Top 10 sessions có network.bytes lớn nhất trong 12h qua",
    "keywords": [
      "top 10",
      "sessions",
      "phiên",
      "network.bytes",
      "lưu lượng",
      "lớn nhất",
      "sort",
      "descending",
      "desc",
      "traffic",
      "dữ liệu",
      "data",
      "băng thông",
      "bandwidth",
      "dung lượng",
      "volume",
      "nhiều nhất",
      "hàng đầu",
      "cao nhất",
      "highest",
      "leading",
      "kết nối",
      "connection",
      "phiên làm việc",
      "session connection",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Network performance - Identify top traffic consumers to optimize bandwidth allocation and detect anomalies",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "now-12h"
          }
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "network.bytes",
        "source.user.name",
        "rule.name"
      ],
      "sort": [
        {
          "network.bytes": "desc"
        }
      ],
      "size": 10
    }
  },
  {
    "question": "User nào có tổng packets gửi đi (source.packets) nhiều nhất?",
    "keywords": [
      "user",
      "người dùng",
      "tổng packets",
      "gửi đi",
      "source.packets",
      "nhiều nhất",
      "top",
      "sum",
      "aggregation",
      "order",
      "desc",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "source.user.name"
              }
            }
          ]
        }
      },
      "aggs": {
        "top_users": {
          "terms": {
            "field": "source.user.name",
            "size": 10,
            "order": {
              "total_packets": "desc"
            }
          },
          "aggs": {
            "total_packets": {
              "sum": {
                "field": "source.packets"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm các sessions có packet loss > 10%",
    "keywords": [
      "sessions",
      "phiên",
      "packet loss",
      "mất gói",
      "> 10%",
      "10",
      "fortinet.firewall.packetloss",
      "range",
      "gt",
      "greater than",
      "kết nối",
      "connection",
      "phiên làm việc",
      "session connection"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "fortinet.firewall.packetloss": {
                  "gt": 10
                }
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "fortinet.firewall.packetloss"
      ],
      "sort": [
        {
          "fortinet.firewall.packetloss": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Average bytes per session trong 24h qua là bao nhiêu?",
    "keywords": [
      "average",
      "trung bình",
      "bytes per session",
      "24h qua",
      "avg",
      "aggregation",
      "network.bytes",
      "lưu lượng",
      "traffic",
      "dữ liệu",
      "data",
      "băng thông",
      "bandwidth",
      "dung lượng",
      "volume",
      "phiên",
      "kết nối",
      "connection",
      "phiên làm việc",
      "session connection",
      "network bytes",
      "packet size",
      "kích thước gói tin"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "now-24h"
          }
        }
      },
      "aggs": {
        "avg_bytes": {
          "avg": {
            "field": "network.bytes"
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Kết nối nào có destination.bytes lớn hơn source.bytes (download > upload)?",
    "keywords": [
      "kết nối",
      "connection",
      "destination.bytes",
      "source.bytes",
      "download",
      "upload",
      "so sánh",
      "compare",
      "script",
      ">",
      "lưu lượng",
      "traffic",
      "dữ liệu",
      "data",
      "băng thông",
      "bandwidth",
      "dung lượng",
      "volume"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-6h"
                }
              }
            }
          ],
          "must": {
            "script": {
              "script": {
                "source": "doc['destination.bytes'].value > doc['source.bytes'].value"
              }
            }
          }
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "source.bytes",
        "destination.bytes"
      ],
      "sort": [
        {
          "destination.bytes": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Tổng bandwidth sử dụng trong 1 giờ qua là bao nhiêu?",
    "keywords": [
      "tổng",
      "total",
      "bandwidth",
      "băng thông",
      "1 giờ qua",
      "sum",
      "aggregation",
      "network.bytes",
      "traffic",
      "lưu lượng",
      "throughput",
      "1h",
      "hour",
      "giờ qua",
      "last hour",
      "network bytes",
      "packet size",
      "kích thước gói tin"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "now-1h"
          }
        }
      },
      "aggs": {
        "total_bandwidth": {
          "sum": {
            "field": "network.bytes"
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Top 10 connections có ratio bytes/packets cao nhất (large packets)",
    "keywords": [
      "top 10",
      "connections",
      "kết nối",
      "ratio",
      "tỷ lệ",
      "bytes/packets",
      "large packets",
      "bucket_script",
      "calculation",
      "bytes per packet",
      "lưu lượng",
      "traffic",
      "dữ liệu",
      "data",
      "băng thông",
      "bandwidth",
      "dung lượng",
      "volume",
      "nhiều nhất",
      "hàng đầu",
      "cao nhất",
      "highest",
      "leading",
      "session",
      "phiên",
      "liên kết",
      "link",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Identify top traffic consumers to optimize bandwidth allocation and detect anomalies",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "range": {
                "network.packets": {
                  "gt": 0
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "top_connections": {
          "terms": {
            "field": "source.ip",
            "size": 10,
            "order": {
              "bytes_per_packet": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_packets": {
              "sum": {
                "field": "network.packets"
              }
            },
            "bytes_per_packet": {
              "bucket_script": {
                "buckets_path": {
                  "bytes": "total_bytes",
                  "packets": "total_packets"
                },
                "script": "params.bytes > 0 ? params.bytes / params.packets : 0"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Có session nào có duration < 1 giây nhưng bytes > 1MB? (suspicious)",
    "keywords": [
      "session",
      "phiên",
      "duration",
      "thời lượng",
      "bytes",
      "lưu lượng",
      "suspicious",
      "đáng ngờ",
      "< 1 giây",
      "> 1MB",
      "1000000000",
      "1048576",
      "nanoseconds",
      "range",
      "traffic",
      "dữ liệu",
      "data",
      "băng thông",
      "bandwidth",
      "dung lượng",
      "volume",
      "kết nối",
      "connection",
      "phiên làm việc",
      "session connection",
      "network bytes",
      "packet size",
      "kích thước gói tin"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "event.duration": {
                  "lt": 1000000000
                }
              }
            },
            {
              "range": {
                "network.bytes": {
                  "gt": 1048576
                }
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "event.duration",
        "network.bytes",
        "rule.name"
      ],
      "sort": [
        {
          "network.bytes": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "User nào có average session duration dài nhất?",
    "keywords": [
      "user",
      "người dùng",
      "average session duration",
      "thời lượng trung bình",
      "dài nhất",
      "avg",
      "aggregation",
      "event.duration",
      "order",
      "desc",
      "phiên",
      "kết nối",
      "connection",
      "phiên làm việc",
      "session connection",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network monitoring - Identify long-running sessions to detect persistent connections and potential security issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "source.user.name"
              }
            },
            {
              "exists": {
                "field": "event.duration"
              }
            }
          ]
        }
      },
      "aggs": {
        "by_user": {
          "terms": {
            "field": "source.user.name",
            "size": 10,
            "order": {
              "avg_duration": "desc"
            }
          },
          "aggs": {
            "avg_duration": {
              "avg": {
                "field": "event.duration"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Phân tích distribution của network.bytes (histogram)",
    "keywords": [
      "phân tích",
      "analysis",
      "distribution",
      "phân phối",
      "network.bytes",
      "histogram",
      "interval",
      "aggregation",
      "1048576",
      "lưu lượng",
      "traffic",
      "dữ liệu",
      "data",
      "băng thông",
      "bandwidth",
      "dung lượng",
      "volume",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "now-24h"
          }
        }
      },
      "aggs": {
        "bytes_distribution": {
          "histogram": {
            "field": "network.bytes",
            "interval": 1048576
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Có bao nhiêu MacBooks đang kết nối trong mạng?",
    "keywords": [
      "bao nhiêu",
      "count",
      "MacBooks",
      "thiết bị apple",
      "kết nối",
      "srchwversion",
      "wildcard",
      "cardinality",
      "unique",
      "fortinet.firewall.srchwversion"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "wildcard": {
                "fortinet.firewall.srchwversion": "*MacBook*"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "unique_macbooks": {
          "cardinality": {
            "field": "source.ip"
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Liệt kê tất cả các OS versions đang được sử dụng",
    "keywords": [
      "liệt kê",
      "list",
      "os versions",
      "phiên bản hệ điều hành",
      "srcswversion",
      "fortinet.firewall.srcswversion",
      "exists",
      "terms aggregation",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.srcswversion"
              }
            }
          ]
        }
      },
      "aggs": {
        "os_versions": {
          "terms": {
            "field": "fortinet.firewall.srcswversion",
            "size": 20
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Device nào có nhiều source MAC addresses khác nhau? (MAC spoofing?)",
    "keywords": [
      "device",
      "thiết bị",
      "source mac addresses",
      "địa chỉ mac",
      "khác nhau",
      "mac spoofing",
      "cardinality",
      "unique",
      "host.name",
      "source.mac",
      "order",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "host.name"
              }
            }
          ]
        }
      },
      "aggs": {
        "by_device": {
          "terms": {
            "field": "host.name",
            "size": 20,
            "order": {
              "unique_macs": "desc"
            }
          },
          "aggs": {
            "unique_macs": {
              "cardinality": {
                "field": "source.mac"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm các Windows devices với OS version cũ (< Windows 10)",
    "keywords": [
      "windows devices",
      "os version cũ",
      "hệ điều hành cũ",
      "windows 7",
      "windows 8",
      "must_not",
      "wildcard",
      "fortinet.firewall.osname",
      "fortinet.firewall.srcswversion",
      "< Windows 10"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.osname": "Windows"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ],
          "must_not": [
            {
              "wildcard": {
                "fortinet.firewall.srcswversion": "*10*"
              }
            },
            {
              "wildcard": {
                "fortinet.firewall.srcswversion": "*11*"
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "fortinet.firewall.osname",
        "fortinet.firewall.srcswversion",
        "host.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Top 10 device types (Laptop/Desktop/Mobile) có traffic nhiều nhất",
    "keywords": [
      "top 10",
      "device types",
      "loại thiết bị",
      "laptop",
      "desktop",
      "mobile",
      "traffic nhiều nhất",
      "fortinet.firewall.devtype",
      "exists",
      "sum",
      "order",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "nhiều nhất",
      "hàng đầu",
      "leading",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Identify top traffic consumers to optimize bandwidth allocation and detect anomalies",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.devtype"
              }
            }
          ]
        }
      },
      "aggs": {
        "top_device_types": {
          "terms": {
            "field": "fortinet.firewall.devtype",
            "size": 10,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Có device nào đổi IP address trong 6h qua không?",
    "keywords": [
      "device",
      "thiết bị",
      "đổi IP",
      "ip change",
      "6h qua",
      "host.name",
      "cardinality",
      "source.ip",
      "bucket_selector",
      "> 1",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-6h"
                }
              }
            },
            {
              "exists": {
                "field": "host.name"
              }
            }
          ]
        }
      },
      "aggs": {
        "by_hostname": {
          "terms": {
            "field": "host.name",
            "size": 50
          },
          "aggs": {
            "unique_ips": {
              "cardinality": {
                "field": "source.ip"
              }
            },
            "ip_change": {
              "bucket_selector": {
                "buckets_path": {
                  "ips": "unique_ips"
                },
                "script": "params.ips > 1"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Devices từ vendor Apple chiếm bao nhiêu phần trăm?",
    "keywords": [
      "devices",
      "thiết bị",
      "vendor",
      "hãng",
      "Apple",
      "phần trăm",
      "percentage",
      "fortinet.firewall.srchwvendor",
      "filter aggregation",
      "cardinality",
      "calculation"
    ],
    "scenario": "Application monitoring - Track application usage for visibility, compliance, and network optimization",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.srchwvendor"
              }
            }
          ]
        }
      },
      "aggs": {
        "apple_devices": {
          "filter": {
            "term": {
              "fortinet.firewall.srchwvendor": "Apple"
            }
          },
          "aggs": {
            "count": {
              "cardinality": {
                "field": "source.ip"
              }
            }
          }
        },
        "total_devices": {
          "cardinality": {
            "field": "source.ip"
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm các unidentified devices (không có devtype)",
    "keywords": [
      "unidentified devices",
      "thiết bị không xác định",
      "không có devtype",
      "unknown device",
      "must_not",
      "exists",
      "fortinet.firewall.devtype"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ],
          "must_not": [
            {
              "exists": {
                "field": "fortinet.firewall.devtype"
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "source.mac",
        "host.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Host nào có nhiều failed connections nhất?",
    "keywords": [
      "host",
      "máy chủ",
      "kết nối thất bại",
      "failed connections",
      "nhiều nhất",
      "top",
      "event.outcome",
      "failure",
      "host.name",
      "terms aggregation",
      "kết nối",
      "session",
      "phiên",
      "liên kết",
      "link",
      "outcome",
      "kết quả",
      "result",
      "status",
      "trạng thái",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "event.outcome": "failure"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "top_failed_hosts": {
          "terms": {
            "field": "host.name",
            "size": 10
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Liệt kê các container hoặc cloud instances",
    "keywords": [
      "liệt kê",
      "list",
      "container",
      "cloud instances",
      "máy ảo",
      "should",
      "minimum_should_match",
      "exists",
      "container.id",
      "cloud.instance.id"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "should": [
            {
              "exists": {
                "field": "container.id"
              }
            },
            {
              "exists": {
                "field": "cloud.instance.id"
              }
            }
          ],
          "minimum_should_match": 1,
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "container.id",
        "container.name",
        "cloud.instance.id",
        "cloud.provider",
        "source.ip"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Có IP nào bị đánh dấu là botnet không?",
    "keywords": [
      "ip",
      "botnet",
      "đánh dấu",
      "flagged",
      "malicious",
      "độc hại",
      "exists",
      "fortinet.firewall.botnetip",
      "fortinet.firewall.botnetdomain",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "exists": {
                "field": "fortinet.firewall.botnetip"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "fortinet.firewall.botnetip",
        "fortinet.firewall.botnetdomain",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Tổng số log trong 24 giờ qua là bao nhiêu?",
    "keywords": [
      "tổng số log",
      "đếm log",
      "count logs",
      "24 giờ qua",
      "last 24 hours",
      "value_count",
      "@timestamp",
      "aggregation",
      "24h",
      "một ngày",
      "1 day",
      "24 hours",
      "ngày qua",
      "last day"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "now-24h"
          }
        }
      },
      "aggs": {
        "total_count": {
          "value_count": {
            "field": "@timestamp"
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Đếm số lượng kết nối bị chặn hôm nay",
    "keywords": [
      "đếm",
      "count",
      "kết nối bị chặn",
      "denied connections",
      "hôm nay",
      "today",
      "value_count",
      "now/d",
      "fortinet.firewall.action",
      "deny",
      "bị chặn",
      "blocked",
      "cấm",
      "denied",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "action",
      "hành động",
      "firewall action"
    ],
    "scenario": "Security monitoring - Review blocked traffic patterns to identify security threats and policy violations",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now/d"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "total_denied": {
          "value_count": {
            "field": "@timestamp"
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Có bao nhiêu user đăng nhập thất bại trong 1 giờ qua?",
    "keywords": [
      "bao nhiêu user",
      "count users",
      "đăng nhập thất bại",
      "failed logins",
      "1 giờ qua",
      "cardinality",
      "source.user.name",
      "event.action",
      "event.outcome",
      "1h",
      "hour",
      "giờ qua",
      "last hour",
      "login",
      "authentication",
      "xác thực",
      "sign in",
      "truy cập",
      "access",
      "failure",
      "failed",
      "unsuccessful",
      "không thành công",
      "lỗi",
      "error",
      "outcome",
      "kết quả",
      "result",
      "status",
      "trạng thái",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Security audit - Track failed login attempts to detect brute force attacks, credential stuffing, and unauthorized access attempts",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "event.action": "login"
              }
            },
            {
              "term": {
                "event.outcome": "failure"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-1h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "failed_logins": {
          "cardinality": {
            "field": "source.user.name"
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "IP 10.6.99.78 được gắn với user nào?",
    "keywords": [
      "ip",
      "user",
      "người dùng",
      "gắn với",
      "associated with",
      "10.6.99.78",
      "source.ip",
      "terms",
      "aggregation",
      "source.user.name",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.ip": "10.6.99.78"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "user_names": {
          "terms": {
            "field": "source.user.name",
            "size": 10
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "User nào hoạt động nhiều nhất trong 6 giờ qua?",
    "keywords": [
      "user",
      "người dùng",
      "hoạt động nhiều nhất",
      "most active",
      "top user",
      "6 giờ qua",
      "exists",
      "source.user.name",
      "terms aggregation",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-6h"
                }
              }
            },
            {
              "exists": {
                "field": "source.user.name"
              }
            }
          ]
        }
      },
      "aggs": {
        "top_users": {
          "terms": {
            "field": "source.user.name",
            "size": 15
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tổng số log của user QuynhTX ngày 19-09-2025",
    "keywords": [
      "tổng số log",
      "count logs",
      "user",
      "QuynhTX",
      "ngày cụ thể",
      "specific date",
      "19-09-2025",
      "range",
      "timezone",
      "+07:00",
      "value_count",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Email security - Monitor SMTP traffic to detect spam, phishing attempts, and email-borne threats",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.name": "QuynhTX"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "2025-09-19T00:00:00.000+07:00",
                  "lte": "2025-09-19T23:59:59.999+07:00"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "total_count": {
          "value_count": {
            "field": "@timestamp"
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Ai đăng nhập với quyền Administrator trong 24 giờ qua?",
    "keywords": [
      "ai",
      "user",
      "đăng nhập",
      "login",
      "quyền",
      "role",
      "Administrator",
      "quản trị",
      "source.user.roles",
      "24 giờ qua",
      "24h",
      "một ngày",
      "1 day",
      "24 hours",
      "ngày qua",
      "last day",
      "authentication",
      "xác thực",
      "sign in",
      "truy cập",
      "access",
      "quản trị viên",
      "root",
      "superuser",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Security audit - Monitor administrative access to ensure compliance and detect potential insider threats",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.roles": "Administrator"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "event.action",
        "fortinet.firewall.subtype"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Top 10 quốc gia được truy cập nhiều nhất trong 24 giờ qua",
    "keywords": [
      "top 10",
      "quốc gia",
      "country",
      "truy cập nhiều nhất",
      "top destination",
      "destination.geo.country_name",
      "exists",
      "terms aggregation",
      "24h",
      "một ngày",
      "1 day",
      "24 hours",
      "ngày qua",
      "last day",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "nhiều nhất",
      "hàng đầu",
      "leading",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Compliance monitoring - Analyze geographic traffic patterns for compliance, security, and business intelligence",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "destination.geo.country_name"
              }
            }
          ]
        }
      },
      "aggs": {
        "top_countries": {
          "terms": {
            "field": "destination.geo.country_name",
            "size": 10
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Có kết nối nào từ nước ngoài vào Việt Nam không?",
    "keywords": [
      "kết nối",
      "connection",
      "nước ngoài",
      "foreign",
      "vào Việt Nam",
      "inbound",
      "incoming",
      "destination.geo.country_name",
      "source.geo.country_name",
      "must_not",
      "Vietnam",
      "international",
      "quốc tế",
      "overseas",
      "external",
      "domestic",
      "trong nước",
      "local",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia"
    ],
    "scenario": "Compliance monitoring - Analyze geographic traffic patterns for compliance, security, and business intelligence",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "destination.geo.country_name": "Vietnam"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "source.geo.country_name": "Vietnam"
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "source.geo.country_name",
        "destination.ip",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Nhân viên truy cập website nước ngoài nào trong thời gian gần đây?",
    "keywords": [
      "nhân viên",
      "user",
      "truy cập website",
      "web access",
      "nước ngoài",
      "foreign website",
      "international",
      "http",
      "https",
      "destination.geo.country_name",
      "must_not",
      "Vietnam",
      "foreign",
      "quốc tế",
      "overseas",
      "external",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Compliance monitoring - Analyze geographic traffic patterns for compliance, security, and business intelligence",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "terms": {
                "network.protocol": [
                  "http",
                  "https"
                ]
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-30d"
                }
              }
            }
          ],
          "must_not": [
            {
              "term": {
                "destination.geo.country_name": "Vietnam"
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "destination.ip",
        "destination.geo.country_name",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Top 10 IP bị chặn nhiều nhất hôm nay",
    "keywords": [
      "top 10",
      "ip",
      "bị chặn",
      "denied",
      "hôm nay",
      "today",
      "now/d",
      "fortinet.firewall.action",
      "deny",
      "terms aggregation",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "blocked",
      "cấm",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "nhiều nhất",
      "hàng đầu",
      "leading",
      "action",
      "hành động",
      "firewall action",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security monitoring - Review blocked traffic patterns to identify security threats and policy violations",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now/d"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "top_blocked": {
          "terms": {
            "field": "source.ip",
            "size": 10
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm các kết nối SSH bị chặn trong 2 giờ qua",
    "keywords": [
      "kết nối ssh",
      "ssh connection",
      "bị chặn",
      "denied",
      "2 giờ qua",
      "2h",
      "destination.port",
      "22",
      "fortinet.firewall.action",
      "blocked",
      "cấm",
      "từ chối",
      "reject",
      "ngăn chặn",
      "prevent",
      "secure shell",
      "terminal",
      "remote access",
      "action",
      "hành động",
      "firewall action"
    ],
    "scenario": "Security monitoring - Review blocked traffic patterns to identify security threats and policy violations",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "destination.port": 22
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-2h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "rule.name",
        "fortinet.firewall.action"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Rule nào cho phép traffic nhiều nhất trong 12 giờ qua?",
    "keywords": [
      "rule",
      "policy",
      "cho phép",
      "allow",
      "traffic",
      "lưu lượng",
      "nhiều nhất",
      "top",
      "12 giờ qua",
      "sum",
      "order",
      "desc",
      "network.bytes",
      "quy tắc",
      "chính sách",
      "luật",
      "regulation",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "action",
      "hành động",
      "firewall action",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Identify top traffic consumers to optimize bandwidth allocation and detect anomalies",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.action": "allow"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-12h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "top_allow_rules": {
          "terms": {
            "field": "rule.name",
            "size": 15,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm các IPS alert với mức critical trong 24 giờ qua",
    "keywords": [
      "ips alert",
      "cảnh báo ips",
      "mức",
      "level",
      "critical",
      "nghiêm trọng",
      "fortinet.firewall.crlevel",
      "fortinet.firewall.attack",
      "fortinet.firewall.crscore",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "24h",
      "một ngày",
      "1 day",
      "24 hours",
      "ngày qua",
      "last day",
      "intrusion prevention",
      "phòng chống xâm nhập",
      "security",
      "bảo mật",
      "threat prevention"
    ],
    "scenario": "Threat detection - List high-risk IPS events to prioritize security incident response and protect critical assets",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.crlevel": "critical"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "fortinet.firewall.attack",
        "fortinet.firewall.crscore",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Liệt kê các virus/malware được phát hiện trong 6 giờ qua",
    "keywords": [
      "liệt kê",
      "list",
      "virus",
      "malware",
      "mã độc",
      "phát hiện",
      "detected",
      "exists",
      "fortinet.firewall.virus",
      "fortinet.firewall.virusid",
      "6 giờ qua"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "exists": {
                "field": "fortinet.firewall.virus"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-6h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "fortinet.firewall.virus",
        "fortinet.firewall.virusid",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Tìm các SNAT sessions trong 1 giờ qua",
    "keywords": [
      "snat",
      "source nat",
      "sessions",
      "phiên",
      "1 giờ qua",
      "fortinet.firewall.trandisp",
      "source.nat.ip",
      "source.ip",
      "1h",
      "hour",
      "giờ qua",
      "last hour",
      "kết nối",
      "connection",
      "phiên làm việc",
      "session connection",
      "network bytes",
      "packet size",
      "kích thước gói tin"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.trandisp": "snat"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-1h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "source.nat.ip",
        "destination.ip",
        "network.bytes",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Đếm số lượng NAT sessions theo loại (snat/dnat)",
    "keywords": [
      "đếm",
      "count",
      "nat sessions",
      "loại",
      "type",
      "snat",
      "dnat",
      "fortinet.firewall.trandisp",
      "terms aggregation",
      "phiên",
      "kết nối",
      "connection",
      "phiên làm việc",
      "session connection",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "now-24h"
          }
        }
      },
      "aggs": {
        "nat_types": {
          "terms": {
            "field": "fortinet.firewall.trandisp",
            "size": 10
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm traffic đi qua policy ID 5 trong 4h qua",
    "keywords": [
      "traffic",
      "lưu lượng",
      "policy id",
      "rule id",
      "5",
      "4h qua",
      "fortinet.firewall.policyid",
      "4 giờ qua",
      "chính sách",
      "rule",
      "quy tắc",
      "firewall rule",
      "quy định",
      "action",
      "hành động",
      "firewall action",
      "network bytes",
      "packet size",
      "kích thước gói tin"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "fortinet.firewall.policyid": "5"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-4h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "rule.name",
        "fortinet.firewall.action",
        "network.bytes"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Top 15 rules được sử dụng nhiều nhất theo traffic volume",
    "keywords": [
      "top 15",
      "rules",
      "policy",
      "sử dụng nhiều nhất",
      "traffic volume",
      "lưu lượng",
      "sum",
      "network.bytes",
      "value_count",
      "fortinet.firewall.sessionid",
      "order",
      "quy tắc",
      "chính sách",
      "luật",
      "regulation",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "nhiều nhất",
      "hàng đầu",
      "leading",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Identify top traffic consumers to optimize bandwidth allocation and detect anomalies",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "top_rules": {
          "terms": {
            "field": "rule.name",
            "size": 15,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_sessions": {
              "value_count": {
                "field": "fortinet.firewall.sessionid"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm xem user nào chỉnh sửa trong CNHN_ZONE",
    "keywords": [
      "user",
      "người dùng",
      "chỉnh sửa",
      "Edit",
      "modify",
      "cấu hình",
      "CNHN_ZONE",
      "cfgattr",
      "fortinet.firewall.cfgattr",
      "exists",
      "match",
      "message",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "size": 200,
      "sort": [
        {
          "@timestamp": "asc"
        }
      ],
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "message",
        "fortinet.firewall.cfgattr"
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "exists": {
                "field": "fortinet.firewall.cfgattr"
              }
            },
            {
              "match": {
                "message": "CNHN_ZONE"
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Có kết nối nào từ observer.name = 'FTG-CNHN' đến observer khác không?",
    "keywords": [
      "observer.name",
      "FTG-CNHN",
      "kết nối",
      "observer khác",
      "thiết bị",
      "firewall",
      "observer",
      "term"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "observer.name": "FTG-CNHN"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "observer.name",
        "source.ip",
        "destination.ip",
        "rule.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 50
    }
  },
  {
    "question": "Đếm tổng số log trong ngày hôm nay",
    "keywords": [
      "đếm",
      "tổng số",
      "log",
      "hôm nay",
      "count",
      "now/d",
      "value_count",
      "@timestamp",
      "today"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now/d"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "total_count": {
          "value_count": {
            "field": "@timestamp"
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Có tổng cộng bao nhiêu log của user 'tanln' trong 24 giờ qua?",
    "keywords": [
      "tổng cộng",
      "bao nhiêu",
      "log",
      "user",
      "tanln",
      "24 giờ qua",
      "count",
      "value_count",
      "source.user.name",
      "aggregation",
      "24h",
      "một ngày",
      "1 day",
      "24 hours",
      "ngày qua",
      "last day",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.name": "tanln"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "total_count": {
          "value_count": {
            "field": "@timestamp"
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Thống kê tổng số log từ địa chỉ IP 192.168.1.100 trong tuần này",
    "keywords": [
      "thống kê",
      "tổng số",
      "log",
      "địa chỉ ip",
      "192.168.1.100",
      "tuần này",
      "count",
      "now/w",
      "value_count",
      "source.ip",
      "this week",
      "IP address",
      "địa chỉ",
      "address",
      "statistics",
      "stat",
      "metrics",
      "số liệu",
      "phân tích"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.ip": "192.168.1.100"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now/w"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "total_count": {
          "value_count": {
            "field": "@timestamp"
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tìm 50 log mới nhất trong khoảng thời gian từ 18:00 đến 20:00 ngày 07/10/2025",
    "keywords": [
      "log",
      "khoảng thời gian",
      "18:00",
      "20:00",
      "sắp xếp",
      "mới nhất",
      "desc"
    ],
    "scenario": "Email security - Monitor SMTP traffic to detect spam, phishing attempts, and email-borne threats",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "2025-10-07T18:00:00.000+07:00",
            "lt": "2025-10-07T20:00:00.000+07:00"
          }
        }
      },
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ]
    }
  },
  {
    "question": "Lấy 100 log mới nhất trong khoảng từ 8h đến 9h sáng ngày 08/10/2025",
    "keywords": [
      "log",
      "100",
      "mới nhất",
      "8h",
      "9h",
      "sáng"
    ],
    "scenario": "Email security - Monitor SMTP traffic to detect spam, phishing attempts, and email-borne threats",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "2025-10-08T08:00:00.000+07:00",
            "lt": "2025-10-08T09:00:00.000+07:00"
          }
        }
      },
      "size": 100,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ]
    }
  },
  {
    "question": "Hiển thị các hoạt động từ 22h đêm ngày 05/10/2025 đến 1h sáng ngày 06/10/2025",
    "keywords": [
      "hoạt động",
      "log",
      "22h",
      "đêm",
      "1h",
      "sáng"
    ],
    "scenario": "Security monitoring - Track SSH connections to detect unauthorized access and ensure secure remote administration",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "2025-10-05T22:00:00.000+07:00",
            "lt": "2025-10-06T01:00:00.000+07:00"
          }
        }
      },
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ]
    }
  },
  {
    "question": "Tìm tất cả log của ngày 01/10/2025, hiển thị mới nhất trước",
    "keywords": [
      "log",
      "toàn bộ ngày",
      "cả ngày"
    ],
    "scenario": "Email security - Monitor SMTP traffic to detect spam, phishing attempts, and email-borne threats",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "2025-10-01T00:00:00.000+07:00",
            "lte": "2025-10-01T23:59:59.999+07:00"
          }
        }
      },
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ]
    }
  },
  {
    "question": "Lấy các log trong 2 giờ, từ 10:00 đến 12:00 ngày 06/10/2025, sắp xếp cũ nhất trước",
    "keywords": [
      "log",
      "10:00",
      "12:00",
      "cũ nhất",
      "asc"
    ],
    "scenario": "Email security - Monitor SMTP traffic to detect spam, phishing attempts, and email-borne threats",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "2025-10-06T10:00:00.000+07:00",
            "lt": "2025-10-06T12:00:00.000+07:00"
          }
        }
      },
      "size": 50,
      "sort": [
        {
          "@timestamp": "asc"
        }
      ]
    }
  },
  {
    "question": "Hiển thị 20 log trong khoảng 15:00 đến 15:15 ngày 08/10/2025",
    "keywords": [
      "log",
      "20",
      "15:00",
      "15:15",
      "ngày"
    ],
    "scenario": "Email security - Monitor SMTP traffic to detect spam, phishing attempts, and email-borne threats",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "2025-10-08T15:00:00.000+07:00",
            "lt": "2025-10-08T15:15:00.000+07:00"
          }
        }
      },
      "size": 20,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ]
    }
  },
  {
    "question": "Tìm các log trong giờ làm việc (8h-17h) của ngày 03/10/2025",
    "keywords": [
      "log",
      "giờ làm việc",
      "8h",
      "17h",
      "ngày"
    ],
    "scenario": "Email security - Monitor SMTP traffic to detect spam, phishing attempts, and email-borne threats",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "2025-10-03T08:00:00.000+07:00",
            "lt": "2025-10-03T17:00:00.000+07:00"
          }
        }
      },
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ]
    }
  },
  {
    "question": "Lấy 10 log mới nhất từ 00:00 đến 01:00 sáng ngày 02/10/2025",
    "keywords": [
      "log",
      "10",
      "mới nhất",
      "00:00",
      "01:00",
      "sáng",
      "ngày"
    ],
    "scenario": "Email security - Monitor SMTP traffic to detect spam, phishing attempts, and email-borne threats",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "2025-10-02T00:00:00.000+07:00",
            "lt": "2025-10-02T01:00:00.000+07:00"
          }
        }
      },
      "size": 10,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ]
    }
  },
  {
    "question": "Phân tích log trong 30 phút, từ 11:00 đến 11:30 ngày 04/10/2025",
    "keywords": [
      "log",
      "30 phút",
      "11:00",
      "11:30",
      "ngày"
    ],
    "scenario": "Email security - Monitor SMTP traffic to detect spam, phishing attempts, and email-borne threats",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "2025-10-04T11:00:00.000+07:00",
            "lt": "2025-10-04T11:30:00.000+07:00"
          }
        }
      },
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ]
    }
  },
  {
    "question": "Hiển thị các log trong giờ ăn trưa (12h-13h) của ngày 09/10/2025",
    "keywords": [
      "log",
      "giờ ăn trưa",
      "12h",
      "13h",
      "ngày"
    ],
    "scenario": "Email security - Monitor SMTP traffic to detect spam, phishing attempts, and email-borne threats",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "2025-10-09T12:00:00.000+07:00",
            "lt": "2025-10-09T13:00:00.000+07:00"
          }
        }
      },
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ]
    }
  },
  {
    "question": "Ai đang truy cập internet từ mạng nội bộ qua các cổng ra ngoài trong 7 ngày qua?",
    "keywords": [
      "web",
      "user",
      "người dùng",
      "truy cập internet",
      "internet access",
      "mạng nội bộ",
      "internal network",
      "đi ra ngoài",
      "ra internet",
      "outbound internet",
      "port1",
      "port2",
      "cổng ra",
      "egress",
      "7 ngày qua",
      "observer.egress.interface.name",
      "network.protocol",
      "http",
      "https",
      "tổ chức đích",
      "destination.as.organization.name",
      "network.direction",
      "outbound",
      "external",
      "fortinet.firewall.transip",
      "7d",
      "tuần",
      "week",
      "7 days",
      "tuần qua",
      "last week",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "terms": {
                "network.protocol": [
                  "http",
                  "https"
                ]
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            },
            {
              "terms": {
                "observer.egress.interface.name": [
                  "sdwan",
                  "port1",
                  "port2",
                  "FTTH-WAN1-CMC",
                  "FTTH-WAN2-FPT"
                ]
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "bool": {
                      "filter": [
                        {
                          "terms": {
                            "fortinet.firewall.transip": [
                              "118.70.81.176",
                              "101.99.13.33"
                            ]
                          }
                        },
                        {
                          "terms": {
                            "network.direction": [
                              "outbound",
                              "external"
                            ]
                          }
                        }
                      ]
                    }
                  },
                  {
                    "bool": {
                      "filter": [
                        {
                          "terms": {
                            "source.ip": [
                              "118.70.81.176",
                              "101.99.13.33"
                            ]
                          }
                        },
                        {
                          "terms": {
                            "network.direction": [
                              "outbound",
                              "external"
                            ]
                          }
                        },
                        {
                          "bool": {
                            "must_not": {
                              "exists": {
                                "field": "fortinet.firewall.transip"
                              }
                            }
                          }
                        }
                      ]
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            }
          ]
        }
      },
      "aggs": {
        "by_user": {
          "terms": {
            "field": "source.user.name",
            "size": 50
          },
          "aggs": {
            "top_organizations": {
              "terms": {
                "field": "destination.as.organization.name",
                "size": 10
              },
              "aggs": {
                "org_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        },
        "top_organizations_global": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 20
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_users": {
              "cardinality": {
                "field": "source.user.name"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "User nào sử dụng băng thông ra internet nhiều nhất trong ngày 7/10?",
    "keywords": [
      "web",
      "user",
      "người dùng",
      "băng thông",
      "bandwidth",
      "lưu lượng ra internet",
      "internet traffic",
      "outbound traffic",
      "nhiều nhất",
      "top user",
      "ngày 7/10",
      "specific date",
      "port1",
      "port2",
      "cổng ra ngoài",
      "internet gateway",
      "observer.egress.interface.name",
      "network.bytes",
      "tổ chức đích",
      "destination.as.organization.name",
      "network.direction",
      "outbound",
      "external",
      "fortinet.firewall.transip",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Identify top traffic consumers to optimize bandwidth allocation and detect anomalies",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "2025-10-07T00:00:00.000+07:00",
                  "lte": "2025-10-07T23:59:59.999+07:00"
                }
              }
            },
            {
              "terms": {
                "observer.egress.interface.name": [
                  "sdwan",
                  "port1",
                  "port2",
                  "FTTH-WAN1-CMC",
                  "FTTH-WAN2-FPT"
                ]
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "bool": {
                      "filter": [
                        {
                          "terms": {
                            "fortinet.firewall.transip": [
                              "118.70.81.176",
                              "101.99.13.33"
                            ]
                          }
                        },
                        {
                          "terms": {
                            "network.direction": [
                              "outbound",
                              "external"
                            ]
                          }
                        }
                      ]
                    }
                  },
                  {
                    "bool": {
                      "filter": [
                        {
                          "terms": {
                            "source.ip": [
                              "118.70.81.176",
                              "101.99.13.33"
                            ]
                          }
                        },
                        {
                          "terms": {
                            "network.direction": [
                              "outbound",
                              "external"
                            ]
                          }
                        },
                        {
                          "bool": {
                            "must_not": {
                              "exists": {
                                "field": "fortinet.firewall.transip"
                              }
                            }
                          }
                        }
                      ]
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            }
          ]
        }
      },
      "aggs": {
        "top_users": {
          "terms": {
            "field": "source.user.name",
            "size": 20,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_sessions": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "by_interface": {
              "terms": {
                "field": "observer.egress.interface.name",
                "size": 5
              },
              "aggs": {
                "interface_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "top_organizations": {
              "terms": {
                "field": "destination.as.organization.name",
                "size": 10,
                "order": {
                  "org_bytes": "desc"
                }
              },
              "aggs": {
                "org_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        },
        "organization_stats": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 15,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_users": {
              "cardinality": {
                "field": "source.user.name"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "So sánh lưu lượng ra internet giữa các đường truyền (port1 vs port2)",
    "keywords": [
      "web",
      "so sánh",
      "compare",
      "lưu lượng ra internet",
      "internet traffic",
      "outbound traffic",
      "đường truyền",
      "internet connection",
      "interface",
      "port1",
      "port2",
      "cổng internet",
      "internet gateway",
      "24h qua",
      "observer.egress.interface.name",
      "network.bytes",
      "bandwidth comparison",
      "tổ chức đích",
      "destination.as.organization.name",
      "network.direction",
      "outbound",
      "external",
      "fortinet.firewall.transip",
      "traffic",
      "bytes",
      "băng thông",
      "bandwidth",
      "data flow",
      "dòng dữ liệu",
      "cổng",
      "service port",
      "network port",
      "TCP/UDP port",
      "comparison",
      "đối chiếu",
      "versus",
      "vs",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "terms": {
                "observer.egress.interface.name": [
                  "sdwan",
                  "port1",
                  "port2",
                  "FTTH-WAN1-CMC",
                  "FTTH-WAN2-FPT"
                ]
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "bool": {
                      "filter": [
                        {
                          "terms": {
                            "fortinet.firewall.transip": [
                              "118.70.81.176",
                              "101.99.13.33"
                            ]
                          }
                        },
                        {
                          "terms": {
                            "network.direction": [
                              "outbound",
                              "external"
                            ]
                          }
                        }
                      ]
                    }
                  },
                  {
                    "bool": {
                      "filter": [
                        {
                          "terms": {
                            "source.ip": [
                              "118.70.81.176",
                              "101.99.13.33"
                            ]
                          }
                        },
                        {
                          "terms": {
                            "network.direction": [
                              "outbound",
                              "external"
                            ]
                          }
                        },
                        {
                          "bool": {
                            "must_not": {
                              "exists": {
                                "field": "fortinet.firewall.transip"
                              }
                            }
                          }
                        }
                      ]
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            }
          ]
        }
      },
      "aggs": {
        "by_interface": {
          "terms": {
            "field": "observer.egress.interface.name",
            "size": 10
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_sessions": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "top_users": {
              "terms": {
                "field": "source.user.name",
                "size": 10,
                "order": {
                  "user_bytes": "desc"
                }
              },
              "aggs": {
                "user_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "top_organizations": {
              "terms": {
                "field": "destination.as.organization.name",
                "size": 15,
                "order": {
                  "org_bytes": "desc"
                }
              },
              "aggs": {
                "org_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                },
                "unique_users": {
                  "cardinality": {
                    "field": "source.user.name"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Lưu lượng từ internet vào mạng nội bộ qua các cổng kết nối",
    "keywords": [
      "lưu lượng từ internet",
      "internet inbound traffic",
      "từ ngoài vào",
      "inbound",
      "vào mạng nội bộ",
      "vào công ty",
      "incoming traffic",
      "port1",
      "port2",
      "cổng vào",
      "internet gateway",
      "đường truyền internet",
      "24h qua",
      "observer.ingress.interface.name",
      "external to internal",
      "network.direction",
      "destination.ip",
      "traffic",
      "bytes",
      "băng thông",
      "bandwidth",
      "data flow",
      "dòng dữ liệu",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "terms": {
                "destination.ip": [
                  "118.70.81.176",
                  "101.99.13.33"
                ]
              }
            },
            {
              "term": {
                "network.direction": "inbound"
              }
            },
            {
              "terms": {
                "observer.ingress.interface.name": [
                  "sdwan",
                  "port1",
                  "port2",
                  "FTTH-WAN1-CMC",
                  "FTTH-WAN2-FPT"
                ]
              }
            }
          ]
        }
      },
      "aggs": {
        "by_interface": {
          "terms": {
            "field": "observer.ingress.interface.name",
            "size": 10
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "by_destination": {
              "terms": {
                "field": "destination.ip",
                "size": 10,
                "order": {
                  "dest_bytes": "desc"
                }
              },
              "aggs": {
                "dest_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "by_source_country": {
              "terms": {
                "field": "source.geo.country_name",
                "size": 10
              },
              "aggs": {
                "country_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Phân tích chi tiết user sử dụng internet nhiều nhất theo từng đường truyền",
    "keywords": [
      "web",
      "user",
      "người dùng",
      "sử dụng internet",
      "internet usage",
      "web browsing",
      "truy cập web",
      "nhiều nhất",
      "top user",
      "phân tích chi tiết",
      "breakdown analysis",
      "theo đường truyền",
      "by interface",
      "port1",
      "port2",
      "internet connection",
      "observer.egress.interface.name",
      "network.protocol",
      "http",
      "https",
      "7 ngày qua",
      "tổ chức đích",
      "destination.as.organization.name",
      "network.direction",
      "outbound",
      "external",
      "fortinet.firewall.transip",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "terms": {
                "network.protocol": [
                  "http",
                  "https"
                ]
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            },
            {
              "terms": {
                "observer.egress.interface.name": [
                  "sdwan",
                  "port1",
                  "port2",
                  "FTTH-WAN1-CMC",
                  "FTTH-WAN2-FPT"
                ]
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "bool": {
                      "filter": [
                        {
                          "terms": {
                            "fortinet.firewall.transip": [
                              "118.70.81.176",
                              "101.99.13.33"
                            ]
                          }
                        },
                        {
                          "terms": {
                            "network.direction": [
                              "outbound",
                              "external"
                            ]
                          }
                        }
                      ]
                    }
                  },
                  {
                    "bool": {
                      "filter": [
                        {
                          "terms": {
                            "source.ip": [
                              "118.70.81.176",
                              "101.99.13.33"
                            ]
                          }
                        },
                        {
                          "terms": {
                            "network.direction": [
                              "outbound",
                              "external"
                            ]
                          }
                        },
                        {
                          "bool": {
                            "must_not": {
                              "exists": {
                                "field": "fortinet.firewall.transip"
                              }
                            }
                          }
                        }
                      ]
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            }
          ]
        }
      },
      "aggs": {
        "top_users": {
          "terms": {
            "field": "source.user.name",
            "size": 20,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "by_interface": {
              "terms": {
                "field": "observer.egress.interface.name"
              },
              "aggs": {
                "interface_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                },
                "top_organizations": {
                  "terms": {
                    "field": "destination.as.organization.name",
                    "size": 10,
                    "order": {
                      "org_bytes": "desc"
                    }
                  },
                  "aggs": {
                    "org_bytes": {
                      "sum": {
                        "field": "network.bytes"
                      }
                    }
                  }
                }
              }
            },
            "user_organizations": {
              "terms": {
                "field": "destination.as.organization.name",
                "size": 15,
                "order": {
                  "org_bytes": "desc"
                }
              },
              "aggs": {
                "org_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Lịch sử truy cập internet của nhân viên - những website nào được truy cập trong 7 ngày qua?",
    "keywords": [
      "web",
      "lịch sử truy cập internet",
      "internet history",
      "nhân viên",
      "user",
      "người dùng",
      "website được truy cập",
      "trang web",
      "web browsing history",
      "internet activity",
      "hoạt động internet",
      "7 ngày qua",
      "http",
      "https",
      "network.protocol",
      "tổ chức đích",
      "destination.as.organization.name",
      "network.direction",
      "outbound",
      "external",
      "fortinet.firewall.transip",
      "7d",
      "tuần",
      "week",
      "7 days",
      "tuần qua",
      "last week",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm",
      "observer.egress.interface.name",
      "đường truyền",
      "interface"
    ],
    "scenario": "Web filtering - Monitor web access patterns for security, compliance, and productivity management",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "terms": {
                "network.protocol": [
                  "http",
                  "https"
                ]
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "bool": {
                      "filter": [
                        {
                          "terms": {
                            "fortinet.firewall.transip": [
                              "118.70.81.176",
                              "101.99.13.33"
                            ]
                          }
                        },
                        {
                          "terms": {
                            "network.direction": [
                              "outbound",
                              "external"
                            ]
                          }
                        }
                      ]
                    }
                  },
                  {
                    "bool": {
                      "filter": [
                        {
                          "terms": {
                            "source.ip": [
                              "118.70.81.176",
                              "101.99.13.33"
                            ]
                          }
                        },
                        {
                          "terms": {
                            "network.direction": [
                              "outbound",
                              "external"
                            ]
                          }
                        },
                        {
                          "bool": {
                            "must_not": {
                              "exists": {
                                "field": "fortinet.firewall.transip"
                              }
                            }
                          }
                        }
                      ]
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            }
          ]
        }
      },
      "aggs": {
        "by_user": {
          "terms": {
            "field": "source.user.name",
            "size": 10
          },
          "aggs": {
            "by_interface": {
              "terms": {
                "field": "observer.egress.interface.name",
                "size": 10
              },
              "aggs": {
                "interface_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                },
                "user_domains": {
                  "terms": {
                    "field": "url.domain",
                    "size": 15
                  },
                  "aggs": {
                    "domain_bytes": {
                      "sum": {
                        "field": "network.bytes"
                      }
                    }
                  }
                }
              }
            },
            "user_total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            }
          }
        },
        "top_domains": {
          "terms": {
            "field": "url.domain",
            "size": 20
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_users": {
              "cardinality": {
                "field": "source.user.name"
              }
            },
            "by_interface": {
              "terms": {
                "field": "observer.egress.interface.name",
                "size": 10
              },
              "aggs": {
                "interface_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        }
      },
      "_source": [
        "@timestamp",
        "source.user.name",
        "source.ip",
        "url.original",
        "network.protocol",
        "destination.as.organization.name",
        "observer.egress.interface.name"
      ],
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 100
    }
  },
  {
    "question": "Thống kê top các tổ chức/nhà cung cấp dịch vụ được nhân viên truy cập nhiều nhất",
    "keywords": [
      "web",
      "thống kê",
      "statistics",
      "top tổ chức",
      "top organization",
      "nhà cung cấp dịch vụ",
      "service provider",
      "nhân viên truy cập",
      "employee access",
      "truy cập nhiều nhất",
      "most accessed",
      "destination.as.organization.name",
      "tổ chức đích",
      "internet usage",
      "web traffic",
      "outbound traffic",
      "network.direction",
      "outbound",
      "external",
      "fortinet.firewall.transip",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "nhiều nhất",
      "hàng đầu",
      "leading",
      "stat",
      "metrics",
      "số liệu",
      "phân tích",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "terms": {
                "network.protocol": [
                  "http",
                  "https"
                ]
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            },
            {
              "exists": {
                "field": "destination.as.organization.name"
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "bool": {
                      "filter": [
                        {
                          "terms": {
                            "fortinet.firewall.transip": [
                              "118.70.81.176",
                              "101.99.13.33"
                            ]
                          }
                        },
                        {
                          "terms": {
                            "network.direction": [
                              "outbound",
                              "external"
                            ]
                          }
                        }
                      ]
                    }
                  },
                  {
                    "bool": {
                      "filter": [
                        {
                          "terms": {
                            "source.ip": [
                              "118.70.81.176",
                              "101.99.13.33"
                            ]
                          }
                        },
                        {
                          "terms": {
                            "network.direction": [
                              "outbound",
                              "external"
                            ]
                          }
                        },
                        {
                          "bool": {
                            "must_not": {
                              "exists": {
                                "field": "fortinet.firewall.transip"
                              }
                            }
                          }
                        }
                      ]
                    }
                  }
                ],
                "minimum_should_match": 1
              }
            }
          ]
        }
      },
      "aggs": {
        "top_organizations": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 25,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_users": {
              "cardinality": {
                "field": "source.user.name"
              }
            },
            "total_sessions": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "top_users": {
              "terms": {
                "field": "source.user.name",
                "size": 5,
                "order": {
                  "user_bytes": "desc"
                }
              },
              "aggs": {
                "user_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "by_country": {
              "terms": {
                "field": "destination.geo.country_name",
                "size": 5
              },
              "aggs": {
                "country_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        },
        "organization_summary": {
          "stats": {
            "field": "network.bytes"
          }
        }
      }
    }
  },
  {
    "question": "User truy cập web ra ngoài qua public IP trong 7 ngày qua",
    "keywords": [
      "user",
      "người dùng",
      "truy cập web",
      "web access",
      "public IP",
      "IP công cộng",
      "source.nat.ip",
      "7 ngày qua",
      "network.protocol",
      "http",
      "https",
      "destination.as.organization.name",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "7d",
      "tuần",
      "week",
      "7 days",
      "tuần qua",
      "last week",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm",
      "observer.egress.interface.name",
      "sdwan",
      "port1",
      "port2",
      "FTTH-WAN1-CMC",
      "FTTH-WAN2-FPT"
    ],
    "scenario": "Web filtering - Monitor web access patterns for security, compliance, and productivity management",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "terms": {
                "network.protocol": [
                  "http",
                  "https"
                ]
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            },
            {
              "exists": {
                "field": "destination.as.organization.name"
              }
            },
            {
              "terms": {
                "observer.egress.interface.name": [
                  "sdwan",
                  "port1",
                  "port2",
                  "FTTH-WAN1-CMC",
                  "FTTH-WAN2-FPT"
                ]
              }
            }
          ],
          "should": [
            {
              "terms": {
                "source.nat.ip": [
                  "118.70.81.176",
                  "101.99.13.33"
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "by_user": {
          "terms": {
            "field": "source.user.name",
            "size": 50
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "by_interface": {
              "terms": {
                "field": "observer.egress.interface.name",
                "size": 10
              },
              "aggs": {
                "interface_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                },
                "websites": {
                  "terms": {
                    "field": "destination.as.organization.name",
                    "size": 20
                  },
                  "aggs": {
                    "website_bytes": {
                      "sum": {
                        "field": "network.bytes"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "top_websites": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 30
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_users": {
              "cardinality": {
                "field": "source.user.name"
              }
            },
            "by_interface": {
              "terms": {
                "field": "observer.egress.interface.name",
                "size": 10
              },
              "aggs": {
                "interface_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Ai sử dụng lưu lượng internet nhiều nhất ngày 7/10 (đi ra) qua 5 đường truyền chính",
    "keywords": [
      "ai",
      "user",
      "sử dụng",
      "lưu lượng",
      "internet",
      "nhiều nhất",
      "top",
      "ngày 7/10",
      "outbound",
      "đi ra",
      "network.direction",
      "source.nat.ip",
      "public IP",
      "traffic",
      "bytes",
      "băng thông",
      "bandwidth",
      "data flow",
      "dòng dữ liệu",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm",
      "observer.egress.interface.name",
      "sdwan",
      "port1",
      "port2",
      "FTTH-WAN1-CMC",
      "FTTH-WAN2-FPT",
      "đường truyền",
      "interface",
      "network interface"
    ],
    "scenario": "Network performance - Identify top traffic consumers across multiple network interfaces on a specific day to optimize bandwidth allocation and detect anomalies",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "2025-10-07T00:00:00.000+07:00",
                  "lte": "2025-10-07T23:59:59.999+07:00"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            },
            {
              "terms": {
                "observer.egress.interface.name": [
                  "sdwan",
                  "port1",
                  "port2",
                  "FTTH-WAN1-CMC",
                  "FTTH-WAN2-FPT"
                ]
              }
            }
          ],
          "should": [
            {
              "terms": {
                "source.nat.ip": [
                  "118.70.81.176",
                  "101.99.13.33"
                ]
              }
            }
          ],
          "minimum_should_match": 0
        }
      },
      "aggs": {
        "top_users": {
          "terms": {
            "field": "source.user.name",
            "size": 20,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_sessions": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "by_interface": {
              "terms": {
                "field": "observer.egress.interface.name",
                "size": 5
              },
              "aggs": {
                "interface_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "by_nat_ip": {
              "terms": {
                "field": "source.nat.ip",
                "size": 5
              },
              "aggs": {
                "nat_ip_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        },
        "traffic_by_interface": {
          "terms": {
            "field": "observer.egress.interface.name",
            "size": 5
          },
          "aggs": {
            "interface_total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "top_users_per_interface": {
              "terms": {
                "field": "source.user.name",
                "size": 5,
                "order": {
                  "user_bytes": "desc"
                }
              },
              "aggs": {
                "user_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Traffic đi vào (inbound) đến public IP của tổ chức",
    "keywords": [
      "traffic",
      "lưu lượng",
      "inbound",
      "đi vào",
      "public IP",
      "IP công cộng",
      "destination.ip",
      "observer.ingress.interface.name",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "vào trong",
      "ingress",
      "nhập",
      "incoming",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "size": 50,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "_source": [
        "@timestamp",
        "source.ip",
        "source.geo.country_name",
        "destination.ip",
        "destination.port",
        "network.bytes",
        "rule.name",
        "observer.ingress.interface.name"
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "term": {
                "network.direction": "inbound"
              }
            }
          ],
          "should": [
            {
              "term": {
                "observer.ingress.interface.name": "port1"
              }
            },
            {
              "term": {
                "observer.ingress.interface.name": "port2"
              }
            },
            {
              "terms": {
                "destination.ip": [
                  "118.70.81.176",
                  "101.99.13.33"
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      }
    }
  },
  {
    "question": "Phân tích traffic inbound theo public IP và interface",
    "keywords": [
      "phân tích",
      "analysis",
      "traffic",
      "lưu lượng",
      "inbound",
      "đi vào",
      "public IP",
      "IP công cộng",
      "interface",
      "destination.ip",
      "source.geo.country_name",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "vào trong",
      "ingress",
      "nhập",
      "incoming",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ],
          "should": [
            {
              "term": {
                "observer.ingress.interface.name": "port1"
              }
            },
            {
              "term": {
                "observer.ingress.interface.name": "port2"
              }
            },
            {
              "terms": {
                "destination.ip": [
                  "118.70.81.176",
                  "101.99.13.33"
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "by_public_ip": {
          "terms": {
            "field": "destination.ip",
            "include": [
              "118.70.81.176",
              "101.99.13.33"
            ],
            "size": 10
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_connections": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "top_source_countries": {
              "terms": {
                "field": "source.geo.country_name",
                "size": 10
              }
            },
            "top_ports": {
              "terms": {
                "field": "destination.port",
                "size": 10
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "So sánh traffic outbound và inbound qua public IP",
    "keywords": [
      "so sánh",
      "compare",
      "traffic",
      "lưu lượng",
      "outbound",
      "inbound",
      "đi ra",
      "đi vào",
      "public IP",
      "IP công cộng",
      "network.direction",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "ra ngoài",
      "egress",
      "xuất",
      "outgoing",
      "vào trong",
      "ingress",
      "nhập",
      "incoming",
      "comparison",
      "đối chiếu",
      "versus",
      "vs",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ],
          "should": [
            {
              "bool": {
                "filter": [
                  {
                    "term": {
                      "network.direction": "outbound"
                    }
                  },
                  {
                    "terms": {
                      "source.nat.ip": [
                        "118.70.81.176",
                        "101.99.13.33"
                      ]
                    }
                  }
                ]
              }
            },
            {
              "bool": {
                "filter": [
                  {
                    "term": {
                      "network.direction": "inbound"
                    }
                  },
                  {
                    "terms": {
                      "destination.ip": [
                        "118.70.81.176",
                        "101.99.13.33"
                      ]
                    }
                  }
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "by_direction": {
          "terms": {
            "field": "network.direction",
            "size": 10
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_sessions": {
              "value_count": {
                "field": "@timestamp"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Phân tích top users truy cập web ra ngoài với chi tiết theo đường truyền, public IP và website đích trong 7 ngày qua",
    "scenario": "Web filtering and user activity monitoring - Track top users' web browsing patterns across multiple network interfaces and public IPs for security auditing, compliance, and network performance analysis",
    "keywords": [
      "user",
      "người dùng",
      "truy cập web",
      "web access",
      "web browsing",
      "top users",
      "top",
      "nhiều nhất",
      "highest",
      "cao nhất",
      "7 ngày qua",
      "7 days",
      "7d",
      "tuần",
      "week",
      "http",
      "https",
      "network.protocol",
      "outbound",
      "outbound traffic",
      "lưu lượng đi ra",
      "ra ngoài",
      "external",
      "public IP",
      "IP công cộng",
      "source.nat.ip",
      "118.70.81.176",
      "101.99.13.33",
      "observer.egress.interface.name",
      "đường truyền",
      "interface",
      "sdwan",
      "port1",
      "port2",
      "FTTH-WAN1-CMC",
      "FTTH-WAN2-FPT",
      "url.domain",
      "website",
      "trang web",
      "destination.as.organization.name",
      "tổ chức đích",
      "organization",
      "network bytes",
      "network.bytes",
      "bandwidth",
      "băng thông",
      "data volume",
      "lượng dữ liệu",
      "packet",
      "gói tin",
      "session",
      "phiên",
      "user activity",
      "hoạt động người dùng",
      "breakdown",
      "chi tiết",
      "by interface",
      "theo đường truyền",
      "by IP",
      "theo IP",
      "top websites",
      "website hàng đầu",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "analysis",
      "phân tích",
      "grouping",
      "nhóm",
      "cardinality",
      "counting",
      "sum",
      "tổng",
      "order by",
      "sắp xếp",
      "sort",
      "security",
      "bảo mật",
      "compliance",
      "tuân thủ",
      "audit",
      "kiểm toán",
      "network performance",
      "hiệu suất mạng"
    ],
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "terms": {
                "network.protocol": [
                  "http",
                  "https"
                ]
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            }
          ],
          "should": [
            {
              "terms": {
                "observer.egress.interface.name": [
                  "sdwan",
                  "port1",
                  "port2",
                  "FTTH-WAN1-CMC",
                  "FTTH-WAN2-FPT"
                ]
              }
            },
            {
              "terms": {
                "source.nat.ip": [
                  "118.70.81.176",
                  "101.99.13.33"
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "top_users": {
          "terms": {
            "field": "source.user.name",
            "size": 20,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_sessions": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "by_interface": {
              "terms": {
                "field": "observer.egress.interface.name",
                "size": 10
              },
              "aggs": {
                "interface_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "by_nat_ip": {
              "terms": {
                "field": "source.nat.ip",
                "size": 10
              },
              "aggs": {
                "nat_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "unique_websites": {
              "cardinality": {
                "field": "destination.as.organization.name"
              }
            },
            "top_websites": {
              "terms": {
                "field": "url.domain",
                "size": 10,
                "order": {
                  "site_bytes": "desc"
                }
              },
              "aggs": {
                "site_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        },
        "top_websites_global": {
          "terms": {
            "field": "url.domain",
            "size": 20,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_users": {
              "cardinality": {
                "field": "source.user.name"
              }
            },
            "by_interface": {
              "terms": {
                "field": "observer.egress.interface.name",
                "size": 10
              },
              "aggs": {
                "interface_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "by_nat_ip": {
              "terms": {
                "field": "source.nat.ip",
                "size": 10
              },
              "aggs": {
                "nat_ip_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        },
        "traffic_by_interface": {
          "terms": {
            "field": "observer.egress.interface.name",
            "size": 10
          },
          "aggs": {
            "interface_total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "top_users_per_interface": {
              "terms": {
                "field": "source.user.name",
                "size": 10,
                "order": {
                  "user_bytes": "desc"
                }
              },
              "aggs": {
                "user_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        },
        "traffic_by_nat_ip": {
          "terms": {
            "field": "source.nat.ip",
            "size": 10
          },
          "aggs": {
            "nat_ip_total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "top_users_per_ip": {
              "terms": {
                "field": "source.user.name",
                "size": 10,
                "order": {
                  "user_bytes": "desc"
                }
              },
              "aggs": {
                "user_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Chi tiết các kết nối đi ra qua public IP",
    "keywords": [
      "chi tiết",
      "kết nối",
      "connection",
      "đi ra",
      "outbound",
      "public IP",
      "IP công cộng",
      "source.nat.ip",
      "network.direction",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "size": 100,
      "sort": [
        {
          "network.bytes": "desc"
        }
      ],
      "_source": [
        "@timestamp",
        "source.ip",
        "source.user.name",
        "source.nat.ip",
        "destination.ip",
        "destination.port",
        "destination.as.organization.name",
        "network.bytes",
        "network.protocol",
        "observer.egress.interface.name",
        "rule.name"
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            }
          ],
          "should": [
            {
              "term": {
                "observer.egress.interface.name": "port1"
              }
            },
            {
              "term": {
                "observer.egress.interface.name": "port2"
              }
            },
            {
              "terms": {
                "source.nat.ip": [
                  "118.70.81.176",
                  "101.99.13.33"
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      }
    }
  },
  {
    "question": "User kết nối tới tổ chức nào nhiều nhất trong 7 ngày qua",
    "keywords": [
      "user",
      "người dùng",
      "kết nối",
      "tổ chức",
      "organization",
      "nhiều nhất",
      "top",
      "7 ngày qua",
      "destination.as.organization.name",
      "7d",
      "tuần",
      "week",
      "7 days",
      "tuần qua",
      "last week",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            },
            {
              "exists": {
                "field": "destination.as.organization.name"
              }
            }
          ],
          "should": [
            {
              "term": {
                "observer.egress.interface.name": "port1"
              }
            },
            {
              "term": {
                "observer.egress.interface.name": "port2"
              }
            },
            {
              "terms": {
                "source.nat.ip": [
                  "118.70.81.176",
                  "101.99.13.33"
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "by_user": {
          "terms": {
            "field": "source.user.name",
            "size": 50
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_connections": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "top_organizations": {
              "terms": {
                "field": "destination.as.organization.name",
                "size": 20,
                "order": {
                  "org_bytes": "desc"
                }
              },
              "aggs": {
                "org_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Top tổ chức được truy cập nhiều nhất",
    "keywords": [
      "top",
      "tổ chức",
      "organization",
      "truy cập nhiều nhất",
      "destination.as.organization.name",
      "network.bytes",
      "sum",
      "order",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "nhiều nhất",
      "hàng đầu",
      "leading",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            },
            {
              "exists": {
                "field": "destination.as.organization.name"
              }
            }
          ],
          "should": [
            {
              "term": {
                "observer.egress.interface.name": "port1"
              }
            },
            {
              "term": {
                "observer.egress.interface.name": "port2"
              }
            },
            {
              "terms": {
                "source.nat.ip": [
                  "118.70.81.176",
                  "101.99.13.33"
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "top_organizations": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 30,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_connections": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "unique_users": {
              "cardinality": {
                "field": "source.user.name"
              }
            },
            "top_users": {
              "terms": {
                "field": "source.user.name",
                "size": 10
              }
            },
            "top_protocols": {
              "terms": {
                "field": "network.protocol",
                "size": 5
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Ai sử dụng lưu lượng nhiều nhất ngày 7/10 (theo tổ chức)",
    "keywords": [
      "ai",
      "user",
      "sử dụng",
      "lưu lượng",
      "nhiều nhất",
      "top",
      "ngày 7/10",
      "specific date",
      "tổ chức",
      "organization",
      "destination.as.organization.name",
      "traffic",
      "bytes",
      "băng thông",
      "bandwidth",
      "data flow",
      "dòng dữ liệu",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Identify top traffic consumers to optimize bandwidth allocation and detect anomalies",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "2025-10-07T00:00:00.000+07:00",
                  "lte": "2025-10-07T23:59:59.999+07:00"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            }
          ],
          "should": [
            {
              "term": {
                "observer.egress.interface.name": "port1"
              }
            },
            {
              "term": {
                "observer.egress.interface.name": "port2"
              }
            },
            {
              "terms": {
                "source.nat.ip": [
                  "118.70.81.176",
                  "101.99.13.33"
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "top_users": {
          "terms": {
            "field": "source.user.name",
            "size": 20,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_sessions": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "unique_organizations": {
              "cardinality": {
                "field": "destination.as.organization.name"
              }
            },
            "top_organizations": {
              "terms": {
                "field": "destination.as.organization.name",
                "size": 10,
                "order": {
                  "org_bytes": "desc"
                }
              },
              "aggs": {
                "org_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Chi tiết kết nối tới từng tổ chức",
    "keywords": [
      "chi tiết",
      "kết nối",
      "connection",
      "tổ chức",
      "organization",
      "destination.as.organization.name",
      "destination.as.number",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "size": 100,
      "sort": [
        {
          "network.bytes": "desc"
        }
      ],
      "_source": [
        "@timestamp",
        "source.ip",
        "source.user.name",
        "destination.ip",
        "destination.as.organization.name",
        "destination.as.number",
        "destination.geo.country_name",
        "destination.port",
        "network.protocol",
        "network.bytes",
        "observer.egress.interface.name",
        "rule.name"
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            },
            {
              "exists": {
                "field": "destination.as.organization.name"
              }
            }
          ],
          "should": [
            {
              "term": {
                "observer.egress.interface.name": "port1"
              }
            },
            {
              "term": {
                "observer.egress.interface.name": "port2"
              }
            },
            {
              "terms": {
                "source.nat.ip": [
                  "118.70.81.176",
                  "101.99.13.33"
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      }
    }
  },
  {
    "question": "Phân tích theo cả URL và tổ chức (cho HTTP/HTTPS)",
    "keywords": [
      "phân tích",
      "analysis",
      "URL",
      "tổ chức",
      "organization",
      "HTTP",
      "HTTPS",
      "network.protocol",
      "destination.as.organization.name",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Web filtering - Monitor web access patterns for security, compliance, and productivity management",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "terms": {
                "network.protocol": [
                  "http",
                  "https"
                ]
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            }
          ],
          "should": [
            {
              "term": {
                "observer.egress.interface.name": "port1"
              }
            },
            {
              "term": {
                "observer.egress.interface.name": "port2"
              }
            },
            {
              "terms": {
                "source.nat.ip": [
                  "118.70.81.176",
                  "101.99.13.33"
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "by_organization": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 20,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_users": {
              "cardinality": {
                "field": "source.user.name"
              }
            },
            "top_domains": {
              "terms": {
                "field": "url.domain",
                "size": 10
              }
            },
            "top_users": {
              "terms": {
                "field": "source.user.name",
                "size": 10,
                "order": {
                  "user_bytes": "desc"
                }
              },
              "aggs": {
                "user_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Tìm các tổ chức đáng ngờ hoặc không phổ biến",
    "keywords": [
      "tìm",
      "tổ chức",
      "organization",
      "đáng ngờ",
      "suspicious",
      "không phổ biến",
      "rare",
      "destination.as.organization.name",
      "must_not",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            },
            {
              "exists": {
                "field": "destination.as.organization.name"
              }
            }
          ],
          "should": [
            {
              "term": {
                "observer.egress.interface.name": "port1"
              }
            },
            {
              "term": {
                "observer.egress.interface.name": "port2"
              }
            }
          ],
          "minimum_should_match": 1,
          "must_not": [
            {
              "terms": {
                "destination.as.organization.name": [
                  "GOOGLE",
                  "MICROSOFT-CORP-MSN-AS-BLOCK",
                  "FACEBOOK",
                  "AMAZON-AES",
                  "CLOUDFLARENET",
                  "Kaspersky Lab Switzerland GmbH",
                  "CMC Telecom Infrastructure Company",
                  "NETACTUATE",
                  "Viettel Group",
                  "GOOGLE-CLOUD-PLATFORM"
                ]
              }
            }
          ]
        }
      },
      "aggs": {
        "rare_organizations": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 50,
            "order": {
              "total_connections": "asc"
            }
          },
          "aggs": {
            "total_connections": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "users": {
              "terms": {
                "field": "source.user.name",
                "size": 5
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Xem các sự kiện nguy hiểm của từng tổ chức",
    "keywords": [
      "sự kiện nguy hiểm",
      "dangerous events",
      "tổ chức",
      "organization",
      "destination.as.organization.name",
      "fortinet.firewall.action",
      "deny",
      "attack",
      "virus",
      "botnet",
      "action",
      "hành động",
      "firewall action",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "size": 100,
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "_source": [
        "@timestamp",
        "source.ip",
        "source.user.name",
        "destination.ip",
        "destination.as.organization.name",
        "destination.geo.country_name",
        "destination.port",
        "network.protocol",
        "network.bytes",
        "fortinet.firewall.action",
        "fortinet.firewall.attack",
        "fortinet.firewall.crlevel",
        "fortinet.firewall.virus",
        "fortinet.firewall.botnetip",
        "rule.name"
      ],
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "2025-10-01T00:00:00.000+07:00",
                  "lte": "2025-10-31T23:59:59.999+07:00"
                }
              }
            },
            {
              "exists": {
                "field": "destination.as.organization.name"
              }
            }
          ],
          "should": [
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.attack"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.virus"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.botnetip"
              }
            },
            {
              "terms": {
                "fortinet.firewall.crlevel": [
                  "high",
                  "critical"
                ]
              }
            },
            {
              "terms": {
                "destination.geo.country_name": [
                  "Russia",
                  "China",
                  "North Korea",
                  "Iran"
                ]
              }
            },
            {
              "terms": {
                "destination.port": [
                  22,
                  23,
                  3389,
                  445,
                  135,
                  139,
                  1433,
                  3306
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      }
    }
  },
  {
    "question": "Top 20 tổ chức nguy hiểm với thông tin chi tiết",
    "keywords": [
      "top 20",
      "tổ chức nguy hiểm",
      "dangerous organizations",
      "destination.as.organization.name",
      "fortinet.firewall.action",
      "deny",
      "attack",
      "virus",
      "botnet",
      "nhiều nhất",
      "hàng đầu",
      "cao nhất",
      "highest",
      "leading",
      "action",
      "hành động",
      "firewall action",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "2025-10-01T00:00:00.000+07:00",
                  "lte": "2025-10-31T23:59:59.999+07:00"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            }
          ],
          "should": [
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.attack"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.virus"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.botnetip"
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "top_dangerous_orgs": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 20
          },
          "aggs": {
            "total_incidents": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "unique_users_affected": {
              "cardinality": {
                "field": "source.user.name"
              }
            },
            "unique_ips": {
              "cardinality": {
                "field": "destination.ip"
              }
            },
            "threat_breakdown": {
              "filters": {
                "filters": {
                  "blocked": {
                    "term": {
                      "fortinet.firewall.action": "deny"
                    }
                  },
                  "ips_alerts": {
                    "exists": {
                      "field": "fortinet.firewall.attack"
                    }
                  },
                  "malware": {
                    "exists": {
                      "field": "fortinet.firewall.virus"
                    }
                  },
                  "botnet": {
                    "exists": {
                      "field": "fortinet.firewall.botnetip"
                    }
                  },
                  "critical_ips": {
                    "terms": {
                      "fortinet.firewall.crlevel": [
                        "critical"
                      ]
                    }
                  }
                }
              }
            },
            "top_attacks": {
              "terms": {
                "field": "fortinet.firewall.attack",
                "size": 5
              }
            },
            "top_malware": {
              "terms": {
                "field": "fortinet.firewall.virus",
                "size": 5
              }
            },
            "affected_users": {
              "terms": {
                "field": "source.user.name",
                "size": 10
              }
            },
            "countries": {
              "terms": {
                "field": "destination.geo.country_name",
                "size": 5
              }
            },
            "timeline": {
              "date_histogram": {
                "field": "@timestamp",
                "calendar_interval": "day"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Ma trận rủi ro theo tổ chức và người dùng",
    "keywords": [
      "ma trận rủi ro",
      "risk matrix",
      "tổ chức",
      "organization",
      "người dùng",
      "user",
      "destination.as.organization.name",
      "source.user.name",
      "risk",
      "nguy hiểm",
      "danger",
      "threat",
      "mối đe dọa",
      "위험",
      "rủi ro cao",
      "high risk",
      "action",
      "hành động",
      "firewall action",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Threat detection - Monitor intrusion prevention system events to detect and respond to security threats",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "2025-10-01T00:00:00.000+07:00",
                  "lte": "2025-10-31T23:59:59.999+07:00"
                }
              }
            }
          ],
          "should": [
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.attack"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.virus"
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "risk_matrix": {
          "terms": {
            "field": "source.user.name",
            "size": 30
          },
          "aggs": {
            "dangerous_orgs": {
              "terms": {
                "field": "destination.as.organization.name",
                "size": 10
              },
              "aggs": {
                "threat_count": {
                  "value_count": {
                    "field": "@timestamp"
                  }
                },
                "threat_types": {
                  "filters": {
                    "filters": {
                      "blocked": {
                        "term": {
                          "fortinet.firewall.action": "deny"
                        }
                      },
                      "ips": {
                        "exists": {
                          "field": "fortinet.firewall.attack"
                        }
                      },
                      "malware": {
                        "exists": {
                          "field": "fortinet.firewall.virus"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Tổ chức đích nguy hiểm nhất trong tháng 10",
    "keywords": [
      "tổ chức đích",
      "nguy hiểm nhất",
      "most dangerous",
      "destination organization",
      "tháng 10",
      "October",
      "risk score",
      "destination.as.organization.name",
      "action",
      "hành động",
      "firewall action",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "2025-10-01T00:00:00.000+07:00",
                  "lte": "2025-10-31T23:59:59.999+07:00"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            },
            {
              "exists": {
                "field": "destination.as.organization.name"
              }
            }
          ],
          "should": [
            {
              "term": {
                "observer.egress.interface.name": "port1"
              }
            },
            {
              "term": {
                "observer.egress.interface.name": "port2"
              }
            },
            {
              "terms": {
                "source.nat.ip": [
                  "118.70.81.176",
                  "101.99.13.33"
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "dangerous_organizations": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 50,
            "order": {
              "total_connections": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_connections": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "unique_users": {
              "cardinality": {
                "field": "source.user.name"
              }
            },
            "blocked_count": {
              "filter": {
                "term": {
                  "fortinet.firewall.action": "deny"
                }
              }
            },
            "ips_alerts": {
              "filter": {
                "exists": {
                  "field": "fortinet.firewall.attack"
                }
              },
              "aggs": {
                "critical_count": {
                  "filter": {
                    "terms": {
                      "fortinet.firewall.crlevel": [
                        "high",
                        "critical"
                      ]
                    }
                  }
                },
                "attack_types": {
                  "terms": {
                    "field": "fortinet.firewall.attack",
                    "size": 10
                  }
                }
              }
            },
            "malware_detected": {
              "filter": {
                "exists": {
                  "field": "fortinet.firewall.virus"
                }
              },
              "aggs": {
                "virus_types": {
                  "terms": {
                    "field": "fortinet.firewall.virus",
                    "size": 10
                  }
                }
              }
            },
            "botnet_detected": {
              "filter": {
                "exists": {
                  "field": "fortinet.firewall.botnetip"
                }
              }
            },
            "high_risk_countries": {
              "filter": {
                "terms": {
                  "destination.geo.country_name": [
                    "Russia",
                    "China",
                    "North Korea",
                    "Iran"
                  ]
                }
              }
            },
            "webfilter_blocks": {
              "filter": {
                "bool": {
                  "filter": [
                    {
                      "term": {
                        "fortinet.firewall.subtype": "webfilter"
                      }
                    },
                    {
                      "term": {
                        "fortinet.firewall.action": "deny"
                      }
                    }
                  ]
                }
              }
            },
            "suspicious_ports": {
              "filter": {
                "terms": {
                  "destination.port": [
                    22,
                    23,
                    3389,
                    445,
                    135,
                    139,
                    1433,
                    3306,
                    5432
                  ]
                }
              }
            },
            "after_hours_activity": {
              "filter": {
                "script": {
                  "script": {
                    "source": "doc['@timestamp'].value.getHour() >= 22 || doc['@timestamp'].value.getHour() < 6"
                  }
                }
              }
            },
            "large_data_transfer": {
              "filter": {
                "range": {
                  "network.bytes": {
                    "gt": 104857600
                  }
                }
              }
            },
            "risk_score": {
              "bucket_script": {
                "buckets_path": {
                  "blocked": "blocked_count._count",
                  "ips": "ips_alerts._count",
                  "critical": "ips_alerts>critical_count._count",
                  "malware": "malware_detected._count",
                  "botnet": "botnet_detected._count",
                  "high_risk": "high_risk_countries._count",
                  "webfilter": "webfilter_blocks._count",
                  "sus_ports": "suspicious_ports._count",
                  "after_hours": "after_hours_activity._count",
                  "large_transfer": "large_data_transfer._count"
                },
                "script": "(params.blocked * 10) + (params.ips * 8) + (params.critical * 15) + (params.malware * 20) + (params.botnet * 25) + (params.high_risk * 12) + (params.webfilter * 7) + (params.sus_ports * 5) + (params.after_hours * 3) + (params.large_transfer * 2)"
              }
            },
            "top_risky_users": {
              "terms": {
                "field": "source.user.name",
                "size": 10
              }
            },
            "risk_bucket_sort": {
              "bucket_sort": {
                "sort": [
                  {
                    "risk_score": {
                      "order": "desc"
                    }
                  }
                ],
                "size": 50
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Chỉ lấy các tổ chức có mối đe dọa thực sự",
    "keywords": [
      "tổ chức",
      "organization",
      "đe dọa thực sự",
      "real threats",
      "destination.as.organization.name",
      "fortinet.firewall.attack",
      "fortinet.firewall.virus",
      "fortinet.firewall.botnetip",
      "action",
      "hành động",
      "firewall action",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "2025-10-01T00:00:00.000+07:00",
                  "lte": "2025-10-31T23:59:59.999+07:00"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            },
            {
              "exists": {
                "field": "destination.as.organization.name"
              }
            }
          ],
          "should": [
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.attack"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.virus"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.botnetip"
              }
            },
            {
              "terms": {
                "fortinet.firewall.crlevel": [
                  "high",
                  "critical"
                ]
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "dangerous_organizations": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 30
          },
          "aggs": {
            "total_threats": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "unique_users_affected": {
              "cardinality": {
                "field": "source.user.name"
              }
            },
            "threat_breakdown": {
              "filters": {
                "filters": {
                  "blocked": {
                    "term": {
                      "fortinet.firewall.action": "deny"
                    }
                  },
                  "ips_alerts": {
                    "exists": {
                      "field": "fortinet.firewall.attack"
                    }
                  },
                  "critical_ips": {
                    "term": {
                      "fortinet.firewall.crlevel": "critical"
                    }
                  },
                  "high_ips": {
                    "term": {
                      "fortinet.firewall.crlevel": "high"
                    }
                  },
                  "malware": {
                    "exists": {
                      "field": "fortinet.firewall.virus"
                    }
                  },
                  "botnet": {
                    "exists": {
                      "field": "fortinet.firewall.botnetip"
                    }
                  }
                }
              }
            },
            "top_attacks": {
              "terms": {
                "field": "fortinet.firewall.attack",
                "size": 5
              }
            },
            "top_malware": {
              "terms": {
                "field": "fortinet.firewall.virus",
                "size": 5
              }
            },
            "affected_users": {
              "terms": {
                "field": "source.user.name",
                "size": 10
              }
            },
            "countries": {
              "terms": {
                "field": "destination.geo.country_name",
                "size": 5
              }
            },
            "timeline": {
              "date_histogram": {
                "field": "@timestamp",
                "calendar_interval": "day"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Tính weighted risk score bằng sub-aggregation",
    "keywords": [
      "weighted risk score",
      "sub-aggregation",
      "destination.as.organization.name",
      "bucket_script",
      "bucket_sort",
      "fortinet.firewall.virus",
      "fortinet.firewall.botnetip",
      "fortinet.firewall.crlevel",
      "action",
      "hành động",
      "firewall action",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Threat detection - Monitor intrusion prevention system events to detect and respond to security threats",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "2025-10-01T00:00:00.000+07:00",
                  "lte": "2025-10-31T23:59:59.999+07:00"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "all_orgs": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 1000
          },
          "aggs": {
            "malware_weight": {
              "filter": {
                "exists": {
                  "field": "fortinet.firewall.virus"
                }
              }
            },
            "botnet_weight": {
              "filter": {
                "exists": {
                  "field": "fortinet.firewall.botnetip"
                }
              }
            },
            "critical_ips_weight": {
              "filter": {
                "term": {
                  "fortinet.firewall.crlevel": "critical"
                }
              }
            },
            "blocked_weight": {
              "filter": {
                "term": {
                  "fortinet.firewall.action": "deny"
                }
              }
            },
            "weighted_score": {
              "bucket_script": {
                "buckets_path": {
                  "malware": "malware_weight._count",
                  "botnet": "botnet_weight._count",
                  "critical": "critical_ips_weight._count",
                  "blocked": "blocked_weight._count"
                },
                "script": "(params.malware * 20) + (params.botnet * 25) + (params.critical * 15) + (params.blocked * 10)"
              }
            },
            "sort_by_risk": {
              "bucket_sort": {
                "sort": [
                  {
                    "weighted_score": {
                      "order": "desc"
                    }
                  }
                ],
                "size": 30
              }
            },
            "threat_details": {
              "filters": {
                "filters": {
                  "malware": {
                    "exists": {
                      "field": "fortinet.firewall.virus"
                    }
                  },
                  "botnet": {
                    "exists": {
                      "field": "fortinet.firewall.botnetip"
                    }
                  },
                  "critical_ips": {
                    "term": {
                      "fortinet.firewall.crlevel": "critical"
                    }
                  },
                  "blocked": {
                    "term": {
                      "fortinet.firewall.action": "deny"
                    }
                  }
                }
              }
            },
            "affected_users": {
              "terms": {
                "field": "source.user.name",
                "size": 10
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Tổ chức nguy hiểm nhất trong trong tháng 10",
    "keywords": [
      "tổ chức nguy hiểm nhất",
      "most dangerous organization",
      "tháng ",
      "month",
      "destination.as.organization.name",
      "fortinet.firewall.attack",
      "fortinet.firewall.virus",
      "fortinet.firewall.botnetip",
      "fortinet.firewall.action",
      "action",
      "hành động",
      "firewall action",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "2025-10-01T00:00:00.000+07:00",
                  "lte": "2025-10-31T23:59:59.999+07:00"
                }
              }
            }
          ],
          "should": [
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.attack"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.virus"
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.botnetip"
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "top_dangerous": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 30
          },
          "aggs": {
            "threats": {
              "filters": {
                "filters": {
                  "malware": {
                    "exists": {
                      "field": "fortinet.firewall.virus"
                    }
                  },
                  "botnet": {
                    "exists": {
                      "field": "fortinet.firewall.botnetip"
                    }
                  },
                  "critical": {
                    "term": {
                      "fortinet.firewall.crlevel": "critical"
                    }
                  },
                  "high": {
                    "term": {
                      "fortinet.firewall.crlevel": "high"
                    }
                  },
                  "blocked": {
                    "term": {
                      "fortinet.firewall.action": "deny"
                    }
                  },
                  "ips": {
                    "exists": {
                      "field": "fortinet.firewall.attack"
                    }
                  }
                }
              }
            },
            "users": {
              "cardinality": {
                "field": "source.user.name"
              }
            },
            "bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "top_users": {
              "terms": {
                "field": "source.user.name",
                "size": 5
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Phân tích lưu lượng mạng theo người dùng trong tháng 10/2025",
    "keywords": [
      "phân tích",
      "lưu lượng mạng",
      "network traffic",
      "người dùng",
      "user",
      "tháng 10",
      "October",
      "2025",
      "network.bytes",
      "network.protocol",
      "network.transport",
      "traffic",
      "bytes",
      "băng thông",
      "bandwidth",
      "data flow",
      "dòng dữ liệu",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "2025-10-01T00:00:00.000+07:00",
                  "lt": "2025-10-31T23:59:59.999+07:00"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            }
          ]
        }
      },
      "aggs": {
        "top_users": {
          "terms": {
            "field": "source.user.name",
            "size": 20,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_sessions": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "by_protocol": {
              "terms": {
                "field": "network.protocol",
                "size": 15
              },
              "aggs": {
                "protocol_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "by_transport": {
              "terms": {
                "field": "network.transport",
                "size": 5
              },
              "aggs": {
                "transport_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "top_destinations": {
              "terms": {
                "field": "destination.ip",
                "size": 5
              },
              "aggs": {
                "dest_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "hôm ngày 11-09 có roles admin nào vào hệ thống hay ko?",
    "keywords": [
      "hôm ngày 11-09",
      "admin",
      "roles",
      "Administrator",
      "vào hệ thống",
      "login",
      "đăng nhập",
      "role",
      "quyền",
      "quản trị viên",
      "quản trị",
      "root",
      "superuser",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "size": 50,
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.roles": "Administrator"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "2025-09-11T00:00:00.000+07:00",
                  "lte": "2025-09-11T23:59:59.999+07:00"
                }
              }
            }
          ]
        }
      }
    }
  },
  {
    "question": "Những IP nào kết nối đều đặn vào lúc ngoài giờ làm việc (18h-8h) trong 30 ngày qua?",
    "keywords": [
      "apt detection",
      "advanced persistent threat",
      "phát hiện mối đe dọa",
      "beacon tín hiệu",
      "c2 command control",
      "command and control",
      "ngoài giờ làm việc",
      "after hours",
      "kết nối liên tục",
      "persistent connection",
      "đều đặn",
      "regular pattern",
      "IP addresses",
      "địa chỉ IP",
      "30 ngày",
      "mô hình dài hạn",
      "long term pattern",
      "IP address",
      "địa chỉ",
      "address",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-1d"
                }
              }
            },
            {
              "script": {
                "script": "doc['@timestamp'].value.getHour() < 8 || doc['@timestamp'].value.getHour() > 18"
              }
            }
          ]
        }
      },
      "aggs": {
        "after_hours_ips": {
          "terms": {
            "field": "destination.ip",
            "size": 100
          },
          "aggs": {
            "daily_pattern": {
              "date_histogram": {
                "field": "@timestamp",
                "calendar_interval": "1d"
              }
            },
            "total_connections": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "unique_days": {
              "cardinality": {
                "script": "doc['@timestamp'].value.dayOfYear"
              }
            },
            "consistency_score": {
              "bucket_script": {
                "buckets_path": {
                  "total": "total_connections",
                  "days": "unique_days"
                },
                "script": "params.days > 20 && params.total > 100 ? 1 : 0"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Thống kê 50 máy chủ DNS (destination.ip) được truy vấn nhiều nhất trong 10 ngày qua?",
    "keywords": [
      "thống kê dns",
      "dns statistics",
      "top dns servers",
      "máy chủ dns hàng đầu",
      "aggregations",
      "tổng hợp",
      "terms",
      "cardinality",
      "destination.ip",
      "source.ip",
      "query frequency",
      "tần suất truy vấn",
      "10d qua",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "top",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "domain name system",
      "tên miền",
      "name resolution",
      "phân giải tên",
      "statistics",
      "stat",
      "metrics",
      "số liệu",
      "phân tích",
      "aggregation",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security monitoring - Analyze DNS queries to detect malware communication, data exfiltration, and policy violations",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-10d"
                }
              }
            },
            {
              "term": {
                "network.protocol": "dns"
              }
            },
            {
              "term": {
                "destination.port": 53
              }
            }
          ]
        }
      },
      "aggs": {
        "top_dns_servers": {
          "terms": {
            "field": "destination.ip",
            "size": 50
          },
          "aggs": {
            "query_frequency": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "unique_sources": {
              "cardinality": {
                "field": "source.ip"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Tận dụng công cụ hệ thống (Living off the land): Sử dụng PowerShell, WMI, hoặc công cụ hệ thống bất thường?",
    "keywords": [
      "living off the land",
      "powershell",
      "wmi",
      "fileless malware",
      "tận dụng công cụ",
      "system tools abuse",
      "lạm dụng công cụ hệ thống",
      "công cụ hệ thống",
      "system tools",
      "mã độc không tập tin",
      "certutil",
      "bitsadmin",
      "encoded command",
      "lệnh mã hóa",
      "process execution",
      "thực thi tiến trình",
      "local area network",
      "mạng cục bộ",
      "internal",
      "nội bộ",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network monitoring - Analyze traffic by interface to optimize routing and identify network bottlenecks",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            }
          ],
          "should": [
            {
              "wildcard": {
                "process.name": "*powershell*"
              }
            },
            {
              "wildcard": {
                "process.name": "*wmic*"
              }
            },
            {
              "wildcard": {
                "process.name": "*certutil*"
              }
            },
            {
              "wildcard": {
                "process.name": "*bitsadmin*"
              }
            },
            {
              "wildcard": {
                "process.command_line": "*-EncodedCommand*"
              }
            },
            {
              "wildcard": {
                "process.command_line": "*DownloadString*"
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "suspicious_processes": {
          "terms": {
            "field": "process.name",
            "size": 20
          },
          "aggs": {
            "by_user": {
              "terms": {
                "field": "source.user.name"
              }
            },
            "command_patterns": {
              "terms": {
                "field": "process.command_line"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Có tài khoản nào đột ngột truy cập nhiều máy chủ trong thời gian ngắn?",
    "keywords": [
      "lateral movement",
      "di chuyển ngang",
      "credential abuse",
      "lạm dụng đăng nhập",
      "truy cập đa máy chủ",
      "multiple servers",
      "thời gian ngắn",
      "short time",
      "đột ngột",
      "sudden access",
      "tài khoản",
      "account",
      "user activity",
      "hoạt động người dùng",
      "suspicious access",
      "truy cập đáng nghi",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "term": {
                "network.direction": "internal"
              }
            }
          ]
        }
      },
      "aggs": {
        "by_user": {
          "terms": {
            "field": "source.user.name",
            "size": 50
          },
          "aggs": {
            "unique_destinations": {
              "cardinality": {
                "field": "destination.ip"
              }
            },
            "destination_details": {
              "terms": {
                "field": "destination.ip",
                "size": 20
              },
              "aggs": {
                "first_access": {
                  "min": {
                    "field": "@timestamp"
                  }
                },
                "services_accessed": {
                  "terms": {
                    "field": "destination.port"
                  }
                }
              }
            },
            "suspicious_spread": {
              "bucket_selector": {
                "buckets_path": {
                  "destinations": "unique_destinations"
                },
                "script": "params.destinations > 10"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Tấn công Pass-the-Hash: Xác thực từ các workstation bất thường?",
    "keywords": [
      "pass-the-hash",
      "pass the hash",
      "tấn công hash",
      "hash attack",
      "xác thực bất thường",
      "unusual authentication",
      "workstation lạ",
      "unusual workstation",
      "ntlm hash",
      "authentication",
      "xác thực",
      "đăng nhập",
      "login",
      "credential theft",
      "đánh cắp thông tin đăng nhập",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Threat detection - Monitor intrusion prevention system events to detect and respond to security threats",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "term": {
                "event.action": "authentication"
              }
            }
          ]
        }
      },
      "aggs": {
        "by_user": {
          "terms": {
            "field": "source.user.name",
            "size": 50
          },
          "aggs": {
            "workstation_diversity": {
              "cardinality": {
                "field": "source.hostname"
              }
            },
            "auth_methods": {
              "terms": {
                "field": "fortinet.firewall.authmethod"
              }
            },
            "unusual_workstations": {
              "bucket_selector": {
                "buckets_path": {
                  "diversity": "workstation_diversity"
                },
                "script": "params.diversity > 5"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Mô hình truy cập dữ liệu thông thường của user 'nguyenvanb' trong 90 ngày qua?",
    "keywords": [
      "insider threat",
      "mối đe dọa nội bộ",
      "mô hình truy cập",
      "access pattern",
      "baseline behavior",
      "hành vi bình thường",
      "normal behavior",
      "user pattern",
      "nguyenvanb",
      "user activity",
      "hoạt động người dùng",
      "data access",
      "truy cập dữ liệu",
      "90 ngày",
      "90 days",
      "thông thường",
      "typical",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.name": "nguyenvanb"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-90d"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "access_patterns": {
          "date_histogram": {
            "field": "@timestamp",
            "calendar_interval": "1w"
          },
          "aggs": {
            "resources_accessed": {
              "terms": {
                "field": "destination.ip"
              }
            },
            "data_volume": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "access_times": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "1h"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Hoạt động gần đây (30 ngày qua) có bất thường so với mức cơ bản không?",
    "keywords": [
      "deviation analysis",
      "phân tích độ lệch",
      "hoạt động gần đây",
      "recent activity",
      "baseline comparison",
      "so sánh mức cơ bản",
      "bất thường",
      "anomaly",
      "unusual",
      "hành vi thay đổi",
      "behavior change",
      "anomaly detection",
      "phát hiện bất thường",
      "30 ngày",
      "30 days",
      "mức cơ bản",
      "baseline",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.name": "nguyenvanb"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-30d"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "recent_vs_baseline": {
          "filters": {
            "filters": {
              "recent": {
                "range": {
                  "@timestamp": {
                    "gte": "now-30d"
                  }
                }
              },
              "baseline": {
                "range": {
                  "@timestamp": {
                    "gte": "now-120d",
                    "lt": "now-30d"
                  }
                }
              }
            }
          },
          "aggs": {
            "avg_daily_activity": {
              "date_histogram": {
                "field": "@timestamp",
                "calendar_interval": "1d"
              }
            },
            "unique_resources": {
              "cardinality": {
                "field": "destination.ip"
              }
            },
            "data_transfer": {
              "sum": {
                "field": "network.bytes"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Tải xuống hàng loạt (Mass download): Có tải xuống nhiều files trong thời gian ngắn?",
    "keywords": [
      "data exfiltration",
      "đánh cắp dữ liệu",
      "tải xuống hàng loạt",
      "mass download",
      "bulk download",
      "bulk transfer",
      "dữ liệu nhạy cảm",
      "sensitive data",
      "suspicious download",
      "tải xuống đáng nghi",
      "nhiều files",
      "multiple files",
      "thời gian ngắn",
      "short time",
      "download pattern",
      "mô hình tải xuống",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.name": "nguyenvanb"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            }
          ]
        }
      },
      "aggs": {
        "download_analysis": {
          "date_histogram": {
            "field": "@timestamp",
            "fixed_interval": "1h"
          },
          "aggs": {
            "file_count": {
              "value_count": {
                "field": "url.original"
              }
            },
            "total_bytes": {
              "sum": {
                "field": "source.bytes"
              }
            },
            "suspicious_volume": {
              "bucket_selector": {
                "buckets_path": {
                  "files": "file_count",
                  "bytes": "total_bytes"
                },
                "script": "params.files > 100 || params.bytes > 1073741824"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Sử dụng tài khoản đặc quyền: Tài khoản quản trị có được sử dụng đúng mục đích?",
    "keywords": [
      "compliance audit",
      "kiểm toán tuân thủ",
      "tài khoản đặc quyền",
      "privileged account",
      "admin account",
      "administrator",
      "admin usage",
      "sử dụng quản trị",
      "quyền quản trị",
      "admin rights",
      "compliance check",
      "kiểm tra tuân thủ",
      "đúng mục đích",
      "proper usage",
      "gdpr",
      "data protection",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-30d"
                }
              }
            },
            {
              "terms": {
                "source.user.roles": [
                  "admin",
                  "Administrator",
                  "root"
                ]
              }
            }
          ]
        }
      },
      "aggs": {
        "admin_usage": {
          "terms": {
            "field": "source.user.name",
            "size": 20
          },
          "aggs": {
            "actions_performed": {
              "terms": {
                "field": "event.action"
              }
            },
            "resources_accessed": {
              "terms": {
                "field": "destination.ip"
              }
            },
            "time_pattern": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "1h"
              }
            },
            "total_actions": {
              "value_count": {
                "field": "event.action"
              }
            },
            "compliance_check": {
              "bucket_script": {
                "buckets_path": {
                  "actions": "total_actions"
                },
                "script": "params.actions > 0 ? 1 : 0"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Quyền được quên (Right to be forgotten): Dữ liệu của người dùng đã được xóa theo yêu cầu chưa?",
    "keywords": [
      "gdpr compliance",
      "tuân thủ gdpr",
      "quyền được quên",
      "right to be forgotten",
      "data deletion",
      "xóa dữ liệu",
      "delete data",
      "privacy compliance",
      "tuân thủ quyền riêng tư",
      "data removal",
      "loại bỏ dữ liệu",
      "user data",
      "dữ liệu người dùng",
      "deletion verification",
      "xác minh xóa",
      "deleted_user",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-90d"
                }
              }
            },
            {
              "term": {
                "source.user.name": "deleted_user_123"
              }
            }
          ]
        }
      },
      "aggs": {
        "deletion_verification": {
          "date_histogram": {
            "field": "@timestamp",
            "calendar_interval": "1d"
          },
          "aggs": {
            "data_access": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "systems_accessed": {
              "terms": {
                "field": "destination.ip"
              }
            },
            "data_presence": {
              "bucket_selector": {
                "buckets_path": {
                  "access": "data_access"
                },
                "script": "params.access > 0"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Machine nào đầu tiên có signs của file encryption?",
    "keywords": [
      "ransomware detection",
      "phát hiện ransomware",
      "file encryption",
      "mã hóa tập tin",
      "patient zero",
      "bệnh nhân số 0",
      "encryption signs",
      "dấu hiệu mã hóa",
      "ransomware outbreak",
      "bùng phát ransomware",
      "initial infection",
      "nhiễm bệnh ban đầu",
      "đầu tiên",
      "first",
      "machine",
      "máy tính",
      "signs",
      "dấu hiệu",
      "encrypted",
      "mã hóa",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-48h"
                }
              }
            },
            {
              "terms": {
                "file.extension": [
                  "encrypted",
                  "locked",
                  "crypt"
                ]
              }
            }
          ]
        }
      },
      "aggs": {
        "infection_timeline": {
          "terms": {
            "field": "host.name",
            "size": 100
          },
          "aggs": {
            "first_encryption": {
              "min": {
                "field": "@timestamp"
              }
            },
            "encrypted_files": {
              "value_count": {
                "field": "file.name"
              }
            },
            "file_types": {
              "terms": {
                "field": "file.extension"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "SQL Injection attempts: Pattern và success rate?",
    "keywords": [
      "sql injection",
      "tấn công sql injection",
      "web application attack",
      "tấn công ứng dụng web",
      "injection patterns",
      "mô hình injection",
      "success rate",
      "tỷ lệ thành công",
      "database security",
      "bảo mật cơ sở dữ liệu",
      "web security",
      "bảo mật web",
      "sql",
      "injection",
      "database",
      "cơ sở dữ liệu",
      "pattern",
      "mô hình",
      "attempts",
      "nỗ lực",
      "tấn công",
      "attack",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "url.query"
              }
            }
          ],
          "should": [
            {
              "wildcard": {
                "url.query": "*union*select*"
              }
            },
            {
              "wildcard": {
                "url.query": "*or*1=1*"
              }
            },
            {
              "wildcard": {
                "url.query": "*drop*table*"
              }
            },
            {
              "wildcard": {
                "url.query": "*insert*into*"
              }
            },
            {
              "wildcard": {
                "url.query": "*'*or*'*"
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "injection_analysis": {
          "terms": {
            "field": "source.ip",
            "size": 100
          },
          "aggs": {
            "attack_patterns": {
              "terms": {
                "field": "url.query"
              }
            },
            "response_codes": {
              "terms": {
                "field": "http.response.status_code"
              }
            },
            "successful_attempts": {
              "filter": {
                "term": {
                  "http.response.status_code": 200
                }
              }
            },
            "success_rate": {
              "bucket_script": {
                "buckets_path": {
                  "total": "_count",
                  "success": "successful_attempts>_count"
                },
                "script": "params.total > 0 ? (params.success / params.total) * 100 : 0"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Tối ưu hóa chi phí băng thông: Phân tích sử dụng vs dung lượng?",
    "keywords": [
      "bandwidth optimization",
      "tối ưu hóa băng thông",
      "cost analysis",
      "phân tích chi phí",
      "usage vs capacity",
      "sử dụng vs dung lượng",
      "network efficiency",
      "hiệu quả mạng",
      "resource utilization",
      "sử dụng tài nguyên",
      "chi phí",
      "cost",
      "băng thông",
      "bandwidth",
      "tối ưu hóa",
      "optimization",
      "phân tích",
      "analysis",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "now-3d"
          }
        }
      },
      "aggs": {
        "bandwidth_cost_analysis": {
          "date_histogram": {
            "field": "@timestamp",
            "calendar_interval": "1d"
          },
          "aggs": {
            "daily_usage": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "peak_hour_usage": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "1h"
              },
              "aggs": {
                "hourly_usage": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "95th_percentile_usage": {
              "percentiles_bucket": {
                "buckets_path": "peak_hour_usage>hourly_usage",
                "percents": [
                  95
                ]
              }
            },
            "underutilization_score": {
              "bucket_script": {
                "buckets_path": {
                  "daily": "daily_usage",
                  "peak": "95th_percentile_usage[95.0]"
                },
                "script": "params.peak > 0 ? (params.daily / (params.peak * 24)) * 100 : 0"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Hiệu quả làm việc từ xa: Mô hình sử dụng VPN và tương quan năng suất?",
    "keywords": [
      "remote work",
      "làm việc từ xa",
      "work from home",
      "làm việc tại nhà",
      "vpn usage",
      "sử dụng vpn",
      "productivity correlation",
      "tương quan năng suất",
      "remote productivity",
      "năng suất từ xa",
      "hiệu quả",
      "effectiveness",
      "từ xa",
      "remote",
      "vpn",
      "mô hình sử dụng",
      "usage pattern",
      "tương quan",
      "correlation",
      "virtual private network",
      "mạng riêng ảo",
      "tunnel",
      "kết nối bảo mật",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Remote access - Monitor VPN connections to ensure secure remote access and troubleshoot connectivity issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-3d"
                }
              }
            },
            {
              "range": {
                "source.ip": {
                  "gte": "192.168.0.0",
                  "lte": "192.168.255.255"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "remote_work_analysis": {
          "terms": {
            "field": "source.user.name",
            "size": 100
          },
          "aggs": {
            "vpn_usage_pattern": {
              "date_histogram": {
                "field": "@timestamp",
                "calendar_interval": "1d"
              },
              "aggs": {
                "daily_vpn_hours": {
                  "date_histogram": {
                    "field": "@timestamp",
                    "fixed_interval": "1h"
                  },
                  "aggs": {
                    "active_hour": {
                      "bucket_selector": {
                        "buckets_path": {
                          "count": "_count"
                        },
                        "script": "params.count > 10"
                      }
                    }
                  }
                }
              }
            },
            "remote_productivity": {
              "filters": {
                "filters": {
                  "business_hours": {
                    "script": {
                      "script": "doc['@timestamp'].value.getHour() >= 8 && doc['@timestamp'].value.getHour() <= 17"
                    }
                  },
                  "off_hours": {
                    "script": {
                      "script": "doc['@timestamp'].value.getHour() < 8 || doc['@timestamp'].value.getHour() > 17"
                    }
                  }
                }
              },
              "aggs": {
                "activity_count": {
                  "value_count": {
                    "field": "@timestamp"
                  }
                },
                "data_usage": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Báo cáo truy cập dữ liệu nhạy cảm theo quy định GDPR: Ai đã truy cập thông tin từ EU trong 90 ngày qua?",
    "keywords": [
      "GDPR compliance",
      "tuân thủ GDPR",
      "EU access",
      "truy cập EU",
      "data protection",
      "bảo vệ dữ liệu",
      "compliance report",
      "báo cáo tuân thủ",
      "90 ngày",
      "privacy regulation",
      "quy định bảo mật",
      "user activity",
      "hoạt động người dùng",
      "action",
      "hành động",
      "firewall action",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-30d"
                }
              }
            },
            {
              "term": {
                "source.geo.continent_name": "Europe"
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "terms": {
                      "destination.port": [
                        443,
                        80,
                        8080
                      ]
                    }
                  },
                  {
                    "term": {
                      "fortinet.firewall.action": "accept"
                    }
                  }
                ]
              }
            }
          ]
        }
      },
      "aggs": {
        "gdpr_access_report": {
          "terms": {
            "field": "source.user.name",
            "size": 100
          },
          "aggs": {
            "access_countries": {
              "terms": {
                "field": "source.geo.country_name",
                "size": 20
              }
            },
            "access_timeline": {
              "date_histogram": {
                "field": "@timestamp",
                "calendar_interval": "1d"
              }
            },
            "data_volume": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_destinations": {
              "cardinality": {
                "field": "destination.ip"
              }
            },
            "session_count": {
              "value_count": {
                "field": "@timestamp"
              }
            }
          }
        },
        "eu_traffic_summary": {
          "filter": {
            "term": {
              "source.geo.continent_name": "Europe"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_users": {
              "cardinality": {
                "field": "source.user.name"
              }
            }
          }
        }
      },
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 1000
    }
  },
  {
    "question": "Kiểm toán quyền truy cập đặc quyền: Tài khoản admin nào có hoạt động bất thường?",
    "keywords": [
      "privileged access",
      "truy cập đặc quyền",
      "admin accounts",
      "tài khoản admin",
      "unusual activity",
      "hoạt động bất thường",
      "audit privileged access",
      "kiểm toán quyền admin",
      "insider threat",
      "mối đe dọa nội bộ",
      "administrative rights",
      "quyền quản trị",
      "administrator",
      "quản trị viên",
      "quản trị",
      "root",
      "superuser",
      "action",
      "hành động",
      "firewall action",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "outcome",
      "kết quả",
      "result",
      "status",
      "trạng thái",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-30d"
                }
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "wildcard": {
                      "source.user.name": "*admin*"
                    }
                  },
                  {
                    "wildcard": {
                      "source.user.name": "*root*"
                    }
                  },
                  {
                    "term": {
                      "source.user.roles": "Administrator"
                    }
                  },
                  {
                    "term": {
                      "source.user.group.name": "administrators"
                    }
                  }
                ]
              }
            }
          ]
        }
      },
      "aggs": {
        "admin_activity_analysis": {
          "terms": {
            "field": "source.user.name",
            "size": 50
          },
          "aggs": {
            "login_pattern": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "1h"
              }
            },
            "after_hours_activity": {
              "filter": {
                "script": {
                  "script": {
                    "source": "doc['@timestamp'].value.getHour() < 6 || doc['@timestamp'].value.getHour() > 22"
                  }
                }
              }
            },
            "geographic_locations": {
              "terms": {
                "field": "source.geo.country_name",
                "size": 10
              }
            },
            "failed_attempts": {
              "filter": {
                "term": {
                  "event.outcome": "failure"
                }
              }
            },
            "successful_connections": {
              "filter": {
                "term": {
                  "fortinet.firewall.action": "accept"
                }
              }
            },
            "data_access_volume": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_destinations": {
              "cardinality": {
                "field": "destination.ip"
              }
            }
          }
        },
        "risk_indicators": {
          "filters": {
            "filters": {
              "multiple_countries": {
                "range": {
                  "source.geo.country_name": {
                    "gte": 2
                  }
                }
              },
              "high_volume_access": {
                "range": {
                  "network.bytes": {
                    "gte": 10485760
                  }
                }
              },
              "weekend_access": {
                "bool": {
                  "filter": {
                    "script": {
                      "script": {
                        "source": "doc['@timestamp'].value.getDayOfWeek() >= 6"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Email Security: Phát hiện email phishing và malware qua traffic SMTP/POP3/IMAP?",
    "keywords": [
      "email phishing",
      "phishing qua email",
      "malware email",
      "email độc hại",
      "SMTP traffic",
      "lưu lượng SMTP",
      "email security",
      "bảo mật email",
      "suspicious attachments",
      "file đính kèm đáng nghi",
      "email filtering",
      "lọc email",
      "spam detection",
      "phát hiện spam",
      "action",
      "hành động",
      "firewall action",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "accept"
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "term": {
                      "destination.port": 25
                    }
                  },
                  {
                    "term": {
                      "destination.port": 110
                    }
                  },
                  {
                    "term": {
                      "destination.port": 143
                    }
                  },
                  {
                    "term": {
                      "destination.port": 993
                    }
                  },
                  {
                    "term": {
                      "destination.port": 995
                    }
                  }
                ]
              }
            }
          ]
        }
      },
      "aggs": {
        "email_traffic_analysis": {
          "terms": {
            "field": "destination.port",
            "size": 10
          },
          "aggs": {
            "email_servers": {
              "terms": {
                "field": "destination.ip",
                "size": 30
              }
            },
            "email_users": {
              "terms": {
                "field": "source.user.name",
                "size": 50
              }
            },
            "email_volume": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "connection_timeline": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "1h"
              }
            },
            "external_servers": {
              "filter": {
                "bool": {
                  "must_not": [
                    {
                      "term": {
                        "network.direction": "internal"
                      }
                    }
                  ]
                }
              },
              "aggs": {
                "server_countries": {
                  "terms": {
                    "field": "destination.geo.country_name",
                    "size": 20
                  }
                },
                "server_organizations": {
                  "terms": {
                    "field": "destination.as.organization.name",
                    "size": 15
                  }
                }
              }
            }
          }
        },
        "suspicious_patterns": {
          "filters": {
            "filters": {
              "large_attachments": {
                "range": {
                  "network.bytes": {
                    "gte": 10485760
                  }
                }
              },
              "unusual_hours": {
                "bool": {
                  "filter": {
                    "script": {
                      "script": {
                        "source": "doc['@timestamp'].value.getHour() < 6 || doc['@timestamp'].value.getHour() > 22"
                      }
                    }
                  }
                }
              },
              "foreign_servers": {
                "bool": {
                  "must_not": [
                    {
                      "terms": {
                        "destination.geo.country_name": [
                          "Vietnam",
                          "United States"
                        ]
                      }
                    }
                  ]
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Data Loss Prevention: Phát hiện truyền file lớn ra ngoài qua FTP/HTTP?",
    "keywords": [
      "data loss prevention",
      "ngăn chặn mất dữ liệu",
      "file transfer",
      "truyền file",
      "data exfiltration",
      "đánh cắp dữ liệu",
      "large file upload",
      "upload file lớn",
      "FTP traffic",
      "lưu lượng FTP",
      "HTTP upload",
      "upload qua HTTP",
      "data leakage",
      "rò rỉ dữ liệu",
      "action",
      "hành động",
      "firewall action",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Web filtering - Monitor web access patterns for security, compliance, and productivity management",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-4h"
                }
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "accept"
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "term": {
                      "destination.port": 21
                    }
                  },
                  {
                    "term": {
                      "destination.port": 22
                    }
                  },
                  {
                    "term": {
                      "destination.port": 80
                    }
                  },
                  {
                    "term": {
                      "destination.port": 443
                    }
                  }
                ]
              }
            },
            {
              "range": {
                "network.bytes": {
                  "gte": 52428800
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "large_transfers": {
          "terms": {
            "field": "source.ip",
            "size": 50
          },
          "aggs": {
            "transfer_destinations": {
              "terms": {
                "field": "destination.ip",
                "size": 30
              }
            },
            "total_data_sent": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "transfer_protocols": {
              "terms": {
                "field": "destination.port",
                "size": 10
              }
            },
            "transfer_timeline": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "30m"
              },
              "aggs": {
                "hourly_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "user_context": {
              "terms": {
                "field": "source.user.name",
                "size": 20
              }
            },
            "destination_countries": {
              "terms": {
                "field": "destination.geo.country_name",
                "size": 15
              }
            }
          }
        },
        "protocol_analysis": {
          "terms": {
            "field": "destination.port",
            "size": 10
          },
          "aggs": {
            "avg_transfer_size": {
              "avg": {
                "field": "network.bytes"
              }
            },
            "max_transfer_size": {
              "max": {
                "field": "network.bytes"
              }
            },
            "transfer_frequency": {
              "value_count": {
                "field": "@timestamp"
              }
            }
          }
        },
        "risk_indicators": {
          "filters": {
            "filters": {
              "very_large_files": {
                "range": {
                  "network.bytes": {
                    "gte": 1073741824
                  }
                }
              },
              "encrypted_transfers": {
                "terms": {
                  "destination.port": [
                    22,
                    443,
                    990,
                    989
                  ]
                }
              },
              "suspicious_destinations": {
                "bool": {
                  "must_not": [
                    {
                      "terms": {
                        "destination.as.organization.name": [
                          "GOOGLE",
                          "MICROSOFT-CORP-MSN-AS-BLOCK",
                          "FACEBOOK",
                          "AMAZON-AES",
                          "CLOUDFLARENET",
                          "Kaspersky Lab Switzerland GmbH",
                          "CMC Telecom Infrastructure Company",
                          "NETACTUATE",
                          "Viettel Group",
                          "GOOGLE-CLOUD-PLATFORM"
                        ]
                      }
                    }
                  ]
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Dòng thời gian đầy đủ các hoạt động của user nguyenvana trong 7 ngày qua?",
    "keywords": [
      "user timeline",
      "dòng thời gian người dùng",
      "dòng thời gian",
      "timeline",
      "user activity",
      "hoạt động người dùng",
      "hoạt động",
      "activity",
      "account breach",
      "xâm nhập tài khoản",
      "forensic analysis",
      "điều tra số",
      "forensics",
      "điều tra",
      "người dùng",
      "user",
      "nguyenvana",
      "tài khoản",
      "account",
      "7 ngày",
      "week",
      "phân tích",
      "analysis",
      "7d",
      "tuần",
      "7 days",
      "tuần qua",
      "last week",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.name": "nguyenvana"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            }
          ]
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "source.geo.country_name",
        "destination.ip",
        "destination.port",
        "event.action",
        "rule.name",
        "network.bytes"
      ],
      "sort": [
        {
          "@timestamp": "asc"
        }
      ],
      "size": 1000
    }
  },
  {
    "question": "User nguyenvana đăng nhập từ bao nhiêu IP khác nhau trong 7 ngày qua?",
    "keywords": [
      "multiple login locations",
      "nhiều địa điểm đăng nhập",
      "multiple logins",
      "nhiều đăng nhập",
      "geographic anomaly",
      "bất thường địa lý",
      "ip analysis",
      "phân tích ip",
      "location tracking",
      "theo dõi vị trí",
      "đăng nhập",
      "login",
      "ip khác nhau",
      "different ip",
      "địa điểm",
      "locations",
      "bao nhiêu",
      "how many",
      "nguyenvana",
      "phân tích",
      "analysis",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "7d",
      "tuần",
      "week",
      "7 days",
      "tuần qua",
      "last week",
      "authentication",
      "xác thực",
      "sign in",
      "truy cập",
      "access",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security audit - Review authentication events to ensure authorized access and maintain compliance with security policies",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.name": "nguyenvana"
              }
            },
            {
              "term": {
                "event.action": "login"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "unique_ips": {
          "terms": {
            "field": "source.ip",
            "size": 100
          },
          "aggs": {
            "countries": {
              "terms": {
                "field": "source.geo.country_name"
              }
            },
            "first_seen": {
              "min": {
                "field": "@timestamp"
              }
            },
            "last_seen": {
              "max": {
                "field": "@timestamp"
              }
            },
            "login_count": {
              "value_count": {
                "field": "@timestamp"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Có IP nào đăng nhập đồng thời từ 2 địa điểm khác nhau (di chuyển bất khả thi)?",
    "keywords": [
      "impossible travel",
      "di chuyển bất khả thi",
      "concurrent logins",
      "đăng nhập đồng thời",
      "geographic impossibility",
      "bất khả thi địa lý",
      "account compromise",
      "tài khoản bị đánh cắp",
      "đồng thời",
      "concurrent",
      "2 địa điểm",
      "two locations",
      "bất khả thi",
      "impossible",
      "đăng nhập",
      "login",
      "địa điểm khác nhau",
      "different locations",
      "nguyenvana",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "authentication",
      "xác thực",
      "sign in",
      "truy cập",
      "access",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security audit - Review authentication events to ensure authorized access and maintain compliance with security policies",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "event.action": "login"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "login_timeline": {
          "date_histogram": {
            "field": "@timestamp",
            "fixed_interval": "15m"
          },
          "aggs": {
            "unique_countries": {
              "cardinality": {
                "field": "source.geo.country_name"
              }
            },
            "countries": {
              "terms": {
                "field": "source.geo.country_name"
              }
            },
            "impossible_travel": {
              "bucket_selector": {
                "buckets_path": {
                  "countries": "unique_countries"
                },
                "script": "params.countries > 1"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "User nguyenvana truy cập những tài nguyên nào khác thường (so với mức cơ bản)?",
    "keywords": [
      "abnormal access",
      "truy cập bất thường",
      "baseline comparison",
      "so sánh mức cơ bản",
      "resource access",
      "truy cập tài nguyên",
      "behavioral analysis",
      "phân tích hành vi",
      "khác thường",
      "unusual",
      "tài nguyên",
      "resources",
      "so với",
      "compared to",
      "mức cơ bản",
      "baseline",
      "nguyenvana",
      "truy cập",
      "access",
      "phân tích",
      "analysis",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "User activity - Track user behavior for security auditing, compliance, and investigation of security incidents",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.name": "nguyenvana"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "recent_destinations": {
          "terms": {
            "field": "destination.ip",
            "size": 50
          },
          "aggs": {
            "ports": {
              "terms": {
                "field": "destination.port"
              }
            },
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "protocols": {
              "terms": {
                "field": "network.protocol"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "User nguyenvana có kết nối đến IP/domain đáng ngờ không?",
    "keywords": [
      "malicious connections",
      "kết nối độc hại",
      "c2 communication",
      "giao tiếp c2",
      "suspicious domains",
      "tên miền đáng ngờ",
      "threat intelligence",
      "thông tin mối đe dọa",
      "ip đáng ngờ",
      "suspicious ip",
      "domain đáng ngờ",
      "suspicious domain",
      "kết nối",
      "connection",
      "đáng ngờ",
      "suspicious",
      "nguyenvana",
      "độc hại",
      "malicious",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản"
    ],
    "scenario": "Security monitoring - Analyze DNS queries to detect malware communication, data exfiltration, and policy violations",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.name": "nguyenvana"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ],
          "should": [
            {
              "exists": {
                "field": "fortinet.firewall.botnetip"
              }
            },
            {
              "exists": {
                "field": "threat.feed.name"
              }
            },
            {
              "term": {
                "fortinet.firewall.crlevel": "critical"
              }
            },
            {
              "term": {
                "rule.category": "malware"
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "destination.ip",
        "destination.as.organization.name",
        "fortinet.firewall.botnetip",
        "threat.feed.name",
        "fortinet.firewall.attack"
      ],
      "size": 100
    }
  },
  {
    "question": "Có dấu hiệu di chuyển ngang không? (Kết nối nội bộ đến nhiều máy chủ)",
    "keywords": [
      "lateral movement",
      "di chuyển ngang",
      "internal reconnaissance",
      "trinh sát nội bộ",
      "network enumeration",
      "liệt kê mạng",
      "privilege escalation",
      "leo thang đặc quyền",
      "dấu hiệu",
      "signs",
      "di chuyển",
      "movement",
      "nội bộ",
      "internal",
      "nhiều máy chủ",
      "multiple servers",
      "kết nối",
      "connections",
      "nguyenvana",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network monitoring - Track session data to understand connection patterns and troubleshoot network issues",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.name": "nguyenvana"
              }
            },
            {
              "term": {
                "network.direction": "internal"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "internal_destinations": {
          "terms": {
            "field": "destination.ip",
            "size": 100
          },
          "aggs": {
            "destination_ports": {
              "terms": {
                "field": "destination.port"
              }
            },
            "first_access": {
              "min": {
                "field": "@timestamp"
              }
            },
            "protocols_used": {
              "terms": {
                "field": "network.protocol"
              }
            }
          }
        },
        "unique_dest_count": {
          "cardinality": {
            "field": "destination.ip"
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Sử dụng băng thông hiện tại so với 7 ngày trước cùng thời điểm?",
    "keywords": [
      "bandwidth comparison",
      "so sánh băng thông",
      "baseline analysis",
      "phân tích mức cơ bản",
      "network performance",
      "hiệu suất mạng",
      "traffic spike",
      "đỉnh lưu lượng",
      "băng thông",
      "bandwidth",
      "hiện tại",
      "current",
      "so với",
      "compared to",
      "7 ngày trước",
      "7 days ago",
      "cùng thời điểm",
      "same time",
      "so sánh",
      "comparison",
      "7d",
      "tuần",
      "week",
      "7 days",
      "tuần qua",
      "last week",
      "network bytes",
      "packet size",
      "kích thước gói tin"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "bool": {
          "should": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-1h",
                  "lte": "now"
                }
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-7d-1h",
                  "lte": "now-7d"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "by_time_range": {
          "filters": {
            "filters": {
              "current": {
                "range": {
                  "@timestamp": {
                    "gte": "now-1h"
                  }
                }
              },
              "last_week": {
                "range": {
                  "@timestamp": {
                    "gte": "now-7d-1h",
                    "lte": "now-7d"
                  }
                }
              }
            }
          },
          "aggs": {
            "total_bandwidth": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_sessions": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "avg_session_size": {
              "avg": {
                "field": "network.bytes"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Mẫu lưu lượng theo từng 5 phút trong 2 giờ qua?",
    "keywords": [
      "traffic pattern",
      "mẫu lưu lượng",
      "timeline analysis",
      "phân tích dòng thời gian",
      "network trending",
      "xu hướng mạng",
      "peak detection",
      "phát hiện đỉnh",
      "mẫu",
      "pattern",
      "lưu lượng",
      "traffic",
      "5 phút",
      "5 minutes",
      "2 giờ",
      "2 hours",
      "theo từng",
      "every",
      "phân tích",
      "analysis",
      "bytes",
      "băng thông",
      "bandwidth",
      "data flow",
      "dòng dữ liệu",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "now-2h"
          }
        }
      },
      "aggs": {
        "traffic_timeline": {
          "date_histogram": {
            "field": "@timestamp",
            "fixed_interval": "5m"
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "session_count": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "unique_sources": {
              "cardinality": {
                "field": "source.ip"
              }
            },
            "unique_destinations": {
              "cardinality": {
                "field": "destination.ip"
              }
            },
            "inbound": {
              "filter": {
                "term": {
                  "network.direction": "inbound"
                }
              },
              "aggs": {
                "bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "outbound": {
              "filter": {
                "term": {
                  "network.direction": "outbound"
                }
              },
              "aggs": {
                "bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Top 20 users tiêu tốn băng thông nhiều nhất trong 2h qua?",
    "keywords": [
      "bandwidth hogs",
      "người dùng tiêu thụ băng thông",
      "top consumers",
      "người tiêu thụ hàng đầu",
      "network abuse",
      "lạm dụng mạng",
      "user analysis",
      "phân tích người dùng",
      "top 20",
      "users",
      "người dùng",
      "tiêu tốn",
      "consume",
      "băng thông",
      "bandwidth",
      "nhiều nhất",
      "most",
      "2h qua",
      "2 hours",
      "top",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "hàng đầu",
      "leading",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Identify top traffic consumers to optimize bandwidth allocation and detect anomalies",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "now-2h"
          }
        }
      },
      "aggs": {
        "top_users": {
          "terms": {
            "field": "source.user.name",
            "size": 20,
            "order": {
              "total_bandwidth": "desc"
            }
          },
          "aggs": {
            "total_bandwidth": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "session_count": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "top_destinations": {
              "terms": {
                "field": "destination.ip",
                "size": 5
              },
              "aggs": {
                "bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "top_applications": {
              "terms": {
                "field": "network.application",
                "size": 5
              },
              "aggs": {
                "bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "upload_vs_download": {
              "stats": {
                "field": "source.bytes"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Top 20 applications đang chiếm bandwidth?",
    "keywords": [
      "application usage",
      "sử dụng ứng dụng",
      "bandwidth by app",
      "băng thông theo ứng dụng",
      "resource consumption",
      "tiêu thụ tài nguyên",
      "app analysis",
      "phân tích ứng dụng",
      "top 20",
      "applications",
      "ứng dụng",
      "chiếm",
      "consuming",
      "băng thông",
      "bandwidth",
      "đang",
      "currently",
      "phân tích",
      "analysis",
      "traffic",
      "lưu lượng",
      "throughput",
      "nhiều nhất",
      "hàng đầu",
      "cao nhất",
      "highest",
      "leading",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Identify top traffic consumers to optimize bandwidth allocation and detect anomalies",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "now-2h"
          }
        }
      },
      "aggs": {
        "top_apps": {
          "terms": {
            "field": "network.application",
            "size": 20,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "session_count": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "unique_users": {
              "cardinality": {
                "field": "source.user.name"
              }
            },
            "avg_session_duration": {
              "avg": {
                "field": "event.duration"
              }
            },
            "protocols": {
              "terms": {
                "field": "network.protocol"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Network Scanning: Phát hiện port scan và network reconnaissance từ source IP?",
    "keywords": [
      "port scanning",
      "quét cổng",
      "network reconnaissance",
      "trinh sát mạng",
      "scanning activity",
      "hoạt động quét",
      "port probe",
      "thăm dò cổng",
      "network mapping",
      "lập bản đồ mạng",
      "vulnerability scan",
      "quét lỗ hổng",
      "aggressive scanning",
      "quét tích cực",
      "địa chỉ IP",
      "IP address",
      "địa chỉ",
      "address",
      "cổng",
      "service port",
      "network port",
      "TCP/UDP port",
      "action",
      "hành động",
      "firewall action",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network security - Monitor and analyze firewall logs for security threats, compliance, and operational insights",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-1h"
                }
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            }
          ]
        }
      },
      "aggs": {
        "scanning_sources": {
          "terms": {
            "field": "source.ip",
            "size": 100
          },
          "aggs": {
            "unique_dest_ports": {
              "cardinality": {
                "field": "destination.port"
              }
            },
            "unique_dest_ips": {
              "cardinality": {
                "field": "destination.ip"
              }
            },
            "scan_attempts": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "scanned_ports": {
              "terms": {
                "field": "destination.port",
                "size": 50
              }
            },
            "target_hosts": {
              "terms": {
                "field": "destination.ip",
                "size": 30
              }
            },
            "scan_timeline": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "5m"
              }
            },
            "protocols_used": {
              "terms": {
                "field": "network.protocol",
                "size": 5
              }
            },
            "source_country": {
              "terms": {
                "field": "source.geo.country_name",
                "size": 10
              }
            }
          }
        },
        "scanning_patterns": {
          "filters": {
            "filters": {
              "port_sweep": {
                "range": {
                  "destination.port": {
                    "gte": 1,
                    "lte": 65535
                  }
                }
              },
              "host_sweep": {
                "bool": {
                  "must": [
                    {
                      "exists": {
                        "field": "destination.ip"
                      }
                    }
                  ]
                }
              },
              "common_ports": {
                "terms": {
                  "destination.port": [
                    22,
                    23,
                    80,
                    443,
                    3389,
                    445,
                    135
                  ]
                }
              }
            }
          }
        },
        "targeted_services": {
          "terms": {
            "field": "destination.port",
            "size": 30
          },
          "aggs": {
            "scanning_sources": {
              "terms": {
                "field": "source.ip",
                "size": 20
              }
            },
            "scan_frequency": {
              "value_count": {
                "field": "@timestamp"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "DDoS Detection: Phát hiện tấn công từ chối dịch vụ dựa trên volume và pattern?",
    "keywords": [
      "DDoS attack",
      "tấn công DDoS",
      "denial of service",
      "từ chối dịch vụ",
      "traffic flooding",
      "làm ngập lưu lượng",
      "volumetric attack",
      "tấn công khối lượng",
      "bandwidth exhaustion",
      "cạn kiệt băng thông",
      "connection flooding",
      "làm ngập kết nối",
      "amplification attack",
      "tấn công khuếch đại",
      "action",
      "hành động",
      "firewall action",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Threat detection - Monitor intrusion prevention system events to detect and respond to security threats",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-10m"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "traffic_volume_analysis": {
          "date_histogram": {
            "field": "@timestamp",
            "fixed_interval": "1m"
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_packets": {
              "sum": {
                "field": "network.packets"
              }
            },
            "connection_count": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "unique_sources": {
              "cardinality": {
                "field": "source.ip"
              }
            },
            "anomaly_detector": {
              "bucket_selector": {
                "buckets_path": {
                  "connections": "connection_count",
                  "bytes": "total_bytes",
                  "sources": "unique_sources"
                },
                "script": "params.connections > 1000 || params.bytes > 10485760 || params.sources > 100"
              }
            }
          }
        },
        "potential_attackers": {
          "terms": {
            "field": "source.ip",
            "size": 100,
            "order": {
              "request_count": "desc"
            }
          },
          "aggs": {
            "request_count": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "bytes_sent": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "target_ports": {
              "terms": {
                "field": "destination.port",
                "size": 10
              }
            },
            "protocols_used": {
              "terms": {
                "field": "network.protocol",
                "size": 5
              }
            },
            "attack_filter": {
              "bucket_selector": {
                "buckets_path": {
                  "count": "request_count"
                },
                "script": "params.count > 100"
              }
            }
          }
        },
        "targeted_services": {
          "terms": {
            "field": "destination.ip",
            "size": 20,
            "order": {
              "attack_volume": "desc"
            }
          },
          "aggs": {
            "attack_volume": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "attacking_sources": {
              "cardinality": {
                "field": "source.ip"
              }
            },
            "connection_count": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "service_ports": {
              "terms": {
                "field": "destination.port",
                "size": 10
              }
            },
            "ddos_indicator": {
              "bucket_selector": {
                "buckets_path": {
                  "sources": "attacking_sources",
                  "volume": "attack_volume"
                },
                "script": "params.sources > 50 || params.volume > 52428800"
              }
            }
          }
        },
        "attack_patterns": {
          "terms": {
            "field": "network.protocol",
            "size": 10
          },
          "aggs": {
            "traffic_volume": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "packet_count": {
              "sum": {
                "field": "network.packets"
              }
            },
            "denied_connections": {
              "filter": {
                "term": {
                  "fortinet.firewall.action": "deny"
                }
              }
            }
          }
        },
        "syn_flood_detection": {
          "filter": {
            "bool": {
              "must": [
                {
                  "term": {
                    "network.protocol": "tcp"
                  }
                },
                {
                  "term": {
                    "fortinet.firewall.action": "deny"
                  }
                }
              ]
            }
          },
          "aggs": {
            "syn_sources": {
              "cardinality": {
                "field": "source.ip"
              }
            },
            "syn_count": {
              "value_count": {
                "field": "@timestamp"
              }
            }
          }
        },
        "port_scan_detection": {
          "terms": {
            "field": "source.ip",
            "size": 50
          },
          "aggs": {
            "unique_ports": {
              "cardinality": {
                "field": "destination.port"
              }
            },
            "scanner_filter": {
              "bucket_selector": {
                "buckets_path": {
                  "ports": "unique_ports"
                },
                "script": "params.ports > 20"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Bandwidth Abuse: Phát hiện user hoặc application sử dụng băng thông quá mức?",
    "keywords": [
      "bandwidth abuse",
      "lạm dụng băng thông",
      "excessive usage",
      "sử dụng quá mức",
      "traffic shaping",
      "định hình lưu lượng",
      "QoS violation",
      "vi phạm QoS",
      "network congestion",
      "tắc nghẽn mạng",
      "heavy users",
      "người dùng nặng",
      "application abuse",
      "lạm dụng ứng dụng",
      "băng thông",
      "traffic",
      "lưu lượng",
      "throughput",
      "action",
      "hành động",
      "firewall action",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-2h"
                }
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "accept"
              }
            }
          ]
        }
      },
      "aggs": {
        "bandwidth_users": {
          "terms": {
            "field": "source.user.name",
            "size": 50
          },
          "aggs": {
            "total_bandwidth": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "session_count": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "usage_timeline": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "10m"
              },
              "aggs": {
                "period_usage": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "top_destinations": {
              "terms": {
                "field": "destination.ip",
                "size": 20
              }
            },
            "protocol_breakdown": {
              "terms": {
                "field": "network.protocol",
                "size": 10
              }
            },
            "service_ports": {
              "terms": {
                "field": "destination.port",
                "size": 15
              }
            }
          }
        },
        "heavy_applications": {
          "terms": {
            "field": "destination.port",
            "size": 30
          },
          "aggs": {
            "app_bandwidth": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "app_users": {
              "cardinality": {
                "field": "source.user.name"
              }
            },
            "avg_session_size": {
              "avg": {
                "field": "network.bytes"
              }
            }
          }
        },
        "network_segments": {
          "terms": {
            "field": "fortinet.firewall.src_int",
            "size": 20
          },
          "aggs": {
            "segment_usage": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "segment_users": {
              "cardinality": {
                "field": "source.ip"
              }
            }
          }
        },
        "usage_thresholds": {
          "filters": {
            "filters": {
              "heavy_usage": {
                "range": {
                  "network.bytes": {
                    "gte": 104857600
                  }
                }
              },
              "streaming_traffic": {
                "terms": {
                  "destination.port": [
                    1935,
                    8080,
                    554
                  ]
                }
              },
              "p2p_traffic": {
                "range": {
                  "destination.port": {
                    "gte": 6881,
                    "lte": 6999
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Mô hình lưu lượng ICMP: Có kích thước payload bất thường hoặc tần suất lạ?",
    "keywords": [
      "icmp tunneling",
      "đường hầm icmp",
      "icmp traffic",
      "lưu lượng icmp",
      "payload bất thường",
      "unusual payload",
      "đánh cắp dữ liệu",
      "data exfiltration",
      "covert channels",
      "kênh bí mật",
      "network forensics",
      "điều tra mạng",
      "kích thước",
      "payload size",
      "tần suất",
      "frequency",
      "mô hình lưu lượng",
      "traffic pattern",
      "traffic",
      "bytes",
      "băng thông",
      "bandwidth",
      "data flow",
      "dòng dữ liệu",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "term": {
                "network.protocol": "ping"
              }
            }
          ]
        }
      },
      "aggs": {
        "icmp_analysis": {
          "terms": {
            "field": "source.ip",
            "size": 50
          },
          "aggs": {
            "packet_sizes": {
              "histogram": {
                "field": "network.bytes",
                "interval": 100
              },
              "aggs": {
                "avg_bytes": {
                  "avg": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "frequency_pattern": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "1m"
              }
            },
            "avg_packet_size": {
              "avg": {
                "field": "network.bytes"
              }
            },
            "unusual_payloads": {
              "bucket_selector": {
                "buckets_path": {
                  "avg_size": "avg_packet_size"
                },
                "script": "params.avg_size > 1000"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Performance Analysis: Rule nào gây bottleneck và ảnh hưởng hiệu suất firewall?",
    "keywords": [
      "performance bottleneck",
      "bottleneck hiệu suất",
      "firewall performance",
      "hiệu suất firewall",
      "rule optimization",
      "tối ưu rule",
      "throughput analysis",
      "phân tích thông lượng",
      "resource utilization",
      "sử dụng tài nguyên",
      "connection drops",
      "mất kết nối",
      "slow response",
      "phản hồi chậm",
      "quy tắc",
      "policy",
      "chính sách",
      "luật",
      "regulation",
      "action",
      "hành động",
      "firewall action",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "outcome",
      "kết quả",
      "result",
      "status",
      "trạng thái",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Policy management - Analyze firewall policies to optimize rules, improve security, and reduce complexity",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-4h"
                }
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "range": {
                      "event.duration": {
                        "gte": 1000
                      }
                    }
                  },
                  {
                    "range": {
                      "fortinet.firewall.durationdelta": {
                        "gte": 1000
                      }
                    }
                  },
                  {
                    "term": {
                      "event.outcome": "failure"
                    }
                  },
                  {
                    "term": {
                      "fortinet.firewall.action": "deny"
                    }
                  }
                ]
              }
            }
          ]
        }
      },
      "aggs": {
        "performance_analysis": {
          "terms": {
            "field": "rule.name",
            "size": 100
          },
          "aggs": {
            "avg_processing_time": {
              "avg": {
                "field": "event.duration"
              }
            },
            "max_processing_time": {
              "max": {
                "field": "event.duration"
              }
            },
            "total_packets": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "dropped_packets": {
              "filter": {
                "term": {
                  "fortinet.firewall.action": "deny"
                }
              }
            },
            "traffic_volume": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "hourly_pattern": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "1h"
              },
              "aggs": {
                "hourly_avg_latency": {
                  "avg": {
                    "field": "event.duration"
                  }
                }
              }
            },
            "source_destinations": {
              "terms": {
                "script": {
                  "source": "doc['source.ip'].value + ' -> ' + doc['destination.ip'].value"
                },
                "size": 50
              }
            }
          }
        },
        "connection_health": {
          "filters": {
            "filters": {
              "successful_connections": {
                "term": {
                  "fortinet.firewall.action": "accept"
                }
              },
              "failed_connections": {
                "term": {
                  "fortinet.firewall.action": "deny"
                }
              },
              "timeout_connections": {
                "term": {
                  "event.outcome": "timeout"
                }
              },
              "high_latency": {
                "range": {
                  "event.duration": {
                    "gte": 5000
                  }
                }
              }
            }
          }
        },
        "protocol_performance": {
          "terms": {
            "field": "network.protocol",
            "size": 20
          },
          "aggs": {
            "avg_throughput": {
              "avg": {
                "field": "network.bytes"
              }
            },
            "connection_success_rate": {
              "filters": {
                "filters": {
                  "successful": {
                    "term": {
                      "fortinet.firewall.action": "accept"
                    }
                  },
                  "failed": {
                    "term": {
                      "fortinet.firewall.action": "deny"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Capacity Planning: Dự báo nhu cầu băng thông và tài nguyên hệ thống trong 30 ngày tới?",
    "keywords": [
      "capacity planning",
      "lập kế hoạch dung lượng",
      "bandwidth forecasting",
      "dự báo băng thông",
      "resource planning",
      "lập kế hoạch tài nguyên",
      "growth prediction",
      "dự đoán tăng trưởng",
      "utilization trends",
      "xu hướng sử dụng",
      "peak usage analysis",
      "phân tích sử dụng đỉnh",
      "infrastructure scaling",
      "mở rộng hạ tầng",
      "future requirements",
      "yêu cầu tương lai",
      "local area network",
      "mạng cục bộ",
      "internal",
      "nội bộ",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "range": {
          "@timestamp": {
            "gte": "now-30d"
          }
        }
      },
      "aggs": {
        "bandwidth_trends": {
          "date_histogram": {
            "field": "@timestamp",
            "calendar_interval": "1d"
          },
          "aggs": {
            "daily_total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "daily_packet_count": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "daily_unique_sources": {
              "cardinality": {
                "field": "source.ip"
              }
            },
            "daily_unique_destinations": {
              "cardinality": {
                "field": "destination.ip"
              }
            },
            "peak_hour_usage": {
              "max_bucket": {
                "buckets_path": "hourly_breakdown>total_bytes"
              }
            },
            "hourly_breakdown": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "1h"
              },
              "aggs": {
                "total_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        },
        "growth_analysis": {
          "date_histogram": {
            "field": "@timestamp",
            "calendar_interval": "1w"
          },
          "aggs": {
            "weekly_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "weekly_connections": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "growth_rate": {
              "derivative": {
                "buckets_path": "weekly_bytes"
              }
            }
          }
        },
        "resource_utilization": {
          "terms": {
            "field": "destination.port",
            "size": 50
          },
          "aggs": {
            "port_usage_trend": {
              "date_histogram": {
                "field": "@timestamp",
                "calendar_interval": "1d"
              },
              "aggs": {
                "daily_connections": {
                  "value_count": {
                    "field": "@timestamp"
                  }
                }
              }
            },
            "total_traffic": {
              "sum": {
                "field": "network.bytes"
              }
            }
          }
        },
        "predictive_metrics": {
          "avg_bucket": {
            "buckets_path": "bandwidth_trends>daily_total_bytes"
          }
        }
      }
    }
  },
  {
    "question": "Threat Hunting: Phát hiện kết nối đến botnet trong 48h qua?",
    "keywords": [
      "botnet detection",
      "phát hiện botnet",
      "command control",
      "điều khiển từ xa",
      "malicious IP",
      "IP độc hại",
      "threat hunting",
      "săn lùng mối đe dọa",
      "IOC detection",
      "phát hiện IOC",
      "C2 communication",
      "giao tiếp C2",
      "malware communication",
      "giao tiếp malware",
      "botnet IP",
      "IP botnet",
      "mối đe dọa",
      "위협",
      "nguy cơ",
      "위험",
      "attack",
      "tấn công",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Threat detection - Monitor intrusion prevention system events to detect and respond to security threats",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-48h"
                }
              }
            },
            {
              "exists": {
                "field": "fortinet.firewall.botnetip"
              }
            }
          ]
        }
      },
      "aggs": {
        "botnet_analysis": {
          "terms": {
            "field": "fortinet.firewall.botnetip",
            "size": 50
          },
          "aggs": {
            "affected_sources": {
              "terms": {
                "field": "source.ip",
                "size": 100
              }
            },
            "botnet_domains": {
              "terms": {
                "field": "fortinet.firewall.botnetdomain",
                "size": 30
              }
            },
            "communication_timeline": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "1h"
              }
            },
            "total_connections": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "data_transferred": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "protocols_used": {
              "terms": {
                "field": "network.protocol",
                "size": 10
              }
            },
            "destination_ports": {
              "terms": {
                "field": "destination.port",
                "size": 20
              }
            }
          }
        },
        "infected_hosts": {
          "terms": {
            "field": "source.ip",
            "size": 100
          },
          "aggs": {
            "botnet_contacts": {
              "terms": {
                "field": "fortinet.firewall.botnetip",
                "size": 20
              }
            },
            "infection_timeline": {
              "date_histogram": {
                "field": "@timestamp",
                "calendar_interval": "1h"
              }
            },
            "host_details": {
              "terms": {
                "field": "host.name",
                "size": 50
              }
            },
            "user_context": {
              "terms": {
                "field": "source.user.name",
                "size": 30
              }
            }
          }
        }
      },
      "_source": [
        "@timestamp",
        "source.ip",
        "fortinet.firewall.botnetip",
        "fortinet.firewall.botnetdomain",
        "network.bytes",
        "destination.port",
        "host.name",
        "source.user.name"
      ],
      "size": 100
    }
  },
  {
    "question": "Phát hiện lưu lượng DNS bất thường (nghi ngờ tunneling) qua hành vi: top client theo số lượng truy vấn và dung lượng traffic?",
    "keywords": [
      "DNS tunneling",
      "đường hầm DNS",
      "data exfiltration",
      "đánh cắp dữ liệu",
      "abnormal DNS",
      "DNS bất thường",
      "living off the land",
      "high query count",
      "số lượng truy vấn cao",
      "high byte count",
      "dung lượng byte cao",
      "behavioral detection",
      "phát hiện hành vi",
      "network.bytes",
      "source.ip",
      "destination.ip",
      "traffic",
      "bytes",
      "băng thông",
      "bandwidth",
      "data flow",
      "dòng dữ liệu",
      "nhiều nhất",
      "hàng đầu",
      "cao nhất",
      "highest",
      "leading",
      "domain name system",
      "tên miền",
      "name resolution",
      "phân giải tên",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Identify top traffic consumers to optimize bandwidth allocation and detect anomalies",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-2h"
                }
              }
            },
            {
              "term": {
                "destination.port": 53
              }
            },
            {
              "term": {
                "network.protocol": "dns"
              }
            }
          ]
        }
      },
      "aggs": {
        "suspicious_clients": {
          "terms": {
            "field": "source.ip",
            "size": 50,
            "order": {
              "query_count": "desc"
            }
          },
          "aggs": {
            "query_count": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "contacted_dns_servers": {
              "terms": {
                "field": "destination.ip",
                "size": 10
              },
              "aggs": {
                "total_traffic_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                },
                "avg_traffic_per_query": {
                  "avg": {
                    "field": "network.bytes"
                  }
                }
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "Lateral Movement: Phát hiện kết nối SMB/RDP bất thường giữa các host?",
    "keywords": [
      "lateral movement",
      "di chuyển ngang",
      "SMB traffic",
      "lưu lượng SMB",
      "RDP connections",
      "kết nối RDP",
      "internal spreading",
      "lan truyền nội bộ",
      "administrative access",
      "truy cập quản trị",
      "credential abuse",
      "lạm dụng credential",
      "network reconnaissance",
      "trinh sát mạng",
      "remote desktop",
      "3389",
      "truy cập từ xa",
      "desktop remoto",
      "action",
      "hành động",
      "firewall action",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security monitoring - Monitor RDP access attempts to detect unauthorized remote desktop connections and potential breaches",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-4h"
                }
              }
            },
            {
              "term": {
                "network.direction": "internal"
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "accept"
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "term": {
                      "destination.port": 445
                    }
                  },
                  {
                    "term": {
                      "destination.port": 3389
                    }
                  },
                  {
                    "term": {
                      "destination.port": 139
                    }
                  },
                  {
                    "term": {
                      "destination.port": 135
                    }
                  }
                ]
              }
            }
          ]
        }
      },
      "aggs": {
        "lateral_movement_analysis": {
          "terms": {
            "field": "source.ip",
            "size": 100
          },
          "aggs": {
            "target_hosts": {
              "terms": {
                "field": "destination.ip",
                "size": 50
              },
              "aggs": {
                "connection_ports": {
                  "terms": {
                    "field": "destination.port",
                    "size": 10
                  }
                },
                "connection_timeline": {
                  "date_histogram": {
                    "field": "@timestamp",
                    "fixed_interval": "10m"
                  }
                }
              }
            },
            "protocols_used": {
              "terms": {
                "field": "network.protocol",
                "size": 5
              }
            },
            "user_context": {
              "terms": {
                "field": "source.user.name",
                "size": 20
              }
            },
            "total_connections": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "data_volume": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_targets": {
              "cardinality": {
                "field": "destination.ip"
              }
            }
          }
        },
        "service_analysis": {
          "terms": {
            "field": "destination.port",
            "size": 10
          },
          "aggs": {
            "service_usage": {
              "terms": {
                "script": {
                  "source": "doc['source.ip'].value + ' -> ' + doc['destination.ip'].value"
                },
                "size": 100
              }
            },
            "hourly_pattern": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "1h"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Phân tích vi phạm Zero Trust: Kết nối nào không thông qua xác thực trong 24h qua?",
    "keywords": [
      "zero trust violation",
      "vi phạm zero trust",
      "authentication bypass",
      "bỏ qua xác thực",
      "unauthenticated access",
      "truy cập không xác thực",
      "lateral movement",
      "di chuyển ngang",
      "trust boundary",
      "ranh giới tin cậy",
      "verify explicitly",
      "xác minh rõ ràng",
      "least privilege",
      "quyền tối thiểu",
      "action",
      "hành động",
      "firewall action",
      "địa lý",
      "geography",
      "location",
      "vị trí",
      "country",
      "quốc gia",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "user activity",
      "hoạt động người dùng",
      "account",
      "tài khoản",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Security audit - Review authentication events to ensure authorized access and maintain compliance with security policies",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "accept"
              }
            },
            {
              "bool": {
                "must_not": [
                  {
                    "exists": {
                      "field": "source.user.name"
                    }
                  }
                ]
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "term": {
                      "network.direction": "inbound"
                    }
                  },
                  {
                    "term": {
                      "network.direction": "internal"
                    }
                  }
                ]
              }
            }
          ]
        }
      },
      "aggs": {
        "unauthenticated_connections": {
          "terms": {
            "field": "source.ip",
            "size": 100
          },
          "aggs": {
            "connection_types": {
              "terms": {
                "field": "event.action",
                "size": 20
              }
            },
            "accessed_resources": {
              "terms": {
                "field": "destination.ip",
                "size": 50
              }
            },
            "protocols_used": {
              "terms": {
                "field": "network.protocol",
                "size": 10
              }
            },
            "ports_accessed": {
              "terms": {
                "field": "destination.port",
                "size": 30
              }
            },
            "data_transferred": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "connection_timeline": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "1h"
              }
            },
            "source_countries": {
              "terms": {
                "field": "source.geo.country_name",
                "size": 20
              }
            }
          }
        },
        "network_segments": {
          "terms": {
            "field": "fortinet.firewall.dintf",
            "size": 20
          },
          "aggs": {
            "segment_traffic": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_sources": {
              "cardinality": {
                "field": "source.ip"
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Micro-segmentation: Lưu lượng East-West không được phép giữa các vùng mạng?",
    "keywords": [
      "micro-segmentation",
      "phân đoạn vi mô",
      "east-west traffic",
      "lưu lượng east-west",
      "lateral movement",
      "di chuyển ngang",
      "network zones",
      "vùng mạng",
      "segment violation",
      "vi phạm phân đoạn",
      "network isolation",
      "cô lập mạng",
      "inter-zone communication",
      "giao tiếp liên vùng",
      "traffic",
      "bytes",
      "băng thông",
      "bandwidth",
      "data flow",
      "dòng dữ liệu",
      "action",
      "hành động",
      "firewall action",
      "network bytes",
      "packet size",
      "kích thước gói tin",
      "timeline",
      "theo thời gian",
      "time series",
      "xu hướng",
      "trend",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Monitor network traffic patterns to ensure optimal performance and detect unusual activity",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-1h"
                }
              }
            },
            {
              "term": {
                "network.direction": "internal"
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "accept"
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "bool": {
                      "must": [
                        {
                          "term": {
                            "fortinet.firewall.srcintfrole": "lan"
                          }
                        },
                        {
                          "term": {
                            "fortinet.firewall.dstintfrole": "dmz"
                          }
                        }
                      ]
                    }
                  },
                  {
                    "bool": {
                      "must": [
                        {
                          "term": {
                            "fortinet.firewall.srcintfrole": "dmz"
                          }
                        },
                        {
                          "term": {
                            "fortinet.firewall.dstintfrole": "lan"
                          }
                        }
                      ]
                    }
                  },
                  {
                    "bool": {
                      "must": [
                        {
                          "term": {
                            "fortinet.firewall.src_int": "internal"
                          }
                        },
                        {
                          "term": {
                            "fortinet.firewall.dst_int": "dmz"
                          }
                        }
                      ]
                    }
                  }
                ]
              }
            }
          ]
        }
      },
      "aggs": {
        "unauthorized_flows": {
          "terms": {
            "script": {
              "source": "doc['source.ip'].value + ' -> ' + doc['destination.ip'].value"
            },
            "size": 100
          },
          "aggs": {
            "flow_volume": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "protocol_breakdown": {
              "terms": {
                "field": "network.protocol",
                "size": 10
              }
            },
            "port_analysis": {
              "terms": {
                "field": "destination.port",
                "size": 20
              }
            },
            "timeline": {
              "date_histogram": {
                "field": "@timestamp",
                "fixed_interval": "5m"
              }
            },
            "source_interface": {
              "terms": {
                "field": "fortinet.firewall.src_int",
                "size": 10
              }
            },
            "dest_interface": {
              "terms": {
                "field": "fortinet.firewall.dst_int",
                "size": 10
              }
            }
          }
        },
        "interface_roles": {
          "terms": {
            "field": "fortinet.firewall.srcintfrole",
            "size": 10
          },
          "aggs": {
            "dest_roles": {
              "terms": {
                "field": "fortinet.firewall.dstintfrole",
                "size": 10
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "User 'QuynhTX' có tỷ lệ upload/download như thế nào trong 24h qua?",
    "keywords": [
      "user", "người dùng", 
      "upload", "download", "tải lên", "tải xuống",
      "network.bytes", "source.bytes", "destination.bytes",
      "tỷ lệ", "ratio", "so sánh", "comparison",
      "aggregation", "tổng hợp", "statistics", "thống kê"
    ],
    "scenario": "Network analysis - Analyze user's upload vs download traffic patterns",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": {
                "source.user.name": "QuynhTX"
              }
            },
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "traffic_analysis": {
          "stats": {
            "field": "network.bytes"
          }
        },
        "upload_stats": {
          "stats": {
            "field": "source.bytes"
          }
        },
        "download_stats": {
          "stats": {
            "field": "destination.bytes"
          }
        },
        "traffic_breakdown": {
          "filters": {
            "filters": {
              "total_network_bytes": {
                "match_all": {}
              },
              "total_upload_bytes": {
                "match_all": {}
              },
              "total_download_bytes": {
                "match_all": {}
              }
            }
          },
          "aggs": {
            "network_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "upload_bytes": {
              "sum": {
                "field": "source.bytes"
              }
            },
            "download_bytes": {
              "sum": {
                "field": "destination.bytes"
              }
            }
          }
        },
        "by_organization": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 10,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "uploaded": {
              "sum": {
                "field": "source.bytes"
              }
            },
            "downloaded": {
              "sum": {
                "field": "destination.bytes"
              }
            },
            "upload_download_ratio": {
              "bucket_script": {
                "buckets_path": {
                  "up": "uploaded",
                  "down": "downloaded"
                },
                "script": "params.down > 0 ? params.up / params.down : 0"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "User nào upload dữ liệu nhiều nhất (nghi ngờ data exfiltration)?",
    "keywords": [
      "user", "người dùng", "upload", "tải lên",
      "data exfiltration", "đánh cắp dữ liệu", "nhiều nhất", "top",
      "source.bytes", "outbound", "network.direction",
      "aggregation", "tổng hợp", "statistics", "thống kê"
    ],
    "scenario": "Security monitoring - Detect potential data exfiltration by identifying users with unusually high upload traffic",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "term": {
                "network.direction": "outbound"
              }
            },
            {
              "range": {
                "source.bytes": {
                  "gte": 10485760
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "top_uploaders": {
          "terms": {
            "field": "source.user.name",
            "size": 20,
            "order": {
              "total_upload": "desc"
            }
          },
          "aggs": {
            "total_upload": {
              "sum": {
                "field": "source.bytes"
              }
            },
            "total_download": {
              "sum": {
                "field": "destination.bytes"
              }
            },
            "upload_sessions": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "avg_upload_per_session": {
              "avg": {
                "field": "source.bytes"
              }
            },
            "top_destinations": {
              "terms": {
                "field": "destination.as.organization.name",
                "size": 5
              },
              "aggs": {
                "uploaded_to_dest": {
                  "sum": {
                    "field": "source.bytes"
                  }
                }
              }
            },
            "suspicious_upload_flag": {
              "bucket_selector": {
                "buckets_path": {
                  "upload": "total_upload"
                },
                "script": "params.upload > 1073741824"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "User nào download nhiều dữ liệu nhất (video streaming, file downloads)?",
    "keywords": [
      "user", "người dùng", "download", "tải xuống",
      "streaming", "video", "file downloads", "nhiều nhất", "top",
      "destination.bytes", "inbound", "bandwidth",
      "aggregation", "tổng hợp", "statistics", "thống kê"
    ],
    "scenario": "Network performance - Identify users consuming most download bandwidth",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "range": {
                "destination.bytes": {
                  "gte": 52428800
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "top_downloaders": {
          "terms": {
            "field": "source.user.name",
            "size": 20,
            "order": {
              "total_download": "desc"
            }
          },
          "aggs": {
            "total_download": {
              "sum": {
                "field": "destination.bytes"
              }
            },
            "total_upload": {
              "sum": {
                "field": "source.bytes"
              }
            },
            "download_sessions": {
              "value_count": {
                "field": "@timestamp"
              }
            },
            "avg_download_per_session": {
              "avg": {
                "field": "destination.bytes"
              }
            },
            "max_single_download": {
              "max": {
                "field": "destination.bytes"
              }
            },
            "download_sources": {
              "terms": {
                "field": "destination.as.organization.name",
                "size": 10
              },
              "aggs": {
                "downloaded_from_source": {
                  "sum": {
                    "field": "destination.bytes"
                  }
                }
              }
            },
            "protocols": {
              "terms": {
                "field": "network.protocol",
                "size": 5
              }
            }
          }
        }
      },
      "size": 0
    }
  },
  {
    "question": "User nào có tỷ lệ upload/download bất thường?",
    "keywords": [
      "user", "người dùng", "upload download ratio", "tỷ lệ",
      "anomaly", "bất thường", "unusual", "suspicious",
      "source.bytes", "destination.bytes", "comparison",
      "aggregation", "tổng hợp", "statistics", "thống kê"
    ],
    "scenario": "Security analysis - Detect users with unusual upload/download ratios that may indicate data exfiltration or botnet activity",
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            }
          ]
        }
      },
      "aggs": {
        "users": {
          "terms": {
            "field": "source.user.name",
            "size": 50
          },
          "aggs": {
            "total_upload": {
              "sum": {
                "field": "source.bytes"
              }
            },
            "total_download": {
              "sum": {
                "field": "destination.bytes"
              }
            },
            "upload_download_ratio": {
              "bucket_script": {
                "buckets_path": {
                  "upload": "total_upload",
                  "download": "total_download"
                },
                "script": "params.download > 0 ? params.upload / params.download : 0"
              }
            },
            "anomaly_filter": {
              "bucket_selector": {
                "buckets_path": {
                  "ratio": "upload_download_ratio",
                  "upload": "total_upload"
                },
                "script": "params.ratio > 0.5 && params.upload > 104857600"
              }
            }
          }
        }
      },
      "size": 0
    }
  },
    {
      "question": "Các tổ chức đích (organizations) nào nhận nhiều traffic nhất từ các địa chỉ nguồn không phải địa chỉ IP nội bộ 198.162.10.1/24, và tỷ lệ blocked traffic (deny) từ những IP này ra sao? Query cần hiển thị chi tiết về tổ chức, quốc gia, port đích, và tỷ lệ blocked connections vs. allowed connections để đánh giá mối đe dọa.",
      "keywords": [
          "IP nguồn",
          "source ip",
          "đa tổ chức",
          "multiple organizations",
          "nhiều tổ chức",
          "tổ chức đích",
          "destination organization",
          "không chính thống",
          "rogue IPs",
          "destinations",
          "địa chỉ đích",
          "action",
          "hành động",
          "firewall action",
          "block",
          "chặn",
          "deny",
          "lưu lượng",
          "bytes",
          "denied",
          "bị từ chối",
          "cấm",
          "từ chối",
          "reject",
          "ngăn chặn",
          "prevent",
          "traffic",
          "connections",
          "not",
          "không",
          "block",
          "chặn",
          "deny",
          "outlier",
          "trend",
          "xu hướng",
          "analysis",
          "phân tích",
          "geographical",
          "địa lý",
          "aggregation",
          "tổng hợp",
          "destination.ip",
          "destination.port",
          "destination.domain",
          "destination.as.organization.name",
          "destination.geo.country_name",
          "fortinet.firewall.action",
          "query"
      ],
      "scenario": "Network security",
      "query": {
          "size": 0,
          "query": {
              "bool": {
                  "filter": [
                      {
                          "range": {
                              "@timestamp": {
                                  "gte": "now-24h"
                              }
                          }
                      },
                      {
                          "terms": {
                              "fortinet.firewall.action": [
                                  "accept",
                                  "deny"
                              ]
                          }
                      }
                  ],
                  "must_not": [
                      {
                          "term": {
                              "source.ip.keyword": "198.162.10.1"
                          }
                      }
                  ]
              }
          },
          "aggs": {
              "rogue_ips": {
                  "terms": {
                      "field": "source.ip",
                      "size": 20
                  },
                  "aggs": {
                      "destinations": {
                          "terms": {
                              "field": "destination.ip",
                              "size": 10
                          },
                          "aggs": {
                              "organizations": {
                                  "terms": {
                                      "field": "destination.as.organization.name",
                                      "size": 15,
                                      "order": {
                                          "total_bytes": "desc"
                                      }
                                  },
                                  "aggs": {
                                      "total_bytes": {
                                          "sum": {
                                              "field": "network.bytes"
                                          }
                                      },
                                      "destination_ports": {
                                          "terms": {
                                              "field": "destination.port",
                                              "size": 10
                                          }
                                      },
                                      "destination_domains": {
                                          "terms": {
                                              "field": "destination.domain",
                                              "size": 10
                                          }
                                      },
                                      "connection_stats": {
                                          "filters": {
                                              "filters": {
                                                  "allow": {
                                                      "bool": {
                                                          "filter": [
                                                              {
                                                                  "term": {
                                                                      "fortinet.firewall.action": "accept"
                                                                  }
                                                              }
                                                          ]
                                                      }
                                                  },
                                                  "deny": {
                                                      "bool": {
                                                          "filter": [
                                                              {
                                                                  "term": {
                                                                      "fortinet.firewall.action": "deny"
                                                                  }
                                                              }
                                                          ]
                                                      }
                                                  }
                                              }
                                          },
                                          "aggs": {
                                              "bytes_allow": {
                                                  "sum": {
                                                      "field": "network.bytes"
                                                  }
                                              },
                                              "bytes_deny": {
                                                  "sum": {
                                                      "field": "network.bytes"
                                                  }
                                              }
                                          }
                                      },
                                      "country_distribution": {
                                          "terms": {
                                              "field": "destination.geo.country_name",
                                              "size": 10
                                          },
                                          "aggs": {
                                              "country_bytes": {
                                                  "sum": {
                                                      "field": "network.bytes"
                                                  }
                                              },
                                              "countries": {
                                                  "terms": {
                                                      "field": "destination.geo.country_name",
                                                      "size": 5
                                                  },
                                                  "aggs": {
                                                      "ports": {
                                                          "terms": {
                                                              "field": "destination.port"
                                                          }
                                                      },
                                                      "destinations": {
                                                          "terms": {
                                                              "field": "destination.ip"
                                                          }
                                                      }
                                                  }
                                              }
                                          }
                                      },
                                      "allowed_blocked_ratio": {
                                          "bucket_script": {
                                              "buckets_path": {
                                                  "allow_bytes": "connection_stats['allow']>bytes_allow",
                                                  "deny_bytes": "connection_stats['deny']>bytes_deny"
                                              },
                                              "script": "params.deny_bytes > 0 ? params.allow_bytes / params.deny_bytes : 0"
                                          }
                                      }
                                  }
                              }
                          }
                      }
                  }
              }
          }
      }
  },
  {
    "question": "Top 20 domains nào có lưu lượng outbound cao nhất và nghi ngờ rủi ro cao nhất (based on blocked/denied traffic) cùng với thông tin về risk score và geo-location?",
    "keywords": [
      "domain risk analysis",
      "outbound traffic",
      "traffic blocking",
      "geo-location",
      "url.domain",
      "destination.domain",
      "destination.geo.country_name",
      "destination.ip",
      "destination.as.organization.name",
      "fortinet.firewall.action",
      "network.bytes",
      "network.transport",
      "network.protocol",
      "high risk traffic",
      "outbound traffic pattern",
      "regional traffic analysis",
      "threat intelligence"
    ],
    "scenario": "Security monitoring",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-24h"
                }
              }
            },
            {
              "exists": {
                "field": "destination.domain"
              }
            }
          ],
          "should": [
            {
              "term": {
                "network.direction": "outbound"
              }
            },
            {
              "term": {
                "fortinet.firewall.action": "deny"
              }
            }
          ],
          "minimum_should_match": 1
        }
      },
      "aggs": {
        "top_domains": {
          "terms": {
            "field": "destination.domain",
            "size": 20,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "action_breakdown": {
              "terms": {
                "field": "fortinet.firewall.action",
                "size": 2
              },
              "aggs": {
                "byte_count": {
                  "sum": {
                    "field": "network.bytes"
                  }
                },
                "connection_count": {
                  "value_count": {
                    "field": "@timestamp"
                  }
                }
              }
            },
            "geo_distribution": {
              "terms": {
                "field": "destination.geo.country_name",
                "size": 5
              },
              "aggs": {
                "country_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "ip_distribution": {
              "terms": {
                "field": "destination.ip",
                "size": 5
              },
              "aggs": {
                "ip_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "protocol_analysis": {
              "terms": {
                "field": "network.protocol",
                "size": 5
              },
              "aggs": {
                "protocol_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "transport_analysis": {
              "terms": {
                "field": "network.transport",
                "size": 2
              },
              "aggs": {
                "transport_bytes": {
                  "sum": {
                    "field": "network.bytes"
                  }
                }
              }
            },
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "unique_ips": {
              "cardinality": {
                "field": "destination.ip"
              }
            },
            "port_distribution": {
              "terms": {
                "field": "destination.port",
                "size": 10
              },
              "aggs": {
                "protocol": {
                  "terms": {
                    "field": "network.protocol",
                    "size": 2
                  }
                }
              }
            }
          }
        },
        "organization_stats": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 10
          },
          "aggs": {
            "org_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "org_domains": {
              "terms": {
                "field": "destination.domain",
                "size": 10
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "User nào truy cập nhiều websites khác nhau nhất?",
    "keywords": ["user", "website access", "unique websites", "web traffic", "user behavior", "url.domain", "cardinality"],
    "scenario": "Phân tích số lượng tên miền được truy cập nhiều nhất bởi mỗi user để hiểu rõ hành vi web của họ.",
    "query": {
      "query": {
        "bool": {
          "filter": [
            { "range": { "@timestamp": { "gte": "now-24h" } } },
            { "terms": { "network.protocol": ["http", "https"] } },
            { "exists": { "field": "url.domain" } }
          ]
        }
      },
      "aggs": {
        "by_user": {
          "terms": { "field": "source.user.name", "size": 10 },
          "aggs": {
            "unique_websites": {
              "cardinality": { "field": "url.domain" }
            }
          }
        }
      }
    }
  },
  {
    "question": "User truy cập domain/tổ chức nào nhiều nhất (all traffic)?",
    "keywords": ["user", "domain access", "website traffic", "most accessed websites", "web behavior", "url.domain", "terms"],
    "scenario": "Quan tâm đến việc xác định domain, tổ chức được truy cập nhiều nhất và user sử dụng nhiều nhất mỗi tên miền đó bao nhiêu lần.",
    "query": {
      "query": {
        "bool": {
          "filter": [
            { "range": { "@timestamp": { "gte": "now-24h" } } }
          ]
        }
      },
      "aggs": {
        "by_user": {
          "terms": { "field": "source.user.name", "size": 10 },
          "aggs": {
            "by_url_domain": {
              "terms": { "field": "url.domain", "size": 50 },
              "aggs": {
                "traffic": { "sum": { "field": "network.bytes" } }
              }
            },
            "by_dest_domain": {
              "terms": { "field": "destination.domain", "size": 50 }
            },
            "by_organization": {
              "terms": { "field": "destination.as.organization.name", "size": 30 }
            }
          }
        }
      }
    }
  },
  {
    "question": "Phân tích đầy đủ domains được truy cập từ các source IP",
    "keywords": [
      "phân tích IP",
      "truy cập websites",
      "phân tích theo IP",
      "theo dõi truy cập IP",
      "phân tích hành vi IP",
      "danh sách websites",
      "kiểm soát truy cập",
      "phân tích lưu lượng theo IP",
      "hành vi truy cập",
      "phân tích lịch sử truy cập"
    ],
    "query": {
      "query": {
        "bool": {
          "filter": [
            {
              "term": { "source.ip": "192.168.1.100" }
            },
            {
              "range": { "@timestamp": { "gte": "now-24h" } }
            }
          ]
        }
      },
      "aggs": {
        "http_traffic": {
          "filter": { "exists": { "field": "url.domain" } },
          "aggs": {
            "unique_urls": {
              "cardinality": { "field": "url.domain" }
            },
            "top_websites": {
              "terms": { "field": "url.domain", "size": 50 },
              "aggs": {
                "total_bytes": { "sum": { "field": "network.bytes" } },
                "protocols": { "terms": { "field": "network.protocol" } }
              }
            }
          }
        },
        "non_http_traffic": {
          "filter": {
            "bool": {
              "must_not": { "exists": { "field": "url.domain" } },
              "must": { "exists": { "field": "destination.domain" } }
            }
          },
          "aggs": {
            "unique_dest_domains": {
              "cardinality": { "field": "destination.domain" }
            },
            "top_dest_domains": {
              "terms": { "field": "destination.domain", "size": 30 }
            }
          }
        },
        "by_organization": {
          "terms": {
            "field": "destination.as.organization.name",
            "size": 20
          },
          "aggs": {
            "total_bytes": { "sum": { "field": "network.bytes" } }
          }
        }
      }
    }
  },
  {
    "question": "IP nào truy cập đến các website như thế nào?",
    "keywords": ["ip website", "source.ip truy cập url", "theo dõi IP"],
    "scenario": "Theo dõi các địa chỉ IP truy cập vào các websites để biết ai đang vào web nào",
    "query": {
      "query": {
        "exists": {
          "field": "url.domain"
        }
      },
      "sort": [
        {
          "@timestamp": "desc"
        }
      ],
      "size": 10,
      "_source": ["@timestamp", "source.ip", "url.domain"]
    }
  },
  {
    "question": "IP 10.4.110.107 truy cập những website nào?",
    "keywords": ["theo dõi IP", "IP truy cập web", "website access"],
    "scenario": "Phân tích danh sách các website mà IP 10.4.110.107 đã truy cập",
    "query": {
      "query": {
        "bool": {
          "must": [
            { "match": { "source.ip": "10.4.110.107" } }
          ],
          "filter": [
            { "exists": { "field": "url.domain" } }
          ]
        }
      },
      "sort": [{ "@timestamp": "desc" }],
      "size": 10,
      "_source": ["@timestamp", "url.domain", "source.ip"]
    }

  },
  {
    "question": "Hiển thị các kết nối được chấp nhận trong 24 giờ qua",
    "keywords": ["accept", "cho phép", "allowed", "permitted", "kết nối thành công", "traffic allowed", "24h", "ngày qua"],
    "scenario": "Network security - Monitor allowed traffic and connections",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "accept" }},
            { "range": { "@timestamp": { "gte": "now-24h" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các kết nối bị chặn trong 1 giờ qua",
    "keywords": ["deny", "block", "chặn", "từ chối", "bị chặn", "blocked traffic", "rejected", "1h", "giờ qua"],
    "scenario": "Network security - Monitor blocked connections and potential threats",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "deny" }},
            { "range": { "@timestamp": { "gte": "now-1h" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Danh sách các truy cập bị chặn hôm nay",
    "keywords": ["blocked", "bị chặn", "bị ngăn chặn", "security block", "threat blocked", "hôm nay", "today"],
    "scenario": "Network security - Monitor security blocks",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "blocked" }},
            { "range": { "@timestamp": { "gte": "now/d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các gói tin bị drop trong 6 giờ qua",
    "keywords": ["dropped", "drop", "bỏ qua", "loại bỏ", "packet drop", "6h", "6 giờ"],
    "scenario": "Network security - Monitor dropped packets",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "dropped" }},
            { "range": { "@timestamp": { "gte": "now-6h" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các kết nối đã đóng trong 2 giờ qua",
    "keywords": ["close", "closed", "đóng", "kết thúc", "connection closed", "session ended", "2h"],
    "scenario": "Network monitoring - Track closed connections",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "close" }},
            { "range": { "@timestamp": { "gte": "now-2h" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Kết nối bị reset từ phía client trong ngày",
    "keywords": ["client-rst", "client reset", "reset từ client", "connection reset", "TCP reset", "ngày hôm nay"],
    "scenario": "Network troubleshooting - Monitor client-side connection resets",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "client-rst" }},
            { "range": { "@timestamp": { "gte": "now/d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Kết nối bị reset từ phía server trong 12 giờ qua",
    "keywords": ["server-rst", "server reset", "reset từ server", "backend reset", "12h", "12 giờ"],
    "scenario": "Network troubleshooting - Monitor server-side connection resets",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "server-rst" }},
            { "range": { "@timestamp": { "gte": "now-12h" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các kết nối bị timeout trong 24 giờ qua",
    "keywords": ["timeout", "hết thời gian", "time out", "session timeout", "connection timeout", "24h"],
    "scenario": "Network troubleshooting - Monitor connection timeouts",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "timeout" }},
            { "range": { "@timestamp": { "gte": "now-24h" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các kết nối mới được thiết lập hôm nay",
    "keywords": ["connect", "connection", "kết nối", "new connection", "established", "hôm nay"],
    "scenario": "Network monitoring - Track new connections",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "connect" }},
            { "range": { "@timestamp": { "gte": "now/d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các phiên bị ngắt kết nối trong 4 giờ qua",
    "keywords": ["disconnect", "disconnected", "ngắt kết nối", "session disconnect", "4h", "4 giờ"],
    "scenario": "Network monitoring - Track disconnections",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "disconnect" }},
            { "range": { "@timestamp": { "gte": "now-4h" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Ai đã chỉnh sửa cấu hình firewall trong 7 ngày qua?",
    "keywords": ["Edit", "chỉnh sửa", "modify", "sửa đổi", "configuration change", "7 ngày", "tuần qua"],
    "scenario": "Audit - Track configuration edits",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "_source": [
        "@timestamp",
        "source.user.name",
        "message",
        "observer.name",
        "observer.serial_number",
        "fortinet.firewall.action",
        "fortinet.firewall.cfgattr",
        "fortinet.firewall.cfgobj",
        "fortinet.firewall.cfgpath",
        "fortinet.firewall.ui"
      ],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "Edit" }},
            { "range": { "@timestamp": { "gte": "now-7d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Danh sách cấu hình mới được thêm vào trong tháng này",
    "keywords": ["add", "thêm", "thêm mới", "new", "create", "tạo mới", "tháng này", "this month"],
    "scenario": "Audit - Track new configurations",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "_source": [
        "@timestamp",
        "source.user.name",
        "message",
        "observer.name",
        "observer.serial_number",
        "fortinet.firewall.action",
        "fortinet.firewall.cfgattr",
        "fortinet.firewall.cfgobj",
        "fortinet.firewall.cfgpath",
        "fortinet.firewall.ui"
      ],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "Add" }},
            { "range": { "@timestamp": { "gte": "now/M" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Cấu hình nào đã bị xóa trong 30 ngày qua?",
    "keywords": ["delete", "xóa", "remove", "gỡ bỏ", "deleted configuration", "30 ngày", "tháng qua"],
    "scenario": "Audit - Track deleted configurations",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "_source": [
        "@timestamp",
        "source.user.name",
        "message",
        "observer.name",
        "observer.serial_number",
        "fortinet.firewall.action",
        "fortinet.firewall.cfgattr",
        "fortinet.firewall.cfgobj",
        "fortinet.firewall.cfgpath",
        "fortinet.firewall.ui"
      ],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "Delete" }},
            { "range": { "@timestamp": { "gte": "now-30d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các cập nhật hệ thống trong tuần này",
    "keywords": ["update", "cập nhật", "upgrade", "nâng cấp", "system update", "tuần này", "this week"],
    "scenario": "System maintenance - Track updates",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "update" }},
            { "range": { "@timestamp": { "gte": "now-7d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các thay đổi vị trí cấu hình trong 14 ngày qua",
    "keywords": ["move", "di chuyển", "reorder", "sắp xếp lại", "position change", "14 ngày", "2 tuần"],
    "scenario": "Audit - Track configuration moves",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "Move" }},
            { "range": { "@timestamp": { "gte": "now-14d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Ai đã đăng nhập vào firewall hôm nay?",
    "keywords": ["login", "đăng nhập", "sign in", "authentication", "user login", "hôm nay", "today"],
    "scenario": "Security audit - Track user logins",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "_source": [
        "@timestamp",
        "source.user.name",
        "message",
        "observer.name",
        "observer.serial_number",
        "fortinet.firewall.action",
        "fortinet.firewall.cfgattr",
        "fortinet.firewall.cfgobj",
        "fortinet.firewall.cfgpath",
        "fortinet.firewall.ui"
      ],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "login" }},
            { "range": { "@timestamp": { "gte": "now/d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Lịch sử đăng xuất trong 7 ngày qua",
    "keywords": ["logout", "đăng xuất", "sign out", "logoff", "user logout", "7 ngày", "tuần qua"],
    "scenario": "Security audit - Track user logouts",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "_source": ["@timestamp", "source.user.name", "fortinet.firewall.ui"],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "logout" }},
            { "range": { "@timestamp": { "gte": "now-7d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các mối đe dọa được phát hiện trong 24 giờ qua",
    "keywords": ["detected", "phát hiện", "found", "threat detected", "malware detected", "24h", "ngày qua"],
    "scenario": "Security monitoring - Track detected threats",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "detected" }},
            { "range": { "@timestamp": { "gte": "now-24h" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Traffic bypass inspection trong ngày",
    "keywords": ["bypass", "bỏ qua", "skip inspection", "inspection bypass", "ngày hôm nay"],
    "scenario": "Security monitoring - Track bypassed inspections",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "bypass" }},
            { "range": { "@timestamp": { "gte": "now/d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Truy vấn DNS trong 1 giờ qua",
    "keywords": ["dns", "DNS query", "domain lookup", "name resolution", "truy vấn DNS", "1h", "giờ qua"],
    "scenario": "Network monitoring - Track DNS queries",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "dns" }},
            { "range": { "@timestamp": { "gte": "now-1h" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các kết nối IP trong 6 giờ qua",
    "keywords": ["ip-conn", "ip connection", "kết nối IP", "layer 3", "6h", "6 giờ"],
    "scenario": "Network monitoring - Track IP connections",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "ip-conn" }},
            { "range": { "@timestamp": { "gte": "now-6h" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Traffic passthrough trong 12 giờ qua",
    "keywords": ["passthrough", "pass through", "thông qua", "forward", "12h", "12 giờ"],
    "scenario": "Network monitoring - Track passthrough traffic",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "passthrough" }},
            { "range": { "@timestamp": { "gte": "now-12h" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các phiên negotiate trong ngày",
    "keywords": ["negotiate", "negotiation", "thương lượng", "protocol negotiation", "ngày hôm nay"],
    "scenario": "Network monitoring - Track protocol negotiations",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "negotiate" }},
            { "range": { "@timestamp": { "gte": "now/d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các kết nối được permit hôm nay",
    "keywords": ["permit", "permitted", "cho phép", "allowed", "granted", "hôm nay"],
    "scenario": "Network security - Monitor permitted connections",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "permit" }},
            { "range": { "@timestamp": { "gte": "now/d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Log thông tin hệ thống trong 24 giờ qua",
    "keywords": ["info", "information", "thông tin", "system info", "informational", "24h"],
    "scenario": "System monitoring - Track informational logs",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "info" }},
            { "range": { "@timestamp": { "gte": "now-24h" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các lỗi hệ thống trong tuần này",
    "keywords": ["error", "lỗi", "failure", "failed", "system error", "tuần này", "this week"],
    "scenario": "System troubleshooting - Track errors",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "error" }},
            { "range": { "@timestamp": { "gte": "now/w" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Thống kê hiệu suất firewall hôm nay",
    "keywords": ["perf-stats", "performance", "hiệu suất", "stats", "statistics", "hôm nay"],
    "scenario": "Performance monitoring - Track performance statistics",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "perf-stats" }},
            { "range": { "@timestamp": { "gte": "now/d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các lần chuyển đổi transport tự động trong 7 ngày qua",
    "keywords": ["auto_transport_switch", "transport switch", "chuyển đổi tự động", "automatic switch", "7 ngày"],
    "scenario": "Network monitoring - Track automatic transport switches",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "auto_transport_switch" }},
            { "range": { "@timestamp": { "gte": "now-7d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Thay đổi trạng thái interface trong tháng này",
    "keywords": ["interface-stat-change", "interface status", "trạng thái interface", "port change", "tháng này"],
    "scenario": "Network monitoring - Track interface status changes",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "interface-stat-change" }},
            { "range": { "@timestamp": { "gte": "now-30d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Lịch sử roll log trong 30 ngày qua",
    "keywords": ["roll-log", "log rotation", "xoay vòng log", "log rollover", "30 ngày"],
    "scenario": "System maintenance - Track log rotations",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "roll-log" }},
            { "range": { "@timestamp": { "gte": "now-30d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các hoạt động trim disk trong tháng này",
    "keywords": ["trim-disk", "disk trim", "dọn dẹp đĩa", "disk cleanup", "tháng này"],
    "scenario": "System maintenance - Track disk trim operations",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "trim-disk" }},
            { "range": { "@timestamp": { "gte": "now/M" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Các lần reseeding hệ thống trong 14 ngày qua",
    "keywords": ["reseeding", "reseed", "khởi tạo lại", "reinitialize", "14 ngày"],
    "scenario": "System maintenance - Track reseeding operations",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "reseeding" }},
            { "range": { "@timestamp": { "gte": "now-14d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Lịch sử download trong tuần này",
    "keywords": ["download", "tải xuống", "file download", "configuration download", "tuần này"],
    "scenario": "System monitoring - Track downloads",
    "query": {
      "size": 50,
      "sort": [{ "@timestamp": "desc" }],
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "download" }},
            { "range": { "@timestamp": { "gte": "now-7d" }}}
          ]
        }
      }
    }
  },
  {
    "question": "Top 10 hành động phổ biến nhất trong 24 giờ qua",
    "keywords": ["top actions", "most common", "phổ biến nhất", "thống kê", "statistics", "24h"],
    "scenario": "Analytics - Track most common actions",
    "query": {
      "size": 0,
      "query": {
        "range": { "@timestamp": { "gte": "now-24h" }}
      },
      "aggs": {
        "top_actions": {
          "terms": {
            "field": "fortinet.firewall.action",
            "size": 10
          }
        }
      }
    }
  },
  {
    "question": "Top IP bị chặn nhiều nhất hôm nay",
    "keywords": ["top blocked IP", "most denied", "bị chặn nhiều nhất", "deny by IP", "hôm nay"],
    "scenario": "Security analytics - Identify most blocked IPs",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            { "term": { "fortinet.firewall.action": "deny" }},
            { "range": { "@timestamp": { "gte": "now/d" }}}
          ]
        }
      },
      "aggs": {
        "top_blocked_ips": {
          "terms": {
            "field": "source.ip",
            "size": 20
          }
        }
      }
    }
  },
  {
    "question": "Ai đã thêm sửa xóa cấu hình gì trên thiết bị nào trong 30 ngày qua?",
    "keywords": [
      "thêm sửa xóa",
      "Add Edit Delete",
      "configuration changes",
      "thiết bị",
      "device",
      "observer",
      "giao diện",
      "UI",
      "GUI CLI",
      "30 ngày"
    ],
    "scenario": "Audit - Track all configuration changes with device and interface info",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "_source": [
        "@timestamp",
        "source.user.name",
        "message",
        "observer.name",
        "observer.serial_number",
        "fortinet.firewall.action",
        "fortinet.firewall.cfgattr",
        "fortinet.firewall.cfgobj",
        "fortinet.firewall.cfgpath",
        "fortinet.firewall.ui"
      ],
      "query": {
        "bool": {
          "filter": [
            { "range": { "@timestamp": { "gte": "now-30d" } } },
            { "terms": { "fortinet.firewall.action": ["Edit", "Add", "Delete"] } }
          ]
        }
      }
    }
  },
  {
    "question": "Ai đã thêm/sửa/xóa firewall policy trong 30 ngày qua?",
    "keywords": [
      "thêm sửa xóa policy",
      "add edit delete policy",
      "firewall policy changes",
      "thay đổi policy",
      "policy modifications",
      "30 ngày"
    ],
    "scenario": "Audit - Track firewall policy changes only",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "_source": [
        "@timestamp",
        "source.user.name",
        "message",
        "observer.name",
        "observer.serial_number",
        "fortinet.firewall.action",
        "fortinet.firewall.cfgattr",
        "fortinet.firewall.cfgobj",
        "fortinet.firewall.cfgpath",
        "fortinet.firewall.ui"
      ],
      "query": {
        "bool": {
          "must": [
            { "match_phrase": { "fortinet.firewall.cfgpath": "firewall.policy" }}
          ],
          "filter": [
            { "range": { "@timestamp": { "gte": "now-30d" } } },
            { "terms": { "fortinet.firewall.action": ["Edit", "Add", "Delete"] } }
          ]
        }
      }
    }
  },
  {
    "question": "Thống kê ai thêm/sửa/xóa cấu hình nhiều nhất trong 30 ngày qua?",
    "keywords": [
      "thống kê user",
      "user statistics",
      "ai sửa nhiều nhất",
      "most active user",
      "configuration changes by user",
      "top users",
      "aggregation",
      "30 ngày"
    ],
    "scenario": "Analytics - User activity statistics for configuration changes",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            { "range": { "@timestamp": { "gte": "now-30d" } } },
            { "terms": { "fortinet.firewall.action": ["Edit", "Add", "Delete"] } }
          ]
        }
      },
      "aggs": {
        "by_user": {
          "terms": {
            "field": "source.user.name",
            "size": 20
          },
          "aggs": {
            "by_action": {
              "terms": {
                "field": "fortinet.firewall.action",
                "size": 3
              }
            },
            "recent_changes": {
              "top_hits": {
                "size": 5,
                "sort": [{ "@timestamp": "desc" }],
                "_source": ["@timestamp", "message", "fortinet.firewall.cfgpath"]
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "Có bao nhiêu lần thêm/sửa/xóa trong 30 ngày qua?",
    "keywords": [
      "đếm số lần thay đổi",
      "count changes",
      "statistics by action",
      "thống kê theo action",
      "add edit delete count",
      "số lượng thay đổi",
      "30 ngày"
    ],
    "scenario": "Analytics - Count configuration changes by action type",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            { "range": { "@timestamp": { "gte": "now-30d" } } },
            { "terms": { "fortinet.firewall.action": ["Edit", "Add", "Delete"] } }
          ]
        }
      },
      "aggs": {
        "by_action": {
          "terms": {
            "field": "fortinet.firewall.action",
            "size": 3
          },
          "aggs": {
            "by_cfgpath": {
              "terms": {
                "field": "fortinet.firewall.cfgpath",
                "size": 10
              }
            }
          }
        }
      }
    }
  },
  {
    "question": "User tanln đã thêm/sửa/xóa gì trong 30 ngày qua?",
    "keywords": [
      "user specific",
      "tanln changes",
      "thay đổi của user",
      "user activity",
      "hoạt động user",
      "specific user audit",
      "30 ngày"
    ],
    "scenario": "Audit - Track specific user's configuration changes",
    "query": {
      "size": 100,
      "sort": [{ "@timestamp": "desc" }],
      "_source": [
        "@timestamp",
        "source.user.name",
        "message",
        "observer.name",
        "observer.serial_number",
        "fortinet.firewall.action",
        "fortinet.firewall.cfgattr",
        "fortinet.firewall.cfgobj",
        "fortinet.firewall.cfgpath",
        "fortinet.firewall.ui"
      ],
      "query": {
        "bool": {
          "must": [
            { "match_phrase": { "source.user.name": "tanln" }}
          ],
          "filter": [
            { "range": { "@timestamp": { "gte": "now-30d" } } },
            { "terms": { "fortinet.firewall.action": ["Edit", "Add", "Delete"] } }
          ]
        }
      }
    }
  },
  {
    "question": "Ai dùng internet nhiều nhất trong hôm qua?",
    "keywords": [
      "ai",
      "user",
      "người dùng",
      "internet",
      "nhiều nhất",
      "top",
      "hôm qua",
      "yesterday",
      "sử dụng",
      "usage",
      "băng thông",
      "bandwidth",
      "network.bytes",
      "http",
      "https",
      "sdwan",
      "wan",
      "traffic",
      "lưu lượng",
      "most",
      "highest",
      "cao nhất",
      "maximum",
      "tối đa",
      "xếp hạng",
      "ranking",
      "aggregation",
      "tổng hợp",
      "statistics",
      "thống kê",
      "grouping",
      "nhóm"
    ],
    "scenario": "Network performance - Identify top internet bandwidth consumers to monitor usage and optimize network resources",
    "query": {
      "size": 0,
      "query": {
        "bool": {
          "filter": [
            {
              "range": {
                "@timestamp": {
                  "gte": "now-1d/d",
                  "lt": "now/d"
                }
              }
            },
            {
              "terms": {
                "network.protocol": [
                  "http",
                  "https"
                ]
              }
            },
            {
              "terms": {
                "observer.egress.interface.name": [
                  "sdwan",
                  "port1",
                  "port2",
                  "FTTH-WAN1-CMC",
                  "FTTH-WAN2-FPT"
                ]
              }
            }
          ]
        }
      },
      "aggs": {
        "top_users": {
          "terms": {
            "field": "source.user.name",
            "size": 10,
            "order": {
              "total_bytes": "desc"
            }
          },
          "aggs": {
            "total_bytes": {
              "sum": {
                "field": "network.bytes"
              }
            },
            "total_sessions": {
              "value_count": {
                "field": "@timestamp"
              }
            }
          }
        }
      }
    }
  }
]